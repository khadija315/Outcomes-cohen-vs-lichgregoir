Outcomes_Output
==================================================================================================
==================================================================================================

1. Load data
> data<-read.table("clipboard", header=TRUE, sep="\t",dec=",", na.string="")
 
>  data$AGS <-as.numeric (data$AGS)
>  data$BMI <-as.numeric (data$BMI)
>  data$BLDLOSS <-as.numeric (data$BLDLOSS)
>  data$CATHPERIOD <-as.numeric (data$CATHPERIOD)
>  data$FUPm <-as.numeric (data$FUPm)
>  data$HOSPTIME <-as.numeric (data$HOSPTIME)
>  data$OPRTIME <-as.numeric (data$OPRTIME)
>  data$UTIpostopFup <-as.numeric (data$UTIpostopFup)
>  data$UTIpostopT <-as.numeric (data$UTIpostopT)
>  data$PREOPVURGRADE <-as.factor (data$PREOPVURGRADE)
>  data$HISTOINJ <-as.factor (data$HISTOINJ)
>  data$PREOPRNPLN <-as.factor (data$PREOPRNPLN)
>  data$PREOPRNSCR <-as.factor (data$PREOPRNSCR)
>  data$VURSIDE <-as.factor (data$VURSIDE)
>  data$VURPHASE <-as.factor (data$VURPHASE)
>  data$PREOPEPISODEn <-as.factor (data$PREOPEPISODEn)
>  data$PREOPTYPEUn <-as.factor (data$PREOPTYPEUn)
>  data$SURGTECHn2 <-as.factor (data$SURGTECHn2)
>  data$TRTn2 <-as.factor (data$TRTn2)
>  data$ANASTOMO <-as.factor (data$ANASTOMO)
>  data$BLDCOMPLEAK <-as.factor (data$BLDCOMPLEAK)
>  data$BLDCOMPRETN <-as.factor (data$BLDCOMPRETN)
>  data$BLDCOMPVOID <-as.factor (data$BLDCOMPVOID)
>  data$BLDSPASM <-as.factor (data$BLDSPASM)
>  data$CATH <-as.factor (data$CATH)
>  data$Center <-as.factor (data$Center)
>  data$CLAVIENCLASS <-as.factor (data$CLAVIENCLASS)
>  data$EPIDURAL <-as.factor (data$EPIDURAL)
>  data$GENDER <-as.factor (data$GENDER)
>  data$GU30 <-as.factor (data$GU30)
>  data$GU90 <-as.factor (data$GU90)
>  data$GUER30 <-as.factor (data$GUER30)
>  data$GUER90 <-as.factor (data$GUER90)
>  data$HEMAT <-as.factor (data$HEMAT)
>  data$ILEUS <-as.factor (data$ILEUS)
>  data$INCCOMPBLEED <-as.factor (data$INCCOMPBLEED)
>  data$INCCOMPINF <-as.factor (data$INCCOMPINF)
>  data$INCCOMPSCAR <-as.factor (data$INCCOMPSCAR)
>  data$NARC <-as.factor (data$NARC)
>  data$NONARC <-as.factor (data$NONARC)
>  data$PAIN <-as.factor (data$PAIN)
>  data$PROC365 <-as.factor (data$PROC365)
>  data$STENT <-as.factor (data$STENT)
>  data$UDR7M <-as.factor (data$UDR7M)
>  data$URCOMPCVUR <-as.factor (data$URCOMPCVUR)
>  data$URCOMPINJ <-as.factor (data$URCOMPINJ)
>  data$URCOMPOBST <-as.factor (data$URCOMPOBST)
>  data$URCOMPSTEN <-as.factor (data$URCOMPSTEN)
>  data$UTIpostop <-as.factor (data$UTIpostop)
>  data$SURGIND <-as.factor (data$SURGIND)
>  data$VURRECG01 <-as.factor (data$VURRECG01)
>  data$REC011 <-as.factor (data$REC011)

 
> library(dplyr)
> data$Center <- recode(data$Center, `1` = "Al-Zahraa hospital", `2` = "Dresden Hospital",`3` = "Hotel Dieu Hospital",`4` = "AUBMC" ,`5` = "India" )
> data$GENDER <- recode(data$GENDER, `0` = "Male", `1` = "Female")
> data$UDR7M <- recode(data$UDR7M, `0` = "< 7 mm", `1` = "≥ 7mm")
> data$STENT <- recode(data$STENT, `0` = "No", `1` = "Yes")
> data$CATH  <- recode(data$CATH, `0` = "No", `1` = "Yes")
> data$NARC <- recode(data$NARC, `0` = "No", `1` = "Yes")
> data$NONARC <- recode(data$NONARC, `0` = "No", `1` = "Yes")
> data$PAIN <- recode(data$PAIN , `0` = "No pain", `1` = "Mild pain", `2` = "Moderate pain",`3` = "Severe pain" )
> data$BLDSPASM <- recode(data$BLDSPASM, `0` = "No", `1` = "Yes")
> data$HEMAT <- recode(data$HEMAT, `0` = "No", `1` = "Yes")
> data$BLDCOMPRETN <- recode(data$BLDCOMPRETN, `0` = "No", `1` = "Yes")
> data$BLDCOMPVOID <- recode(data$BLDCOMPVOID, `0` = "No", `1` = "Yes")
> data$BLDCOMPLEAK <- recode(data$BLDCOMPLEAK, `0` = "No", `1` = "Yes")
> data$URCOMPOBST <- recode(data$URCOMPOBST, `0` = "No", `1` = "Yes")
> data$URCOMPINJ <- recode(data$URCOMPINJ, `0` = "No", `1` = "Yes")
> data$URCOMPSTEN <- recode(data$URCOMPSTEN, `0` = "No", `1` = "Yes")
> data$INCCOMPBLEED <- recode(data$INCCOMPBLEED, `0` = "No", `1` = "Yes")
> data$INCCOMPINF <- recode(data$INCCOMPINF, `0` = "No", `1` = "Yes")
> data$INCCOMPSCAR <- recode(data$INCCOMPSCAR, `0` = "No", `1` = "Yes")
> data$ILEUS <- recode(data$ILEUS, `0` = "No", `1` = "Yes")
> data$CLAVIENCLASS  <- recode(data$CLAVIENCLASS , `1` = "Clavien grade 1", `2` = "Clavien grade 2",`3` = "Clavien grade 3",`4` = "Clavien grade 4" ,`5` = "Clavien grade 5" )
> data$GU30 <- recode(data$GU30, `0` = "No", `1` = "Yes")
> data$GU90 <- recode(data$GU90, `0` = "No", `1` = "Yes")
> data$GUER30 <- recode(data$GUER30, `0` = "No", `1` = "Yes")
> data$GUER90 <- recode(data$GUER90, `0` = "No", `1` = "Yes")
> data$PROC365 <- recode(data$PROC365, `0` = "No", `1` = "Yes")
> data$TRTn2 <- recode(data$TRTn2, `0` = "Cohen group", `1` = "Lich-Gregoir group")
> data$EPIDURAL<- recode(data$EPIDURAL, `0` = "No", `1` = "Yes")
> data$HISTOINJ <- recode(data$HISTOINJ, `0` = "No", `1` = "Yes")
> data$PREOPVURGRADE  <- recode(data$PREOPVURGRADE , `1` = "III", `2` = "IV",`3` = "V" )
> data$VURSIDE <- recode(data$VURSIDE, `0` = "Left", `1` = "Right")
> data$VURPHASE <- recode(data$VURPHASE, `1` = "At voiding", `2` = "At filling",`3` = "At filling and voiding" )
> data$PREOPTYPEUn <- recode(data$PREOPTYPEUn, `0` = "Afebrile", `1` = "Febrile")
> data$PREOPEPISODEn <- recode(data$PREOPEPISODEn, `1` = "1", `2` = "2",`3` = "≥ 3" )
> data$PREOPRNPLN <- recode(data$PREOPRNPLN, `0` = "No", `1` = "Yes")
> data$PREOPRNSCR <- recode(data$PREOPRNSCR, `0` = "No scarring", `1` = "Any scarring")
> data$ANASTOMO <- recode(data$ANASTOMO, `0` = "No", `1` = "Yes")
> data$SURGTECHn2  <- recode(data$SURGTECHn2 , `1` = "≥ 100", `2` = "50 - 100",`3` = "<50" )
> data$URCOMPCVUR <- recode(data$URCOMPCVUR, `0` = "No", `1` = "Yes")
> data$UTIpostop <- recode(data$UTIpostop, `0` = "No UTI", `1` = "UTI")
> data$SURGIND <- recode(data$SURGIND,
+   `1` = "Poor compliance to medical treatment",
+   `2` = "Children with ineffective or poorly tolerated CAP",
+   `3` = "Symptomatic high-grade reflux (III-V)",
+   `4` = "Repeated breakthrough UTI",
+   `5` = "Girls with persistent VUR after puberty",
+   `6` = "VUR recurrence after endoscopic injection",
+   `7` = "Reflux nephropathy",
+   `8` = "Presence of new renal scars on DMSA",
+   `9` = "Worsening in renal function",
+   `10` = "Parental preference",
+   `11` = "Persistent reflux >2 years"
+ )
> data$VURRECG01 <- recode(data$VURRECG01,
+   `0` = "No recurrence",
+   `1` = "Recurrence"
+ )
> data$REC011 <- recode(data$REC011, `0` = "No recurrence", `1` = "Recurrence", `N/A` = "missing")
 
==================================================================================================
==================================================================================================

2. Data imputation
> library(VIM)
> # Subset the data to include only the required variables
> subset_data <- data[, c("BMI", "AGS", "PREOPVURGRADE", "PREOPRNSCR", 
+                         "UDR7M", "GENDER", "VURPHASE", "PREOPTYPEUn", 
+                         "PREOPEPISODEn", "PREOPRNPLN")]
> 
> # Calculate the percentage of missing values for each variable
> missing_percent <- colSums(is.na(subset_data)) / nrow(subset_data) * 100
> 
> # Print the result
> print(missing_percent)
          BMI           AGS PREOPVURGRADE    PREOPRNSCR 
    0.0000000     0.0000000     0.0000000     0.0000000 
        UDR7M        GENDER      VURPHASE   PREOPTYPEUn 
    0.0000000     0.0000000     0.0000000     0.2421308 
PREOPEPISODEn    PREOPRNPLN 
    2.9055690    20.5811138 
> imputed_data <- kNN(subset_data, k = 5)
> 
> # Combine imputed variables back into the original data if needed
> data[, colnames(subset_data)] <- imputed_data[, colnames(subset_data)]
> 
> 
> # Calculate the percentage of missing values for each variable in the original data
> missing_percent2 <- colSums(is.na(data)) / nrow(data) * 100
> 
> # Print the result
> print(missing_percent2)
                           Case 
                       0.000000 
NEW.CASE.CODE.QCODEVUR.DATASETS 
                       0.000000 
                          QCODE 
                       0.000000 
                         REC011 
                       0.000000 
                            AGS 
                       0.000000 
                       ANASTOMO 
                       0.000000 
                    BLDCOMPLEAK 
                       0.000000 
                    BLDCOMPRETN 
                       0.000000 
                    BLDCOMPVOID 
                       0.000000 
                        BLDLOSS 
                       1.937046 
                       BLDSPASM 
                       0.000000 
                            BMI 
                       0.000000 
                           CATH 
                       0.000000 
                     CATHPERIOD 
                       0.000000 
                         Center 
                       0.000000 
                   CLAVIENCLASS 
                      22.033898 
                       EPIDURAL 
                       0.000000 
                           FUPm 
                       0.000000 
                         GENDER 
                       0.000000 
                           GU30 
                       0.000000 
                           GU90 
                       0.000000 
                         GUER30 
                       0.000000 
                         GUER90 
                       0.000000 
                          HEMAT 
                       0.000000 
                       HISTOINJ 
                       0.000000 
                       HOSPTIME 
                       0.000000 
                          ILEUS 
                       0.000000 
                   INCCOMPBLEED 
                       0.000000 
                     INCCOMPINF 
                       0.000000 
                    INCCOMPSCAR 
                       0.000000 
                           NARC 
                       0.000000 
                         NONARC 
                       0.000000 
                        OPRTIME 
                       0.000000 
                           PAIN 
                       0.968523 
                  PREOPEPISODEn 
                       0.000000 
                     PREOPRNPLN 
                       0.000000 
                     PREOPRNSCR 
                       0.000000 
                    PREOPTYPEUn 
                       0.000000 
                  PREOPVURGRADE 
                       0.000000 
                        PROC365 
                       0.000000 
                          STENT 
                       0.000000 
                        SURGIND 
                       0.000000 
                     SURGTECHn2 
                       0.000000 
                          TRTn2 
                       0.000000 
                          UDR7M 
                       0.000000 
                     URCOMPCVUR 
                       8.716707 
                      URCOMPINJ 
                       0.000000 
                     URCOMPOBST 
                       0.000000 
                     URCOMPSTEN 
                       0.000000 
                      UTIpostop 
                       0.000000 
                   UTIpostopFup 
                       0.000000 
                     UTIpostopT 
                       0.000000 
                       VURPHASE 
                       0.000000 
                      VURRECG01 
                       0.000000 
                        VURSIDE 
                       0.000000 
                         VURREC 
                       0.000000 
                    VURRECGRADE 
                       0.000000 
                     DOWNGRAD1M 
                       0.000000 
                     DOWNGRAD3M 
                       0.000000 
                     DOWNGRAD1Y 
                       0.000000 
                     DOWNGRAD2Y 
                       0.000000 
                     DOWNGRAD3Y 
                       0.000000 
                     DOWNGRAD5Y 
                       0.000000 
                    DOWNGRAD10Y 
                       0.000000 

==================================================================================================
==================================================================================================

3. Descriptive analysis – Original Cohort

> # Comparative descriptive statistics for the whole cohort (stratified by treatment group):
> 
> # Descriptive analysis generating mean (SD) for numerical variables
> 
> # Load the required package
> if (!requireNamespace("tableone", quietly = TRUE)) {
+   install.packages("tableone")
+ }
> library(tableone)
> 
> # Specify variables
> numeric_vars <- c("AGS", "BMI", "BLDLOSS", "CATHPERIOD", "FUPm", 
+                   "HOSPTIME", "OPRTIME", "UTIpostopFup", "UTIpostopT")
> 
> factor_vars <- c("PREOPVURGRADE", "HISTOINJ", "PREOPRNPLN", "PREOPRNSCR", "VURSIDE", 
+                  "VURPHASE", "PREOPEPISODEn", "PREOPTYPEUn", "SURGTECHn2", "TRTn2", 
+                  "ANASTOMO", "BLDCOMPLEAK", "BLDCOMPRETN", "BLDCOMPVOID", "BLDSPASM", 
+                  "CATH", "Center", "CLAVIENCLASS", "EPIDURAL", "GENDER", "GU30", 
+                  "GU90", "GUER30","GUER90", "HEMAT", "ILEUS", "INCCOMPBLEED", "INCCOMPINF", 
+                  "INCCOMPSCAR", "NARC", "NONARC", "PAIN", "PROC365", "STENT", 
+                  "UDR7M", "URCOMPCVUR", "URCOMPINJ", "URCOMPOBST", "URCOMPSTEN", 
+                  "UTIpostop", "SURGIND", "VURRECG01", "REC011")
> 
> all_vars <- c(numeric_vars, factor_vars)
> 
> # Create Table 1
> table1 <- CreateTableOne(vars = all_vars, strata = "TRTn2", data = data, test = TRUE)
> 
> # Print Table 1 with p-values
> print(table1, showAllLevels = TRUE, pDigits = 3)
                          Stratified by TRTn2
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          Stratified by TRTn2
                           Cohen group    
  n                           198         
  AGS (mean (SD))            6.89 (3.26)  
  BMI (mean (SD))           16.99 (3.94)  
  BLDLOSS (mean (SD))       84.48 (68.16) 
  CATHPERIOD (mean (SD))    15.06 (16.96) 
  FUPm (mean (SD))          44.65 (36.83) 
  HOSPTIME (mean (SD))       5.15 (1.24)  
  OPRTIME (mean (SD))      120.31 (40.66) 
  UTIpostopFup (mean (SD))  37.96 (39.87) 
  UTIpostopT (mean (SD))     0.45 (1.71)  
  PREOPVURGRADE (%)            11 (  5.6) 
                               52 ( 26.3) 
                              135 ( 68.2) 
  HISTOINJ (%)                179 ( 90.4) 
                               19 (  9.6) 
  PREOPRNPLN (%)              130 ( 65.7) 
                               68 ( 34.3) 
  PREOPRNSCR (%)              104 ( 52.5) 
                               94 ( 47.5) 
  VURSIDE (%)                  80 ( 40.4) 
                              118 ( 59.6) 
  VURPHASE (%)                113 ( 57.1) 
                                1 (  0.5) 
                               84 ( 42.4) 
  PREOPEPISODEn (%)            16 (  8.1) 
                               68 ( 34.3) 
                              114 ( 57.6) 
  PREOPTYPEUn (%)               7 (  3.5) 
                              191 ( 96.5) 
  SURGTECHn2 (%)               15 (  7.6) 
                              138 ( 69.7) 
                               45 ( 22.7) 
  TRTn2 (%)                   198 (100.0) 
                                0 (  0.0) 
  ANASTOMO (%)                196 ( 99.0) 
                                2 (  1.0) 
  BLDCOMPLEAK (%)             196 ( 99.0) 
                                2 (  1.0) 
  BLDCOMPRETN (%)             179 ( 90.4) 
                               19 (  9.6) 
  BLDCOMPVOID (%)             186 ( 93.9) 
                               12 (  6.1) 
  BLDSPASM (%)                130 ( 65.7) 
                               68 ( 34.3) 
  CATH (%)                      2 (  1.0) 
                              196 ( 99.0) 
  Center (%)                  104 ( 52.5) 
                                4 (  2.0) 
                               31 ( 15.7) 
                               59 ( 29.8) 
  CLAVIENCLASS (%)            102 ( 75.6) 
                               19 ( 14.1) 
                               13 (  9.6) 
                                0 (  0.0) 
                                1 (  0.7) 
  EPIDURAL (%)                179 ( 90.4) 
                               19 (  9.6) 
  GENDER (%)                  108 ( 54.5) 
                               90 ( 45.5) 
  GU30 (%)                    145 ( 73.2) 
                               53 ( 26.8) 
  GU90 (%)                     88 ( 44.4) 
                              110 ( 55.6) 
  GUER30 (%)                  117 ( 59.1) 
                               81 ( 40.9) 
  GUER90 (%)                  113 ( 57.1) 
                               85 ( 42.9) 
  HEMAT (%)                   149 ( 75.3) 
                               49 ( 24.7) 
  ILEUS (%)                   182 ( 91.9) 
                               16 (  8.1) 
  INCCOMPBLEED (%)            177 ( 89.4) 
                               21 ( 10.6) 
  INCCOMPINF (%)              179 ( 90.4) 
                               19 (  9.6) 
  INCCOMPSCAR (%)             197 ( 99.5) 
                                1 (  0.5) 
  NARC (%)                    109 ( 55.1) 
                               89 ( 44.9) 
  NONARC (%)                    2 (  1.0) 
                              196 ( 99.0) 
  PAIN (%)                      9 (  4.6) 
                               45 ( 23.2) 
                               53 ( 27.3) 
                               87 ( 44.8) 
  PROC365 (%)                 191 ( 96.5) 
                                7 (  3.5) 
  STENT (%)                    92 ( 46.5) 
                              106 ( 53.5) 
  UDR7M (%)                    32 ( 16.2) 
                              166 ( 83.8) 
  URCOMPCVUR (%)              160 ( 95.2) 
                                8 (  4.8) 
  URCOMPINJ (%)               194 ( 98.0) 
                                4 (  2.0) 
  URCOMPOBST (%)              196 ( 99.0) 
                                2 (  1.0) 
  URCOMPSTEN (%)              191 ( 96.5) 
                                7 (  3.5) 
  UTIpostop (%)               153 ( 77.3) 
                               45 ( 22.7) 
  SURGIND (%)                  10 (  5.1) 
                               11 (  5.6) 
                               58 ( 29.3) 
                               94 ( 47.5) 
                                0 (  0.0) 
                                1 (  0.5) 
                                6 (  3.0) 
                                4 (  2.0) 
                                4 (  2.0) 
                                1 (  0.5) 
                                9 (  4.5) 
  VURRECG01 (%)               166 ( 83.8) 
                               32 ( 16.2) 
  REC011 (%)                   90 ( 45.5) 
                               14 (  7.1) 
                               94 ( 47.5) 
                          Stratified by TRTn2
                           Lich-Gregoir group p      test
  n                          215                         
  AGS (mean (SD))           7.68 (2.23)        0.004     
  BMI (mean (SD))          14.85 (2.58)       <0.001     
  BLDLOSS (mean (SD))      75.93 (59.54)       0.179     
  CATHPERIOD (mean (SD))    6.15 (11.88)      <0.001     
  FUPm (mean (SD))         37.07 (29.62)       0.021     
  HOSPTIME (mean (SD))      3.44 (3.24)       <0.001     
  OPRTIME (mean (SD))      73.85 (13.12)      <0.001     
  UTIpostopFup (mean (SD)) 27.66 (32.07)       0.004     
  UTIpostopT (mean (SD))    0.49 (1.87)        0.826     
  PREOPVURGRADE (%)            9 (  4.2)       0.184     
                              74 ( 34.4)                 
                             132 ( 61.4)                 
  HISTOINJ (%)               190 ( 88.4)       0.611     
                              25 ( 11.6)                 
  PREOPRNPLN (%)             195 ( 90.7)      <0.001     
                              20 (  9.3)                 
  PREOPRNSCR (%)             171 ( 79.5)      <0.001     
                              44 ( 20.5)                 
  VURSIDE (%)                 82 ( 38.1)       0.711     
                             133 ( 61.9)                 
  VURPHASE (%)               114 ( 53.0)      <0.001     
                              68 ( 31.6)                 
                              33 ( 15.3)                 
  PREOPEPISODEn (%)            8 (  3.7)      <0.001     
                              33 ( 15.3)                 
                             174 ( 80.9)                 
  PREOPTYPEUn (%)              1 (  0.5)       0.057     
                             214 ( 99.5)                 
  SURGTECHn2 (%)              70 ( 32.6)      <0.001     
                             136 ( 63.3)                 
                               9 (  4.2)                 
  TRTn2 (%)                    0 (  0.0)      <0.001     
                             215 (100.0)                 
  ANASTOMO (%)               212 ( 98.6)       1.000     
                               3 (  1.4)                 
  BLDCOMPLEAK (%)            213 ( 99.1)       1.000     
                               2 (  0.9)                 
  BLDCOMPRETN (%)            175 ( 81.4)       0.013     
                              40 ( 18.6)                 
  BLDCOMPVOID (%)            200 ( 93.0)       0.859     
                              15 (  7.0)                 
  BLDSPASM (%)               166 ( 77.2)       0.013     
                              49 ( 22.8)                 
  CATH (%)                     7 (  3.3)       0.221     
                             208 ( 96.7)                 
  Center (%)                 187 ( 87.0)      <0.001     
                               0 (  0.0)                 
                               6 (  2.8)                 
                              22 ( 10.2)                 
  CLAVIENCLASS (%)            99 ( 52.9)      <0.001     
                              64 ( 34.2)                 
                              23 ( 12.3)                 
                               1 (  0.5)                 
                               0 (  0.0)                 
  EPIDURAL (%)               205 ( 95.3)       0.076     
                              10 (  4.7)                 
  GENDER (%)                 128 ( 59.5)       0.355     
                              87 ( 40.5)                 
  GU30 (%)                   205 ( 95.3)      <0.001     
                              10 (  4.7)                 
  GU90 (%)                   174 ( 80.9)      <0.001     
                              41 ( 19.1)                 
  GUER30 (%)                 200 ( 93.0)      <0.001     
                              15 (  7.0)                 
  GUER90 (%)                 193 ( 89.8)      <0.001     
                              22 ( 10.2)                 
  HEMAT (%)                  186 ( 86.5)       0.005     
                              29 ( 13.5)                 
  ILEUS (%)                  204 ( 94.9)       0.309     
                              11 (  5.1)                 
  INCCOMPBLEED (%)           171 ( 79.5)       0.009     
                              44 ( 20.5)                 
  INCCOMPINF (%)             204 ( 94.9)       0.118     
                              11 (  5.1)                 
  INCCOMPSCAR (%)            208 ( 96.7)       0.095     
                               7 (  3.3)                 
  NARC (%)                   111 ( 51.6)       0.550     
                             104 ( 48.4)                 
  NONARC (%)                   0 (  0.0)       0.443     
                             215 (100.0)                 
  PAIN (%)                     9 (  4.2)      <0.001     
                              82 ( 38.1)                 
                              71 ( 33.0)                 
                              53 ( 24.7)                 
  PROC365 (%)                209 ( 97.2)       0.880     
                               6 (  2.8)                 
  STENT (%)                  178 ( 82.8)      <0.001     
                              37 ( 17.2)                 
  UDR7M (%)                   65 ( 30.2)       0.001     
                             150 ( 69.8)                 
  URCOMPCVUR (%)             208 ( 99.5)       0.018     
                               1 (  0.5)                 
  URCOMPINJ (%)              212 ( 98.6)       0.912     
                               3 (  1.4)                 
  URCOMPOBST (%)             199 ( 92.6)       0.003     
                              16 (  7.4)                 
  URCOMPSTEN (%)             200 ( 93.0)       0.181     
                              15 (  7.0)                 
  UTIpostop (%)              148 ( 68.8)       0.069     
                              67 ( 31.2)                 
  SURGIND (%)                  9 (  4.2)       0.002     
                               2 (  0.9)                 
                              75 ( 34.9)                 
                             121 ( 56.3)                 
                               1 (  0.5)                 
                               0 (  0.0)                 
                               5 (  2.3)                 
                               0 (  0.0)                 
                               2 (  0.9)                 
                               0 (  0.0)                 
                               0 (  0.0)                 
  VURRECG01 (%)              196 ( 91.2)       0.035     
                              19 (  8.8)                 
  REC011 (%)                 158 ( 73.5)      <0.001     
                              11 (  5.1)                 
                              46 ( 21.4)                 
> 
> # Convert TableOne to a matrix
> table1_matrix <- print(table1, showAllLevels = TRUE, pDigits = 3, quote = FALSE, noSpaces = TRUE)
                          Stratified by TRTn2
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          Stratified by TRTn2
                           Cohen group   
  n                        198           
  AGS (mean (SD))          6.89 (3.26)   
  BMI (mean (SD))          16.99 (3.94)  
  BLDLOSS (mean (SD))      84.48 (68.16) 
  CATHPERIOD (mean (SD))   15.06 (16.96) 
  FUPm (mean (SD))         44.65 (36.83) 
  HOSPTIME (mean (SD))     5.15 (1.24)   
  OPRTIME (mean (SD))      120.31 (40.66)
  UTIpostopFup (mean (SD)) 37.96 (39.87) 
  UTIpostopT (mean (SD))   0.45 (1.71)   
  PREOPVURGRADE (%)        11 (5.6)      
                           52 (26.3)     
                           135 (68.2)    
  HISTOINJ (%)             179 (90.4)    
                           19 (9.6)      
  PREOPRNPLN (%)           130 (65.7)    
                           68 (34.3)     
  PREOPRNSCR (%)           104 (52.5)    
                           94 (47.5)     
  VURSIDE (%)              80 (40.4)     
                           118 (59.6)    
  VURPHASE (%)             113 (57.1)    
                           1 (0.5)       
                           84 (42.4)     
  PREOPEPISODEn (%)        16 (8.1)      
                           68 (34.3)     
                           114 (57.6)    
  PREOPTYPEUn (%)          7 (3.5)       
                           191 (96.5)    
  SURGTECHn2 (%)           15 (7.6)      
                           138 (69.7)    
                           45 (22.7)     
  TRTn2 (%)                198 (100.0)   
                           0 (0.0)       
  ANASTOMO (%)             196 (99.0)    
                           2 (1.0)       
  BLDCOMPLEAK (%)          196 (99.0)    
                           2 (1.0)       
  BLDCOMPRETN (%)          179 (90.4)    
                           19 (9.6)      
  BLDCOMPVOID (%)          186 (93.9)    
                           12 (6.1)      
  BLDSPASM (%)             130 (65.7)    
                           68 (34.3)     
  CATH (%)                 2 (1.0)       
                           196 (99.0)    
  Center (%)               104 (52.5)    
                           4 (2.0)       
                           31 (15.7)     
                           59 (29.8)     
  CLAVIENCLASS (%)         102 (75.6)    
                           19 (14.1)     
                           13 (9.6)      
                           0 (0.0)       
                           1 (0.7)       
  EPIDURAL (%)             179 (90.4)    
                           19 (9.6)      
  GENDER (%)               108 (54.5)    
                           90 (45.5)     
  GU30 (%)                 145 (73.2)    
                           53 (26.8)     
  GU90 (%)                 88 (44.4)     
                           110 (55.6)    
  GUER30 (%)               117 (59.1)    
                           81 (40.9)     
  GUER90 (%)               113 (57.1)    
                           85 (42.9)     
  HEMAT (%)                149 (75.3)    
                           49 (24.7)     
  ILEUS (%)                182 (91.9)    
                           16 (8.1)      
  INCCOMPBLEED (%)         177 (89.4)    
                           21 (10.6)     
  INCCOMPINF (%)           179 (90.4)    
                           19 (9.6)      
  INCCOMPSCAR (%)          197 (99.5)    
                           1 (0.5)       
  NARC (%)                 109 (55.1)    
                           89 (44.9)     
  NONARC (%)               2 (1.0)       
                           196 (99.0)    
  PAIN (%)                 9 (4.6)       
                           45 (23.2)     
                           53 (27.3)     
                           87 (44.8)     
  PROC365 (%)              191 (96.5)    
                           7 (3.5)       
  STENT (%)                92 (46.5)     
                           106 (53.5)    
  UDR7M (%)                32 (16.2)     
                           166 (83.8)    
  URCOMPCVUR (%)           160 (95.2)    
                           8 (4.8)       
  URCOMPINJ (%)            194 (98.0)    
                           4 (2.0)       
  URCOMPOBST (%)           196 (99.0)    
                           2 (1.0)       
  URCOMPSTEN (%)           191 (96.5)    
                           7 (3.5)       
  UTIpostop (%)            153 (77.3)    
                           45 (22.7)     
  SURGIND (%)              10 (5.1)      
                           11 (5.6)      
                           58 (29.3)     
                           94 (47.5)     
                           0 (0.0)       
                           1 (0.5)       
                           6 (3.0)       
                           4 (2.0)       
                           4 (2.0)       
                           1 (0.5)       
                           9 (4.5)       
  VURRECG01 (%)            166 (83.8)    
                           32 (16.2)     
  REC011 (%)               90 (45.5)     
                           14 (7.1)      
                           94 (47.5)     
                          Stratified by TRTn2
                           Lich-Gregoir group p      test
  n                        215                           
  AGS (mean (SD))          7.68 (2.23)        0.004      
  BMI (mean (SD))          14.85 (2.58)       <0.001     
  BLDLOSS (mean (SD))      75.93 (59.54)      0.179      
  CATHPERIOD (mean (SD))   6.15 (11.88)       <0.001     
  FUPm (mean (SD))         37.07 (29.62)      0.021      
  HOSPTIME (mean (SD))     3.44 (3.24)        <0.001     
  OPRTIME (mean (SD))      73.85 (13.12)      <0.001     
  UTIpostopFup (mean (SD)) 27.66 (32.07)      0.004      
  UTIpostopT (mean (SD))   0.49 (1.87)        0.826      
  PREOPVURGRADE (%)        9 (4.2)            0.184      
                           74 (34.4)                     
                           132 (61.4)                    
  HISTOINJ (%)             190 (88.4)         0.611      
                           25 (11.6)                     
  PREOPRNPLN (%)           195 (90.7)         <0.001     
                           20 (9.3)                      
  PREOPRNSCR (%)           171 (79.5)         <0.001     
                           44 (20.5)                     
  VURSIDE (%)              82 (38.1)          0.711      
                           133 (61.9)                    
  VURPHASE (%)             114 (53.0)         <0.001     
                           68 (31.6)                     
                           33 (15.3)                     
  PREOPEPISODEn (%)        8 (3.7)            <0.001     
                           33 (15.3)                     
                           174 (80.9)                    
  PREOPTYPEUn (%)          1 (0.5)            0.057      
                           214 (99.5)                    
  SURGTECHn2 (%)           70 (32.6)          <0.001     
                           136 (63.3)                    
                           9 (4.2)                       
  TRTn2 (%)                0 (0.0)            <0.001     
                           215 (100.0)                   
  ANASTOMO (%)             212 (98.6)         1.000      
                           3 (1.4)                       
  BLDCOMPLEAK (%)          213 (99.1)         1.000      
                           2 (0.9)                       
  BLDCOMPRETN (%)          175 (81.4)         0.013      
                           40 (18.6)                     
  BLDCOMPVOID (%)          200 (93.0)         0.859      
                           15 (7.0)                      
  BLDSPASM (%)             166 (77.2)         0.013      
                           49 (22.8)                     
  CATH (%)                 7 (3.3)            0.221      
                           208 (96.7)                    
  Center (%)               187 (87.0)         <0.001     
                           0 (0.0)                       
                           6 (2.8)                       
                           22 (10.2)                     
  CLAVIENCLASS (%)         99 (52.9)          <0.001     
                           64 (34.2)                     
                           23 (12.3)                     
                           1 (0.5)                       
                           0 (0.0)                       
  EPIDURAL (%)             205 (95.3)         0.076      
                           10 (4.7)                      
  GENDER (%)               128 (59.5)         0.355      
                           87 (40.5)                     
  GU30 (%)                 205 (95.3)         <0.001     
                           10 (4.7)                      
  GU90 (%)                 174 (80.9)         <0.001     
                           41 (19.1)                     
  GUER30 (%)               200 (93.0)         <0.001     
                           15 (7.0)                      
  GUER90 (%)               193 (89.8)         <0.001     
                           22 (10.2)                     
  HEMAT (%)                186 (86.5)         0.005      
                           29 (13.5)                     
  ILEUS (%)                204 (94.9)         0.309      
                           11 (5.1)                      
  INCCOMPBLEED (%)         171 (79.5)         0.009      
                           44 (20.5)                     
  INCCOMPINF (%)           204 (94.9)         0.118      
                           11 (5.1)                      
  INCCOMPSCAR (%)          208 (96.7)         0.095      
                           7 (3.3)                       
  NARC (%)                 111 (51.6)         0.550      
                           104 (48.4)                    
  NONARC (%)               0 (0.0)            0.443      
                           215 (100.0)                   
  PAIN (%)                 9 (4.2)            <0.001     
                           82 (38.1)                     
                           71 (33.0)                     
                           53 (24.7)                     
  PROC365 (%)              209 (97.2)         0.880      
                           6 (2.8)                       
  STENT (%)                178 (82.8)         <0.001     
                           37 (17.2)                     
  UDR7M (%)                65 (30.2)          0.001      
                           150 (69.8)                    
  URCOMPCVUR (%)           208 (99.5)         0.018      
                           1 (0.5)                       
  URCOMPINJ (%)            212 (98.6)         0.912      
                           3 (1.4)                       
  URCOMPOBST (%)           199 (92.6)         0.003      
                           16 (7.4)                      
  URCOMPSTEN (%)           200 (93.0)         0.181      
                           15 (7.0)                      
  UTIpostop (%)            148 (68.8)         0.069      
                           67 (31.2)                     
  SURGIND (%)              9 (4.2)            0.002      
                           2 (0.9)                       
                           75 (34.9)                     
                           121 (56.3)                    
                           1 (0.5)                       
                           0 (0.0)                       
                           5 (2.3)                       
                           0 (0.0)                       
                           2 (0.9)                       
                           0 (0.0)                       
                           0 (0.0)                       
  VURRECG01 (%)            196 (91.2)         0.035      
                           19 (8.8)                      
  REC011 (%)               158 (73.5)         <0.001     
                           11 (5.1)                      
                           46 (21.4)                     
> 
> # Save the matrix as a CSV file
> write.csv(as.data.frame(table1_matrix), file = "Table1_descriptive.csv", row.names = TRUE)
 
> # Calculate median and IQR manually for numeric variables
> calc_median_iqr <- function(var, group) {
+   data %>%
+     group_by(.data[[group]]) %>%
+     summarise(
+       Median = median(.data[[var]], na.rm = TRUE),
+       Q1 = quantile(.data[[var]], 0.25, na.rm = TRUE),
+       Q3 = quantile(.data[[var]], 0.75, na.rm = TRUE)
+     )
+ }
> 
> # Loop through numeric variables and calculate median/IQR for treatment groups
> library(dplyr)
> results_numeric <- lapply(numeric_vars, calc_median_iqr, group = "TRTn2")
> names(results_numeric) <- numeric_vars
> 
> # Combine numeric and categorical results
> results_numeric_combined <- do.call(rbind, lapply(results_numeric, function(x) {
+   x %>% mutate(Statistic = paste0(Median, " (", Q1, "-", Q3, ")")) %>%
+     select(Statistic)
+ }))
> 
> # Export the results
> write.csv(results_numeric_combined, "Numeric_Median_Original Cohort_Stratified_IQR.csv")
> #For VUR recurrence : REC011
> matrix <- matrix(c(14, 90, 11, 158), nrow = 2, byrow = TRUE)
>  
> # Chi-square test
> chisq.test(matrix)

        Pearson's Chi-squared test with Yates' continuity
        correction

data:  matrix
X-squared = 2.952, df = 1, p-value = 0.08577
 
> # Descriptive statistics for the whole cohort (not stratified by treatment group):
> 
> # Load the required package
> if (!requireNamespace("tableone", quietly = TRUE)) {
+   install.packages("tableone")
+ }
> library(tableone)
> 
> # Specify variables
> numeric_vars <- c("AGS", "BMI", "BLDLOSS", "CATHPERIOD", "FUPm", 
+                   "HOSPTIME", "OPRTIME", "UTIpostopFup", "UTIpostopT")
> 
> factor_vars <- c("PREOPVURGRADE", "HISTOINJ", "PREOPRNPLN", "PREOPRNSCR", "VURSIDE", 
+                  "VURPHASE", "PREOPEPISODEn", "PREOPTYPEUn", "SURGTECHn2", "TRTn2", 
+                  "ANASTOMO", "BLDCOMPLEAK", "BLDCOMPRETN", "BLDCOMPVOID", "BLDSPASM", 
+                  "CATH", "Center", "CLAVIENCLASS", "EPIDURAL", "GENDER", "GU30", 
+                  "GU90", "GUER30", "GUER90", "HEMAT", "ILEUS", "INCCOMPBLEED", 
+                  "INCCOMPINF", "INCCOMPSCAR", "NARC", "NONARC", "PAIN", "PROC365", 
+                  "STENT", "UDR7M", "URCOMPCVUR", "URCOMPINJ", "URCOMPOBST", 
+                  "URCOMPSTEN", "UTIpostop", "SURGIND", "VURRECG01", "REC011")
> 
> all_vars <- c(numeric_vars, factor_vars)
> 
> # Create Table 1 for the whole cohort
> table1 <- CreateTableOne(vars = all_vars, data = data, test = FALSE)
> 
> # Print Table 1 without p-values (since there are no groups)
> print(table1, showAllLevels = TRUE)
                          
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          
                           Overall      
  n                          413        
  AGS (mean (SD))           7.30 (2.80) 
  BMI (mean (SD))          15.87 (3.47) 
  BLDLOSS (mean (SD))      79.98 (63.83)
  CATHPERIOD (mean (SD))   10.42 (15.19)
  FUPm (mean (SD))         40.70 (33.45)
  HOSPTIME (mean (SD))      4.26 (2.63) 
  OPRTIME (mean (SD))      96.12 (37.68)
  UTIpostopFup (mean (SD)) 32.60 (36.34)
  UTIpostopT (mean (SD))    0.47 (1.79) 
  PREOPVURGRADE (%)           20 ( 4.8) 
                             126 (30.5) 
                             267 (64.6) 
  HISTOINJ (%)               369 (89.3) 
                              44 (10.7) 
  PREOPRNPLN (%)             325 (78.7) 
                              88 (21.3) 
  PREOPRNSCR (%)             275 (66.6) 
                             138 (33.4) 
  VURSIDE (%)                162 (39.2) 
                             251 (60.8) 
  VURPHASE (%)               227 (55.0) 
                              69 (16.7) 
                             117 (28.3) 
  PREOPEPISODEn (%)           24 ( 5.8) 
                             101 (24.5) 
                             288 (69.7) 
  PREOPTYPEUn (%)              8 ( 1.9) 
                             405 (98.1) 
  SURGTECHn2 (%)              85 (20.6) 
                             274 (66.3) 
                              54 (13.1) 
  TRTn2 (%)                  198 (47.9) 
                             215 (52.1) 
  ANASTOMO (%)               408 (98.8) 
                               5 ( 1.2) 
  BLDCOMPLEAK (%)            409 (99.0) 
                               4 ( 1.0) 
  BLDCOMPRETN (%)            354 (85.7) 
                              59 (14.3) 
  BLDCOMPVOID (%)            386 (93.5) 
                              27 ( 6.5) 
  BLDSPASM (%)               296 (71.7) 
                             117 (28.3) 
  CATH (%)                     9 ( 2.2) 
                             404 (97.8) 
  Center (%)                 291 (70.5) 
                               4 ( 1.0) 
                              37 ( 9.0) 
                              81 (19.6) 
  CLAVIENCLASS (%)           201 (62.4) 
                              83 (25.8) 
                              36 (11.2) 
                               1 ( 0.3) 
                               1 ( 0.3) 
  EPIDURAL (%)               384 (93.0) 
                              29 ( 7.0) 
  GENDER (%)                 236 (57.1) 
                             177 (42.9) 
  GU30 (%)                   350 (84.7) 
                              63 (15.3) 
  GU90 (%)                   262 (63.4) 
                             151 (36.6) 
  GUER30 (%)                 317 (76.8) 
                              96 (23.2) 
  GUER90 (%)                 306 (74.1) 
                             107 (25.9) 
  HEMAT (%)                  335 (81.1) 
                              78 (18.9) 
  ILEUS (%)                  386 (93.5) 
                              27 ( 6.5) 
  INCCOMPBLEED (%)           348 (84.3) 
                              65 (15.7) 
  INCCOMPINF (%)             383 (92.7) 
                              30 ( 7.3) 
  INCCOMPSCAR (%)            405 (98.1) 
                               8 ( 1.9) 
  NARC (%)                   220 (53.3) 
                             193 (46.7) 
  NONARC (%)                   2 ( 0.5) 
                             411 (99.5) 
  PAIN (%)                    18 ( 4.4) 
                             127 (31.1) 
                             124 (30.3) 
                             140 (34.2) 
  PROC365 (%)                400 (96.9) 
                              13 ( 3.1) 
  STENT (%)                  270 (65.4) 
                             143 (34.6) 
  UDR7M (%)                   97 (23.5) 
                             316 (76.5) 
  URCOMPCVUR (%)             368 (97.6) 
                               9 ( 2.4) 
  URCOMPINJ (%)              406 (98.3) 
                               7 ( 1.7) 
  URCOMPOBST (%)             395 (95.6) 
                              18 ( 4.4) 
  URCOMPSTEN (%)             391 (94.7) 
                              22 ( 5.3) 
  UTIpostop (%)              301 (72.9) 
                             112 (27.1) 
  SURGIND (%)                 19 ( 4.6) 
                              13 ( 3.1) 
                             133 (32.2) 
                             215 (52.1) 
                               1 ( 0.2) 
                               1 ( 0.2) 
                              11 ( 2.7) 
                               4 ( 1.0) 
                               6 ( 1.5) 
                               1 ( 0.2) 
                               9 ( 2.2) 
  VURRECG01 (%)              362 (87.7) 
                              51 (12.3) 
  REC011 (%)                 248 (60.0) 
                              25 ( 6.1) 
                             140 (33.9) 
> 
> # Convert TableOne to a matrix
> table1_matrix <- print(table1, showAllLevels = TRUE, quote = FALSE, noSpaces = TRUE)
                          
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          
                           Overall      
  n                        413          
  AGS (mean (SD))          7.30 (2.80)  
  BMI (mean (SD))          15.87 (3.47) 
  BLDLOSS (mean (SD))      79.98 (63.83)
  CATHPERIOD (mean (SD))   10.42 (15.19)
  FUPm (mean (SD))         40.70 (33.45)
  HOSPTIME (mean (SD))     4.26 (2.63)  
  OPRTIME (mean (SD))      96.12 (37.68)
  UTIpostopFup (mean (SD)) 32.60 (36.34)
  UTIpostopT (mean (SD))   0.47 (1.79)  
  PREOPVURGRADE (%)        20 (4.8)     
                           126 (30.5)   
                           267 (64.6)   
  HISTOINJ (%)             369 (89.3)   
                           44 (10.7)    
  PREOPRNPLN (%)           325 (78.7)   
                           88 (21.3)    
  PREOPRNSCR (%)           275 (66.6)   
                           138 (33.4)   
  VURSIDE (%)              162 (39.2)   
                           251 (60.8)   
  VURPHASE (%)             227 (55.0)   
                           69 (16.7)    
                           117 (28.3)   
  PREOPEPISODEn (%)        24 (5.8)     
                           101 (24.5)   
                           288 (69.7)   
  PREOPTYPEUn (%)          8 (1.9)      
                           405 (98.1)   
  SURGTECHn2 (%)           85 (20.6)    
                           274 (66.3)   
                           54 (13.1)    
  TRTn2 (%)                198 (47.9)   
                           215 (52.1)   
  ANASTOMO (%)             408 (98.8)   
                           5 (1.2)      
  BLDCOMPLEAK (%)          409 (99.0)   
                           4 (1.0)      
  BLDCOMPRETN (%)          354 (85.7)   
                           59 (14.3)    
  BLDCOMPVOID (%)          386 (93.5)   
                           27 (6.5)     
  BLDSPASM (%)             296 (71.7)   
                           117 (28.3)   
  CATH (%)                 9 (2.2)      
                           404 (97.8)   
  Center (%)               291 (70.5)   
                           4 (1.0)      
                           37 (9.0)     
                           81 (19.6)    
  CLAVIENCLASS (%)         201 (62.4)   
                           83 (25.8)    
                           36 (11.2)    
                           1 (0.3)      
                           1 (0.3)      
  EPIDURAL (%)             384 (93.0)   
                           29 (7.0)     
  GENDER (%)               236 (57.1)   
                           177 (42.9)   
  GU30 (%)                 350 (84.7)   
                           63 (15.3)    
  GU90 (%)                 262 (63.4)   
                           151 (36.6)   
  GUER30 (%)               317 (76.8)   
                           96 (23.2)    
  GUER90 (%)               306 (74.1)   
                           107 (25.9)   
  HEMAT (%)                335 (81.1)   
                           78 (18.9)    
  ILEUS (%)                386 (93.5)   
                           27 (6.5)     
  INCCOMPBLEED (%)         348 (84.3)   
                           65 (15.7)    
  INCCOMPINF (%)           383 (92.7)   
                           30 (7.3)     
  INCCOMPSCAR (%)          405 (98.1)   
                           8 (1.9)      
  NARC (%)                 220 (53.3)   
                           193 (46.7)   
  NONARC (%)               2 (0.5)      
                           411 (99.5)   
  PAIN (%)                 18 (4.4)     
                           127 (31.1)   
                           124 (30.3)   
                           140 (34.2)   
  PROC365 (%)              400 (96.9)   
                           13 (3.1)     
  STENT (%)                270 (65.4)   
                           143 (34.6)   
  UDR7M (%)                97 (23.5)    
                           316 (76.5)   
  URCOMPCVUR (%)           368 (97.6)   
                           9 (2.4)      
  URCOMPINJ (%)            406 (98.3)   
                           7 (1.7)      
  URCOMPOBST (%)           395 (95.6)   
                           18 (4.4)     
  URCOMPSTEN (%)           391 (94.7)   
                           22 (5.3)     
  UTIpostop (%)            301 (72.9)   
                           112 (27.1)   
  SURGIND (%)              19 (4.6)     
                           13 (3.1)     
                           133 (32.2)   
                           215 (52.1)   
                           1 (0.2)      
                           1 (0.2)      
                           11 (2.7)     
                           4 (1.0)      
                           6 (1.5)      
                           1 (0.2)      
                           9 (2.2)      
  VURRECG01 (%)            362 (87.7)   
                           51 (12.3)    
  REC011 (%)               248 (60.0)   
                           25 (6.1)     
                           140 (33.9)   
> 
> # Save the matrix as a CSV file
> write.csv(as.data.frame(table1_matrix), file = "Table1_WholeCohort.csv", row.names = TRUE)
>  
> # Calculate median and IQR for numeric variables
> library(dplyr)
> results_numeric <- lapply(numeric_vars, function(var) {
+   data %>%
+     summarise(
+       Median = median(.data[[var]], na.rm = TRUE),
+       Q1 = quantile(.data[[var]], 0.25, na.rm = TRUE),
+       Q3 = quantile(.data[[var]], 0.75, na.rm = TRUE)
+     ) %>%
+     mutate(Statistic = paste0(Median, " (", Q1, "-", Q3, ")")) %>%
+     select(Statistic)
+ })
> 
> # Combine numeric results into a data frame
> results_numeric_combined <- do.call(rbind, results_numeric)
> rownames(results_numeric_combined) <- numeric_vars
> 
> # Save numeric results to CSV
> write.csv(results_numeric_combined, "Numeric_Median_IQR_WholeCohort.csv", row.names = TRUE)

==================================================================================================
==================================================================================================

4. Propensity score matching

> # Do the matching
> 
> # Calculate the propensity score using logistic regression
> propensity_model <- glm(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI + AGS + PREOPRNPLN + PREOPRNSCR + 
+                          VURSIDE + VURPHASE + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, 
+                          data = data, family = binomial())
> # Add the propensity scores to the dataset
>  data$PS <- predict(propensity_model, type = "response")
>  logit_ps <- log(data$PS / (1 - data$PS))
>  sd_logit_ps <- sd(logit_ps)
>  caliper_width <- 0.11 * sd_logit_ps  # Slightly smaller than 0.2
> 
> 
> library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 
> summary(m.out, standardize=TRUE)

Call:
matchit(formula = TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI + AGS + 
    PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE + PREOPEPISODEn + 
    PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, 
    method = "nearest", caliper = caliper_width)

Summary of Balance for All Data:
                                                         Means Treated
distance                                                        0.6939
PREOPVURGRADEIII                                                0.0419
PREOPVURGRADEIV                                                 0.3442
PREOPVURGRADEV                                                  0.6140
HISTOINJNo                                                      0.8837
HISTOINJYes                                                     0.1163
BMI                                                            14.8493
AGS                                                             7.6791
PREOPRNPLNNo                                                    0.9070
PREOPRNPLNYes                                                   0.0930
PREOPRNSCRNo scarring                                           0.7953
PREOPRNSCRAny scarring                                          0.2047
VURSIDELeft                                                     0.3814
VURSIDERight                                                    0.6186
VURPHASEAt voiding                                              0.5302
VURPHASEAt filling                                              0.3163
VURPHASEAt filling and voiding                                  0.1535
PREOPEPISODEn1                                                  0.0372
PREOPEPISODEn2                                                  0.1535
PREOPEPISODEn≥ 3                                                0.8093
PREOPTYPEUnAfebrile                                             0.0047
PREOPTYPEUnFebrile                                              0.9953
SURGTECHn2≥ 100                                                 0.3256
SURGTECHn250 - 100                                              0.6326
SURGTECHn2<50                                                   0.0419
GENDERMale                                                      0.5953
GENDERFemale                                                    0.4047
UDR7M< 7 mm                                                     0.3023
UDR7M≥ 7mm                                                      0.6977
SURGINDPoor compliance to medical treatment                     0.0419
SURGINDChildren with ineffective or poorly tolerated CAP        0.0093
SURGINDSymptomatic high-grade reflux (III-V)                    0.3488
SURGINDRepeated breakthrough UTI                                0.5628
SURGINDGirls with persistent VUR after puberty                  0.0047
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0233
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0093
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Means Control
distance                                                        0.3324
PREOPVURGRADEIII                                                0.0556
PREOPVURGRADEIV                                                 0.2626
PREOPVURGRADEV                                                  0.6818
HISTOINJNo                                                      0.9040
HISTOINJYes                                                     0.0960
BMI                                                            16.9864
AGS                                                             6.8914
PREOPRNPLNNo                                                    0.6566
PREOPRNPLNYes                                                   0.3434
PREOPRNSCRNo scarring                                           0.5253
PREOPRNSCRAny scarring                                          0.4747
VURSIDELeft                                                     0.4040
VURSIDERight                                                    0.5960
VURPHASEAt voiding                                              0.5707
VURPHASEAt filling                                              0.0051
VURPHASEAt filling and voiding                                  0.4242
PREOPEPISODEn1                                                  0.0808
PREOPEPISODEn2                                                  0.3434
PREOPEPISODEn≥ 3                                                0.5758
PREOPTYPEUnAfebrile                                             0.0354
PREOPTYPEUnFebrile                                              0.9646
SURGTECHn2≥ 100                                                 0.0758
SURGTECHn250 - 100                                              0.6970
SURGTECHn2<50                                                   0.2273
GENDERMale                                                      0.5455
GENDERFemale                                                    0.4545
UDR7M< 7 mm                                                     0.1616
UDR7M≥ 7mm                                                      0.8384
SURGINDPoor compliance to medical treatment                     0.0505
SURGINDChildren with ineffective or poorly tolerated CAP        0.0556
SURGINDSymptomatic high-grade reflux (III-V)                    0.2929
SURGINDRepeated breakthrough UTI                                0.4747
SURGINDGirls with persistent VUR after puberty                  0.0000
SURGINDVUR recurrence after endoscopic injection                0.0051
SURGINDReflux nephropathy                                       0.0303
SURGINDPresence of new renal scars on DMSA                      0.0202
SURGINDWorsening in renal function                              0.0202
SURGINDParental preference                                      0.0051
SURGINDPersistent reflux >2 years                               0.0455
                                                         Std. Mean Diff.
distance                                                          1.4219
PREOPVURGRADEIII                                                 -0.0684
PREOPVURGRADEIV                                                   0.1717
PREOPVURGRADEV                                                   -0.1394
HISTOINJNo                                                       -0.0634
HISTOINJYes                                                       0.0634
BMI                                                              -0.8280
AGS                                                               0.3528
PREOPRNPLNNo                                                      0.8621
PREOPRNPLNYes                                                    -0.8621
PREOPRNSCRNo scarring                                             0.6695
PREOPRNSCRAny scarring                                           -0.6695
VURSIDELeft                                                      -0.0466
VURSIDERight                                                      0.0466
VURPHASEAt voiding                                               -0.0811
VURPHASEAt filling                                                0.6693
VURPHASEAt filling and voiding                                   -0.7511
PREOPEPISODEn1                                                   -0.2303
PREOPEPISODEn2                                                   -0.5270
PREOPEPISODEn≥ 3                                                  0.5945
PREOPTYPEUnAfebrile                                              -0.4512
PREOPTYPEUnFebrile                                                0.4512
SURGTECHn2≥ 100                                                   0.5331
SURGTECHn250 - 100                                               -0.1336
SURGTECHn2<50                                                    -0.9258
GENDERMale                                                        0.1017
GENDERFemale                                                     -0.1017
UDR7M< 7 mm                                                       0.3064
UDR7M≥ 7mm                                                       -0.3064
SURGINDPoor compliance to medical treatment                      -0.0432
SURGINDChildren with ineffective or poorly tolerated CAP         -0.4818
SURGINDSymptomatic high-grade reflux (III-V)                      0.1173
SURGINDRepeated breakthrough UTI                                  0.1775
SURGINDGirls with persistent VUR after puberty                    0.0684
SURGINDVUR recurrence after endoscopic injection                 -0.1029
SURGINDReflux nephropathy                                        -0.0468
SURGINDPresence of new renal scars on DMSA                       -0.2074
SURGINDWorsening in renal function                               -0.1135
SURGINDParental preference                                       -0.1029
SURGINDPersistent reflux >2 years                                -0.3152
                                                         Var. Ratio
distance                                                     1.2698
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                          0.4302
AGS                                                          0.4700
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                    0.3476
PREOPVURGRADEIII                                            0.0137
PREOPVURGRADEIV                                             0.0816
PREOPVURGRADEV                                              0.0679
HISTOINJNo                                                  0.0203
HISTOINJYes                                                 0.0203
BMI                                                         0.1801
AGS                                                         0.0560
PREOPRNPLNNo                                                0.2504
PREOPRNPLNYes                                               0.2504
PREOPRNSCRNo scarring                                       0.2701
PREOPRNSCRAny scarring                                      0.2701
VURSIDELeft                                                 0.0226
VURSIDERight                                                0.0226
VURPHASEAt voiding                                          0.0405
VURPHASEAt filling                                          0.3112
VURPHASEAt filling and voiding                              0.2708
PREOPEPISODEn1                                              0.0436
PREOPEPISODEn2                                              0.1899
PREOPEPISODEn≥ 3                                            0.2335
PREOPTYPEUnAfebrile                                         0.0307
PREOPTYPEUnFebrile                                          0.0307
SURGTECHn2≥ 100                                             0.2498
SURGTECHn250 - 100                                          0.0644
SURGTECHn2<50                                               0.1854
GENDERMale                                                  0.0499
GENDERFemale                                                0.0499
UDR7M< 7 mm                                                 0.1407
UDR7M≥ 7mm                                                  0.1407
SURGINDPoor compliance to medical treatment                 0.0086
SURGINDChildren with ineffective or poorly tolerated CAP    0.0463
SURGINDSymptomatic high-grade reflux (III-V)                0.0559
SURGINDRepeated breakthrough UTI                            0.0880
SURGINDGirls with persistent VUR after puberty              0.0047
SURGINDVUR recurrence after endoscopic injection            0.0051
SURGINDReflux nephropathy                                   0.0070
SURGINDPresence of new renal scars on DMSA                  0.0202
SURGINDWorsening in renal function                          0.0109
SURGINDParental preference                                  0.0051
SURGINDPersistent reflux >2 years                           0.0455
                                                         eCDF Max
distance                                                   0.5375
PREOPVURGRADEIII                                           0.0137
PREOPVURGRADEIV                                            0.0816
PREOPVURGRADEV                                             0.0679
HISTOINJNo                                                 0.0203
HISTOINJYes                                                0.0203
BMI                                                        0.3310
AGS                                                        0.2014
PREOPRNPLNNo                                               0.2504
PREOPRNPLNYes                                              0.2504
PREOPRNSCRNo scarring                                      0.2701
PREOPRNSCRAny scarring                                     0.2701
VURSIDELeft                                                0.0226
VURSIDERight                                               0.0226
VURPHASEAt voiding                                         0.0405
VURPHASEAt filling                                         0.3112
VURPHASEAt filling and voiding                             0.2708
PREOPEPISODEn1                                             0.0436
PREOPEPISODEn2                                             0.1899
PREOPEPISODEn≥ 3                                           0.2335
PREOPTYPEUnAfebrile                                        0.0307
PREOPTYPEUnFebrile                                         0.0307
SURGTECHn2≥ 100                                            0.2498
SURGTECHn250 - 100                                         0.0644
SURGTECHn2<50                                              0.1854
GENDERMale                                                 0.0499
GENDERFemale                                               0.0499
UDR7M< 7 mm                                                0.1407
UDR7M≥ 7mm                                                 0.1407
SURGINDPoor compliance to medical treatment                0.0086
SURGINDChildren with ineffective or poorly tolerated CAP   0.0463
SURGINDSymptomatic high-grade reflux (III-V)               0.0559
SURGINDRepeated breakthrough UTI                           0.0880
SURGINDGirls with persistent VUR after puberty             0.0047
SURGINDVUR recurrence after endoscopic injection           0.0051
SURGINDReflux nephropathy                                  0.0070
SURGINDPresence of new renal scars on DMSA                 0.0202
SURGINDWorsening in renal function                         0.0109
SURGINDParental preference                                 0.0051
SURGINDPersistent reflux >2 years                          0.0455

Summary of Balance for Matched Data:
                                                         Means Treated
distance                                                        0.5601
PREOPVURGRADEIII                                                0.0551
PREOPVURGRADEIV                                                 0.3622
PREOPVURGRADEV                                                  0.5827
HISTOINJNo                                                      0.8740
HISTOINJYes                                                     0.1260
BMI                                                            15.4328
AGS                                                             7.5039
PREOPRNPLNNo                                                    0.8425
PREOPRNPLNYes                                                   0.1575
PREOPRNSCRNo scarring                                           0.7244
PREOPRNSCRAny scarring                                          0.2756
VURSIDELeft                                                     0.3780
VURSIDERight                                                    0.6220
VURPHASEAt voiding                                              0.7323
VURPHASEAt filling                                              0.0236
VURPHASEAt filling and voiding                                  0.2441
PREOPEPISODEn1                                                  0.0472
PREOPEPISODEn2                                                  0.2520
PREOPEPISODEn≥ 3                                                0.7008
PREOPTYPEUnAfebrile                                             0.0079
PREOPTYPEUnFebrile                                              0.9921
SURGTECHn2≥ 100                                                 0.1102
SURGTECHn250 - 100                                              0.8189
SURGTECHn2<50                                                   0.0709
GENDERMale                                                      0.5669
GENDERFemale                                                    0.4331
UDR7M< 7 mm                                                     0.3150
UDR7M≥ 7mm                                                      0.6850
SURGINDPoor compliance to medical treatment                     0.0551
SURGINDChildren with ineffective or poorly tolerated CAP        0.0157
SURGINDSymptomatic high-grade reflux (III-V)                    0.4252
SURGINDRepeated breakthrough UTI                                0.4567
SURGINDGirls with persistent VUR after puberty                  0.0079
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0315
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0079
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Means Control
distance                                                        0.4582
PREOPVURGRADEIII                                                0.0709
PREOPVURGRADEIV                                                 0.2756
PREOPVURGRADEV                                                  0.6535
HISTOINJNo                                                      0.8740
HISTOINJYes                                                     0.1260
BMI                                                            15.9707
AGS                                                             7.3575
PREOPRNPLNNo                                                    0.7638
PREOPRNPLNYes                                                   0.2362
PREOPRNSCRNo scarring                                           0.6693
PREOPRNSCRAny scarring                                          0.3307
VURSIDELeft                                                     0.3858
VURSIDERight                                                    0.6142
VURPHASEAt voiding                                              0.6929
VURPHASEAt filling                                              0.0079
VURPHASEAt filling and voiding                                  0.2992
PREOPEPISODEn1                                                  0.0551
PREOPEPISODEn2                                                  0.3071
PREOPEPISODEn≥ 3                                                0.6378
PREOPTYPEUnAfebrile                                             0.0157
PREOPTYPEUnFebrile                                              0.9843
SURGTECHn2≥ 100                                                 0.1024
SURGTECHn250 - 100                                              0.7638
SURGTECHn2<50                                                   0.1339
GENDERMale                                                      0.5433
GENDERFemale                                                    0.4567
UDR7M< 7 mm                                                     0.2126
UDR7M≥ 7mm                                                      0.7874
SURGINDPoor compliance to medical treatment                     0.0551
SURGINDChildren with ineffective or poorly tolerated CAP        0.0079
SURGINDSymptomatic high-grade reflux (III-V)                    0.4016
SURGINDRepeated breakthrough UTI                                0.4803
SURGINDGirls with persistent VUR after puberty                  0.0000
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0394
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0157
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Std. Mean Diff.
distance                                                          0.4011
PREOPVURGRADEIII                                                 -0.0786
PREOPVURGRADEIV                                                   0.1823
PREOPVURGRADEV                                                   -0.1456
HISTOINJNo                                                        0.0000
HISTOINJYes                                                       0.0000
BMI                                                              -0.2084
AGS                                                               0.0656
PREOPRNPLNNo                                                      0.2711
PREOPRNPLNYes                                                    -0.2711
PREOPRNSCRNo scarring                                             0.1366
PREOPRNSCRAny scarring                                           -0.1366
VURSIDELeft                                                      -0.0162
VURSIDERight                                                      0.0162
VURPHASEAt voiding                                                0.0789
VURPHASEAt filling                                                0.0339
VURPHASEAt filling and voiding                                   -0.1529
PREOPEPISODEn1                                                   -0.0416
PREOPEPISODEn2                                                   -0.1529
PREOPEPISODEn≥ 3                                                  0.1603
PREOPTYPEUnAfebrile                                              -0.1157
PREOPTYPEUnFebrile                                                0.1157
SURGTECHn2≥ 100                                                   0.0168
SURGTECHn250 - 100                                                0.1143
SURGTECHn2<50                                                    -0.3145
GENDERMale                                                        0.0481
GENDERFemale                                                     -0.0481
UDR7M< 7 mm                                                       0.2229
UDR7M≥ 7mm                                                       -0.2229
SURGINDPoor compliance to medical treatment                       0.0000
SURGINDChildren with ineffective or poorly tolerated CAP          0.0820
SURGINDSymptomatic high-grade reflux (III-V)                      0.0496
SURGINDRepeated breakthrough UTI                                 -0.0476
SURGINDGirls with persistent VUR after puberty                    0.1157
SURGINDVUR recurrence after endoscopic injection                  0.0000
SURGINDReflux nephropathy                                        -0.0522
SURGINDPresence of new renal scars on DMSA                        0.0000
SURGINDWorsening in renal function                               -0.0820
SURGINDParental preference                                        0.0000
SURGINDPersistent reflux >2 years                                 0.0000
                                                         Var. Ratio
distance                                                     1.3787
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                          0.7659
AGS                                                          0.7608
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                    0.1102
PREOPVURGRADEIII                                            0.0157
PREOPVURGRADEIV                                             0.0866
PREOPVURGRADEV                                              0.0709
HISTOINJNo                                                  0.0000
HISTOINJYes                                                 0.0000
BMI                                                         0.0622
AGS                                                         0.0379
PREOPRNPLNNo                                                0.0787
PREOPRNPLNYes                                               0.0787
PREOPRNSCRNo scarring                                       0.0551
PREOPRNSCRAny scarring                                      0.0551
VURSIDELeft                                                 0.0079
VURSIDERight                                                0.0079
VURPHASEAt voiding                                          0.0394
VURPHASEAt filling                                          0.0157
VURPHASEAt filling and voiding                              0.0551
PREOPEPISODEn1                                              0.0079
PREOPEPISODEn2                                              0.0551
PREOPEPISODEn≥ 3                                            0.0630
PREOPTYPEUnAfebrile                                         0.0079
PREOPTYPEUnFebrile                                          0.0079
SURGTECHn2≥ 100                                             0.0079
SURGTECHn250 - 100                                          0.0551
SURGTECHn2<50                                               0.0630
GENDERMale                                                  0.0236
GENDERFemale                                                0.0236
UDR7M< 7 mm                                                 0.1024
UDR7M≥ 7mm                                                  0.1024
SURGINDPoor compliance to medical treatment                 0.0000
SURGINDChildren with ineffective or poorly tolerated CAP    0.0079
SURGINDSymptomatic high-grade reflux (III-V)                0.0236
SURGINDRepeated breakthrough UTI                            0.0236
SURGINDGirls with persistent VUR after puberty              0.0079
SURGINDVUR recurrence after endoscopic injection            0.0000
SURGINDReflux nephropathy                                   0.0079
SURGINDPresence of new renal scars on DMSA                  0.0000
SURGINDWorsening in renal function                          0.0079
SURGINDParental preference                                  0.0000
SURGINDPersistent reflux >2 years                           0.0000
                                                         eCDF Max
distance                                                   0.2992
PREOPVURGRADEIII                                           0.0157
PREOPVURGRADEIV                                            0.0866
PREOPVURGRADEV                                             0.0709
HISTOINJNo                                                 0.0000
HISTOINJYes                                                0.0000
BMI                                                        0.1732
AGS                                                        0.1181
PREOPRNPLNNo                                               0.0787
PREOPRNPLNYes                                              0.0787
PREOPRNSCRNo scarring                                      0.0551
PREOPRNSCRAny scarring                                     0.0551
VURSIDELeft                                                0.0079
VURSIDERight                                               0.0079
VURPHASEAt voiding                                         0.0394
VURPHASEAt filling                                         0.0157
VURPHASEAt filling and voiding                             0.0551
PREOPEPISODEn1                                             0.0079
PREOPEPISODEn2                                             0.0551
PREOPEPISODEn≥ 3                                           0.0630
PREOPTYPEUnAfebrile                                        0.0079
PREOPTYPEUnFebrile                                         0.0079
SURGTECHn2≥ 100                                            0.0079
SURGTECHn250 - 100                                         0.0551
SURGTECHn2<50                                              0.0630
GENDERMale                                                 0.0236
GENDERFemale                                               0.0236
UDR7M< 7 mm                                                0.1024
UDR7M≥ 7mm                                                 0.1024
SURGINDPoor compliance to medical treatment                0.0000
SURGINDChildren with ineffective or poorly tolerated CAP   0.0079
SURGINDSymptomatic high-grade reflux (III-V)               0.0236
SURGINDRepeated breakthrough UTI                           0.0236
SURGINDGirls with persistent VUR after puberty             0.0079
SURGINDVUR recurrence after endoscopic injection           0.0000
SURGINDReflux nephropathy                                  0.0079
SURGINDPresence of new renal scars on DMSA                 0.0000
SURGINDWorsening in renal function                         0.0079
SURGINDParental preference                                 0.0000
SURGINDPersistent reflux >2 years                          0.0000
                                                         Std. Pair Dist.
distance                                                          0.4013
PREOPVURGRADEIII                                                  0.6291
PREOPVURGRADEIV                                                   0.8784
PREOPVURGRADEV                                                    0.9219
HISTOINJNo                                                        0.2520
HISTOINJYes                                                       0.2520
BMI                                                               1.2533
AGS                                                               1.2928
PREOPRNPLNNo                                                      0.7590
PREOPRNPLNYes                                                     0.7590
PREOPRNSCRNo scarring                                             1.1125
PREOPRNSCRAny scarring                                            1.1125
VURSIDELeft                                                       0.7295
VURSIDERight                                                      0.7295
VURPHASEAt voiding                                                0.8046
VURPHASEAt filling                                                0.0677
VURPHASEAt filling and voiding                                    1.0704
PREOPEPISODEn1                                                    0.4576
PREOPEPISODEn2                                                    1.2014
PREOPEPISODEn≥ 3                                                  1.1224
PREOPTYPEUnAfebrile                                               0.3472
PREOPTYPEUnFebrile                                                0.3472
SURGTECHn2≥ 100                                                   0.3865
SURGTECHn250 - 100                                                0.6370
SURGTECHn2<50                                                     0.6291
GENDERMale                                                        0.9144
GENDERFemale                                                      0.9144
UDR7M< 7 mm                                                       0.8401
UDR7M≥ 7mm                                                        0.8401
SURGINDPoor compliance to medical treatment                       0.0945
SURGINDChildren with ineffective or poorly tolerated CAP          0.2461
SURGINDSymptomatic high-grade reflux (III-V)                      0.9087
SURGINDRepeated breakthrough UTI                                  1.0318
SURGINDGirls with persistent VUR after puberty                    0.1157
SURGINDVUR recurrence after endoscopic injection                  0.0000
SURGINDReflux nephropathy                                         0.4702
SURGINDPresence of new renal scars on DMSA                        0.0000
SURGINDWorsening in renal function                                0.2461
SURGINDParental preference                                        0.0000
SURGINDPersistent reflux >2 years                                 0.0000

Sample Sizes:
          Control Treated
All           198     215
Matched       127     127
Unmatched      71      88
Discarded       0       0

> # Extract the matched dataset from the matchit object
> mdata <- match.data(m.out)
> 
> library(tableone)
> # Create the table for the matched data with your specified variables
>  tableb <- CreateTableOne(
+    vars = c('PREOPVURGRADE', 'HISTOINJ', 'BMI', 'AGS', 'PREOPRNPLN', 
+             'PREOPRNSCR', 'VURSIDE', 'VURPHASE', 'PREOPEPISODEn', 
+             'PREOPTYPEUn', 'SURGTECHn2', 'GENDER', 'UDR7M', 'SURGIND'),
+    data = mdata,
+    factorVars = c('PREOPVURGRADE', 'HISTOINJ', 'PREOPRNPLN', 'PREOPRNSCR','VURSIDE', 'VURPHASE','SURGTECHn2','PREOPTYPEUn', 'PREOPEPISODEn', 'GENDER', 'UDR7M', 'SURGIND'),  # Categorical variables
+    strata = 'TRTn2',  # Adjust if needed based on your dataset
+    smd = TRUE          # Include standardized mean differences
+  )
> # Print the table with SMDs and other options
>  tableb <- print(
+    tableb,
+    smd = TRUE,               # Include standardized mean differences
+    showAllLevels = TRUE,     # Show all levels for factor variables
+    noSpaces = TRUE,          # Remove spaces in output
+    printToggle = FALSE       # Don't print a toggle for summary
+  )
>  tableb
                   Stratified by TRTn2
                    level                                              
  n                 ""                                                 
  PREOPVURGRADE (%) "III"                                              
                    "IV"                                               
                    "V"                                                
  HISTOINJ (%)      "No"                                               
                    "Yes"                                              
  BMI (mean (SD))   ""                                                 
  AGS (mean (SD))   ""                                                 
  PREOPRNPLN (%)    "No"                                               
                    "Yes"                                              
  PREOPRNSCR (%)    "No scarring"                                      
                    "Any scarring"                                     
  VURSIDE (%)       "Left"                                             
                    "Right"                                            
  VURPHASE (%)      "At voiding"                                       
                    "At filling"                                       
                    "At filling and voiding"                           
  PREOPEPISODEn (%) "1"                                                
                    "2"                                                
                    "≥ 3"                                              
  PREOPTYPEUn (%)   "Afebrile"                                         
                    "Febrile"                                          
  SURGTECHn2 (%)    "≥ 100"                                            
                    "50 - 100"                                         
                    "<50"                                              
  GENDER (%)        "Male"                                             
                    "Female"                                           
  UDR7M (%)         "< 7 mm"                                           
                    "≥ 7mm"                                            
  SURGIND (%)       "Poor compliance to medical treatment"             
                    "Children with ineffective or poorly tolerated CAP"
                    "Symptomatic high-grade reflux (III-V)"            
                    "Repeated breakthrough UTI"                        
                    "Girls with persistent VUR after puberty"          
                    "Reflux nephropathy"                               
                    "Worsening in renal function"                      
                   Stratified by TRTn2
                    Cohen group    Lich-Gregoir group
  n                 "127"          "127"             
  PREOPVURGRADE (%) "9 (7.1)"      "7 (5.5)"         
                    "35 (27.6)"    "46 (36.2)"       
                    "83 (65.4)"    "74 (58.3)"       
  HISTOINJ (%)      "111 (87.4)"   "111 (87.4)"      
                    "16 (12.6)"    "16 (12.6)"       
  BMI (mean (SD))   "15.97 (3.53)" "15.43 (3.09)"    
  AGS (mean (SD))   "7.36 (2.98)"  "7.50 (2.60)"     
  PREOPRNPLN (%)    "97 (76.4)"    "107 (84.3)"      
                    "30 (23.6)"    "20 (15.7)"       
  PREOPRNSCR (%)    "85 (66.9)"    "92 (72.4)"       
                    "42 (33.1)"    "35 (27.6)"       
  VURSIDE (%)       "49 (38.6)"    "48 (37.8)"       
                    "78 (61.4)"    "79 (62.2)"       
  VURPHASE (%)      "88 (69.3)"    "93 (73.2)"       
                    "1 (0.8)"      "3 (2.4)"         
                    "38 (29.9)"    "31 (24.4)"       
  PREOPEPISODEn (%) "7 (5.5)"      "6 (4.7)"         
                    "39 (30.7)"    "32 (25.2)"       
                    "81 (63.8)"    "89 (70.1)"       
  PREOPTYPEUn (%)   "2 (1.6)"      "1 (0.8)"         
                    "125 (98.4)"   "126 (99.2)"      
  SURGTECHn2 (%)    "13 (10.2)"    "14 (11.0)"       
                    "97 (76.4)"    "104 (81.9)"      
                    "17 (13.4)"    "9 (7.1)"         
  GENDER (%)        "69 (54.3)"    "72 (56.7)"       
                    "58 (45.7)"    "55 (43.3)"       
  UDR7M (%)         "27 (21.3)"    "40 (31.5)"       
                    "100 (78.7)"   "87 (68.5)"       
  SURGIND (%)       "7 (5.5)"      "7 (5.5)"         
                    "1 (0.8)"      "2 (1.6)"         
                    "51 (40.2)"    "54 (42.5)"       
                    "61 (48.0)"    "58 (45.7)"       
                    "0 (0.0)"      "1 (0.8)"         
                    "5 (3.9)"      "4 (3.1)"         
                    "2 (1.6)"      "1 (0.8)"         
                   Stratified by TRTn2
                    p       test SMD     
  n                 ""      ""   ""      
  PREOPVURGRADE (%) "0.323" ""   "0.189" 
                    ""      ""   ""      
                    ""      ""   ""      
  HISTOINJ (%)      "1.000" ""   "<0.001"
                    ""      ""   ""      
  BMI (mean (SD))   "0.197" ""   "0.162" 
  AGS (mean (SD))   "0.677" ""   "0.052" 
  PREOPRNPLN (%)    "0.156" ""   "0.199" 
                    ""      ""   ""      
  PREOPRNSCR (%)    "0.413" ""   "0.120" 
                    ""      ""   ""      
  VURSIDE (%)       "1.000" ""   "0.016" 
                    ""      ""   ""      
  VURPHASE (%)      "0.397" ""   "0.171" 
                    ""      ""   ""      
                    ""      ""   ""      
  PREOPEPISODEn (%) "0.565" ""   "0.134" 
                    ""      ""   ""      
                    ""      ""   ""      
  PREOPTYPEUn (%)   "1.000" ""   "0.073" 
                    ""      ""   ""      
  SURGTECHn2 (%)    "0.254" ""   "0.209" 
                    ""      ""   ""      
                    ""      ""   ""      
  GENDER (%)        "0.801" ""   "0.048" 
                    ""      ""   ""      
  UDR7M (%)         "0.088" ""   "0.234" 
                    ""      ""   ""      
  SURGIND (%)       "0.925" ""   "0.175" 
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
> write.csv(tableb, file = "Tableb_after_matching.csv")
> if (!requireNamespace("tableone", quietly = TRUE)) install.packages("tableone")
> library(tableone)
> 
> # Define variables
> vars <- c('AGS','GENDER','BMI','HISTOINJ', 'SURGIND', 'PREOPVURGRADE','UDR7M','VURSIDE', 
+            'VURPHASE','PREOPTYPEUn', 'PREOPEPISODEn', 'PREOPRNPLN', 'PREOPRNSCR', 
+            'SURGTECHn2' )
> 
> factor_vars <- c('GENDER','HISTOINJ', 'SURGIND', 'PREOPVURGRADE','UDR7M','VURSIDE',
+   'VURPHASE','PREOPTYPEUn', 'PREOPEPISODEn', 'PREOPRNPLN', 'PREOPRNSCR', 
+            'SURGTECHn2' )
> 
> # Table for unmatched data (before matching)
> table_unmatched <- CreateTableOne(
+   vars = vars,
+   data = data,    # Replace with the name of your unmatched dataset
+   factorVars = factor_vars,
+   strata = 'TRTn2',        # Stratify by treatment group
+   smd = TRUE               # Include standardized mean differences
+ )
> 
> # Table for matched data (after matching)
> table_matched <- CreateTableOne(
+   vars = vars,
+   data = mdata,            # Replace with the name of your matched dataset
+   factorVars = factor_vars,
+   strata = 'TRTn2',        # Stratify by treatment group
+   smd = TRUE               # Include standardized mean differences
+ )
> 
> # Print and save both tables
> table_unmatched <- print(
+   table_unmatched,
+   smd = TRUE, showAllLevels = TRUE, noSpaces = TRUE, printToggle = FALSE
+ )
> 
> table_matched <- print(
+   table_matched,
+   smd = TRUE, showAllLevels = TRUE, noSpaces = TRUE, printToggle = FALSE
+ )
> 
> # Save as CSV files
> write.csv(as.data.frame(table_unmatched), "Tableb_Before_Matching.csv", row.names = TRUE)
> write.csv(as.data.frame(table_matched), "Tableb_After_Matching.csv", row.names = TRUE)
> 
> # View the tables
> table_unmatched
                   Stratified by TRTn2
                    level                                              
  n                 ""                                                 
  AGS (mean (SD))   ""                                                 
  GENDER (%)        "Male"                                             
                    "Female"                                           
  BMI (mean (SD))   ""                                                 
  HISTOINJ (%)      "No"                                               
                    "Yes"                                              
  SURGIND (%)       "Poor compliance to medical treatment"             
                    "Children with ineffective or poorly tolerated CAP"
                    "Symptomatic high-grade reflux (III-V)"            
                    "Repeated breakthrough UTI"                        
                    "Girls with persistent VUR after puberty"          
                    "VUR recurrence after endoscopic injection"        
                    "Reflux nephropathy"                               
                    "Presence of new renal scars on DMSA"              
                    "Worsening in renal function"                      
                    "Parental preference"                              
                    "Persistent reflux >2 years"                       
  PREOPVURGRADE (%) "III"                                              
                    "IV"                                               
                    "V"                                                
  UDR7M (%)         "< 7 mm"                                           
                    "≥ 7mm"                                            
  VURSIDE (%)       "Left"                                             
                    "Right"                                            
  VURPHASE (%)      "At voiding"                                       
                    "At filling"                                       
                    "At filling and voiding"                           
  PREOPTYPEUn (%)   "Afebrile"                                         
                    "Febrile"                                          
  PREOPEPISODEn (%) "1"                                                
                    "2"                                                
                    "≥ 3"                                              
  PREOPRNPLN (%)    "No"                                               
                    "Yes"                                              
  PREOPRNSCR (%)    "No scarring"                                      
                    "Any scarring"                                     
  SURGTECHn2 (%)    "≥ 100"                                            
                    "50 - 100"                                         
                    "<50"                                              
                   Stratified by TRTn2
                    Cohen group    Lich-Gregoir group
  n                 "198"          "215"             
  AGS (mean (SD))   "6.89 (3.26)"  "7.68 (2.23)"     
  GENDER (%)        "108 (54.5)"   "128 (59.5)"      
                    "90 (45.5)"    "87 (40.5)"       
  BMI (mean (SD))   "16.99 (3.94)" "14.85 (2.58)"    
  HISTOINJ (%)      "179 (90.4)"   "190 (88.4)"      
                    "19 (9.6)"     "25 (11.6)"       
  SURGIND (%)       "10 (5.1)"     "9 (4.2)"         
                    "11 (5.6)"     "2 (0.9)"         
                    "58 (29.3)"    "75 (34.9)"       
                    "94 (47.5)"    "121 (56.3)"      
                    "0 (0.0)"      "1 (0.5)"         
                    "1 (0.5)"      "0 (0.0)"         
                    "6 (3.0)"      "5 (2.3)"         
                    "4 (2.0)"      "0 (0.0)"         
                    "4 (2.0)"      "2 (0.9)"         
                    "1 (0.5)"      "0 (0.0)"         
                    "9 (4.5)"      "0 (0.0)"         
  PREOPVURGRADE (%) "11 (5.6)"     "9 (4.2)"         
                    "52 (26.3)"    "74 (34.4)"       
                    "135 (68.2)"   "132 (61.4)"      
  UDR7M (%)         "32 (16.2)"    "65 (30.2)"       
                    "166 (83.8)"   "150 (69.8)"      
  VURSIDE (%)       "80 (40.4)"    "82 (38.1)"       
                    "118 (59.6)"   "133 (61.9)"      
  VURPHASE (%)      "113 (57.1)"   "114 (53.0)"      
                    "1 (0.5)"      "68 (31.6)"       
                    "84 (42.4)"    "33 (15.3)"       
  PREOPTYPEUn (%)   "7 (3.5)"      "1 (0.5)"         
                    "191 (96.5)"   "214 (99.5)"      
  PREOPEPISODEn (%) "16 (8.1)"     "8 (3.7)"         
                    "68 (34.3)"    "33 (15.3)"       
                    "114 (57.6)"   "174 (80.9)"      
  PREOPRNPLN (%)    "130 (65.7)"   "195 (90.7)"      
                    "68 (34.3)"    "20 (9.3)"        
  PREOPRNSCR (%)    "104 (52.5)"   "171 (79.5)"      
                    "94 (47.5)"    "44 (20.5)"       
  SURGTECHn2 (%)    "15 (7.6)"     "70 (32.6)"       
                    "138 (69.7)"   "136 (63.3)"      
                    "45 (22.7)"    "9 (4.2)"         
                   Stratified by TRTn2
                    p        test SMD    
  n                 ""       ""   ""     
  AGS (mean (SD))   "0.004"  ""   "0.282"
  GENDER (%)        "0.355"  ""   "0.101"
                    ""       ""   ""     
  BMI (mean (SD))   "<0.001" ""   "0.642"
  HISTOINJ (%)      "0.611"  ""   "0.066"
                    ""       ""   ""     
  SURGIND (%)       "0.002"  ""   "0.531"
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
                    ""       ""   ""     
  PREOPVURGRADE (%) "0.184"  ""   "0.182"
                    ""       ""   ""     
                    ""       ""   ""     
  UDR7M (%)         "0.001"  ""   "0.338"
                    ""       ""   ""     
  VURSIDE (%)       "0.711"  ""   "0.046"
                    ""       ""   ""     
  VURPHASE (%)      "<0.001" ""   "1.046"
                    ""       ""   ""     
                    ""       ""   ""     
  PREOPTYPEUn (%)   "0.057"  ""   "0.221"
                    ""       ""   ""     
  PREOPEPISODEn (%) "<0.001" ""   "0.523"
                    ""       ""   ""     
                    ""       ""   ""     
  PREOPRNPLN (%)    "<0.001" ""   "0.636"
                    ""       ""   ""     
  PREOPRNSCR (%)    "<0.001" ""   "0.595"
                    ""       ""   ""     
  SURGTECHn2 (%)    "<0.001" ""   "0.818"
                    ""       ""   ""     
                    ""       ""   ""     
> table_matched
                   Stratified by TRTn2
                    level                                              
  n                 ""                                                 
  AGS (mean (SD))   ""                                                 
  GENDER (%)        "Male"                                             
                    "Female"                                           
  BMI (mean (SD))   ""                                                 
  HISTOINJ (%)      "No"                                               
                    "Yes"                                              
  SURGIND (%)       "Poor compliance to medical treatment"             
                    "Children with ineffective or poorly tolerated CAP"
                    "Symptomatic high-grade reflux (III-V)"            
                    "Repeated breakthrough UTI"                        
                    "Girls with persistent VUR after puberty"          
                    "Reflux nephropathy"                               
                    "Worsening in renal function"                      
  PREOPVURGRADE (%) "III"                                              
                    "IV"                                               
                    "V"                                                
  UDR7M (%)         "< 7 mm"                                           
                    "≥ 7mm"                                            
  VURSIDE (%)       "Left"                                             
                    "Right"                                            
  VURPHASE (%)      "At voiding"                                       
                    "At filling"                                       
                    "At filling and voiding"                           
  PREOPTYPEUn (%)   "Afebrile"                                         
                    "Febrile"                                          
  PREOPEPISODEn (%) "1"                                                
                    "2"                                                
                    "≥ 3"                                              
  PREOPRNPLN (%)    "No"                                               
                    "Yes"                                              
  PREOPRNSCR (%)    "No scarring"                                      
                    "Any scarring"                                     
  SURGTECHn2 (%)    "≥ 100"                                            
                    "50 - 100"                                         
                    "<50"                                              
                   Stratified by TRTn2
                    Cohen group    Lich-Gregoir group
  n                 "127"          "127"             
  AGS (mean (SD))   "7.36 (2.98)"  "7.50 (2.60)"     
  GENDER (%)        "69 (54.3)"    "72 (56.7)"       
                    "58 (45.7)"    "55 (43.3)"       
  BMI (mean (SD))   "15.97 (3.53)" "15.43 (3.09)"    
  HISTOINJ (%)      "111 (87.4)"   "111 (87.4)"      
                    "16 (12.6)"    "16 (12.6)"       
  SURGIND (%)       "7 (5.5)"      "7 (5.5)"         
                    "1 (0.8)"      "2 (1.6)"         
                    "51 (40.2)"    "54 (42.5)"       
                    "61 (48.0)"    "58 (45.7)"       
                    "0 (0.0)"      "1 (0.8)"         
                    "5 (3.9)"      "4 (3.1)"         
                    "2 (1.6)"      "1 (0.8)"         
  PREOPVURGRADE (%) "9 (7.1)"      "7 (5.5)"         
                    "35 (27.6)"    "46 (36.2)"       
                    "83 (65.4)"    "74 (58.3)"       
  UDR7M (%)         "27 (21.3)"    "40 (31.5)"       
                    "100 (78.7)"   "87 (68.5)"       
  VURSIDE (%)       "49 (38.6)"    "48 (37.8)"       
                    "78 (61.4)"    "79 (62.2)"       
  VURPHASE (%)      "88 (69.3)"    "93 (73.2)"       
                    "1 (0.8)"      "3 (2.4)"         
                    "38 (29.9)"    "31 (24.4)"       
  PREOPTYPEUn (%)   "2 (1.6)"      "1 (0.8)"         
                    "125 (98.4)"   "126 (99.2)"      
  PREOPEPISODEn (%) "7 (5.5)"      "6 (4.7)"         
                    "39 (30.7)"    "32 (25.2)"       
                    "81 (63.8)"    "89 (70.1)"       
  PREOPRNPLN (%)    "97 (76.4)"    "107 (84.3)"      
                    "30 (23.6)"    "20 (15.7)"       
  PREOPRNSCR (%)    "85 (66.9)"    "92 (72.4)"       
                    "42 (33.1)"    "35 (27.6)"       
  SURGTECHn2 (%)    "13 (10.2)"    "14 (11.0)"       
                    "97 (76.4)"    "104 (81.9)"      
                    "17 (13.4)"    "9 (7.1)"         
                   Stratified by TRTn2
                    p       test SMD     
  n                 ""      ""   ""      
  AGS (mean (SD))   "0.677" ""   "0.052" 
  GENDER (%)        "0.801" ""   "0.048" 
                    ""      ""   ""      
  BMI (mean (SD))   "0.197" ""   "0.162" 
  HISTOINJ (%)      "1.000" ""   "<0.001"
                    ""      ""   ""      
  SURGIND (%)       "0.925" ""   "0.175" 
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
                    ""      ""   ""      
  PREOPVURGRADE (%) "0.323" ""   "0.189" 
                    ""      ""   ""      
                    ""      ""   ""      
  UDR7M (%)         "0.088" ""   "0.234" 
                    ""      ""   ""      
  VURSIDE (%)       "1.000" ""   "0.016" 
                    ""      ""   ""      
  VURPHASE (%)      "0.397" ""   "0.171" 
                    ""      ""   ""      
                    ""      ""   ""      
  PREOPTYPEUn (%)   "1.000" ""   "0.073" 
                    ""      ""   ""      
  PREOPEPISODEn (%) "0.565" ""   "0.134" 
                    ""      ""   ""      
                    ""      ""   ""      
  PREOPRNPLN (%)    "0.156" ""   "0.199" 
                    ""      ""   ""      
  PREOPRNSCR (%)    "0.413" ""   "0.120" 
                    ""      ""   ""      
  SURGTECHn2 (%)    "0.254" ""   "0.209" 
                    ""      ""   ""      
                    ""      ""   ""      
 
> # Mean SMD for the whole unmatched cohort:
> ----------------------------------------------
+ # Load the required library for reading CSV files
+ library(readr)
Error in -library(readr) : invalid argument to unary operator
> 
> # Read the CSV files
> table_unmatched <- read.csv("Tableb_Before_Matching.csv", row.names = 1)
> 
> # View the structure of the table to locate SMD columns
> str(table_unmatched)
'data.frame':   40 obs. of  6 variables:
 $ level             : chr  "" "" "Male" "Female" ...
 $ Cohen.group       : chr  "198" "6.89 (3.26)" "108 (54.5)" "90 (45.5)" ...
 $ Lich.Gregoir.group: chr  "215" "7.68 (2.23)" "128 (59.5)" "87 (40.5)" ...
 $ p                 : chr  "" "0.004" "0.355" "" ...
 $ test              : logi  NA NA NA NA NA NA ...
 $ SMD               : num  NA 0.282 0.101 NA 0.642 0.066 NA 0.531 NA NA ...
> 
> # Check the first few rows of the data to identify the relevant columns for SMDs
> head(table_unmatched)
                 level  Cohen.group Lich.Gregoir.group
n                               198                215
AGS..mean..SD..         6.89 (3.26)        7.68 (2.23)
GENDER....        Male   108 (54.5)         128 (59.5)
X               Female    90 (45.5)          87 (40.5)
BMI..mean..SD..        16.99 (3.94)       14.85 (2.58)
HISTOINJ....        No   179 (90.4)         190 (88.4)
                     p test   SMD
n                        NA    NA
AGS..mean..SD..  0.004   NA 0.282
GENDER....       0.355   NA 0.101
X                        NA    NA
BMI..mean..SD.. <0.001   NA 0.642
HISTOINJ....     0.611   NA 0.066
> 
> # If the SMD column has a specific name, such as "SMD" or contains it as part of the column name, you can extract it as follows
> # Example: extracting SMD for all variables
> smd_values <- table_unmatched$SMD  # Replace 'SMD' with the correct column name for SMDs
> 
> # If the SMDs are spread across multiple columns, you can extract them like this:
> smd_values <- table_unmatched[, grep("SMD", colnames(table_unmatched))]  # Adjust based on actual column names
> 
> # Calculate the mean SMD, or analyze it as needed
> mean_smd <- mean(as.numeric(smd_values), na.rm = TRUE)
> 
> # Print the result
> print(mean_smd)
[1] 0.4305
 
> # Mean SMD for the whole matched cohort:
> ----------------------------------------------
+ # Load the required library for reading CSV files
+ library(readr)
Error in -library(readr) : invalid argument to unary operator
> 
> # Read the CSV files
> table_matched <- read.csv("Tableb_After_Matching.csv", row.names = 1)
> 
> # View the structure of the table to locate SMD columns
> str(table_matched)
'data.frame':   36 obs. of  6 variables:
 $ level             : chr  "" "" "Male" "Female" ...
 $ Cohen.group       : chr  "127" "7.36 (2.98)" "69 (54.3)" "58 (45.7)" ...
 $ Lich.Gregoir.group: chr  "127" "7.50 (2.60)" "72 (56.7)" "55 (43.3)" ...
 $ p                 : num  NA 0.677 0.801 NA 0.197 1 NA 0.925 NA NA ...
 $ test              : logi  NA NA NA NA NA NA ...
 $ SMD               : chr  "" "0.052" "0.048" "" ...
> 
> # Check the first few rows of the data to identify the relevant columns for SMDs
> head(table_matched)
                 level  Cohen.group Lich.Gregoir.group
n                               127                127
AGS..mean..SD..         7.36 (2.98)        7.50 (2.60)
GENDER....        Male    69 (54.3)          72 (56.7)
X               Female    58 (45.7)          55 (43.3)
BMI..mean..SD..        15.97 (3.53)       15.43 (3.09)
HISTOINJ....        No   111 (87.4)         111 (87.4)
                    p test    SMD
n                  NA   NA       
AGS..mean..SD.. 0.677   NA  0.052
GENDER....      0.801   NA  0.048
X                  NA   NA       
BMI..mean..SD.. 0.197   NA  0.162
HISTOINJ....    1.000   NA <0.001
> 
> # If the SMD column has a specific name, such as "SMD" or contains it as part of the column name, you can extract it as follows
> # Example: extracting SMD for all variables
> smd_values <- table_matched$SMD  # Replace 'SMD' with the correct column name for SMDs
> 
> # If the SMDs are spread across multiple columns, you can extract them like this:
> smd_values <- table_matched[, grep("SMD", colnames(table_matched))]  # Adjust based on actual column names
> 
> # Calculate the mean SMD, or analyze it as needed
> mean_smd <- mean(as.numeric(smd_values), na.rm = TRUE)
Warning message:
In mean(as.numeric(smd_values), na.rm = TRUE) : NAs introduced by coercion
> 
> # Print the result
> print(mean_smd)
[1] 0.1370769
 
> library(dplyr)
> 
> library(tidyr)
> 
> # Define numeric variables
> numeric_vars <- c('AGS', 'BMI', 'BLDLOSS', 'FUPm', 'CATHPERIOD', 'OPRTIME', 'HOSPTIME')  # Replace with the numeric variables in your dataset
> 
> # Calculate median and IQR for numeric variables stratified by treatment group
> numeric_summary_stratified <- mdata %>%
+   select(all_of(numeric_vars), TRTn2) %>%  # Include the treatment group variable
+   group_by(TRTn2) %>%  # Stratify by treatment group
+   summarise(across(everything(), list(
+     Median = ~median(.x, na.rm = TRUE),
+     Q1 = ~quantile(.x, 0.25, na.rm = TRUE),
+     Q3 = ~quantile(.x, 0.75, na.rm = TRUE)
+   ), .names = "{col}_{fn}"))  # Naming convention for the summary columns
> 
> # Reshape the data into a readable format
> numeric_summary_stratified <- numeric_summary_stratified %>%
+   pivot_longer(cols = -TRTn2,
+                names_to = c("Variable", ".value"),
+                names_sep = "_") %>%
+   mutate(IQR = paste0(Q1, " - ", Q3))  # Combine Q1 and Q3 into IQR column
> 
> # Save the stratified summary as CSV
> write.csv(numeric_summary_stratified, "Numeric_Median_IQR_Matched_Stratifed_by_Treatment.csv", row.names = FALSE)
> 
> # View the summary
> numeric_summary_stratified
# A tibble: 14 × 6
   TRTn2              Variable   Median    Q1    Q3 IQR    
   <fct>              <chr>       <dbl> <dbl> <dbl> <chr>  
 1 Cohen group        AGS           8     6     9   6 - 9  
 2 Cohen group        BMI          14.1  13.4  18.7 13.35 …
 3 Cohen group        BLDLOSS      90    50   100   50 - 1…
 4 Cohen group        FUPm         28    24    38   24 - 38
 5 Cohen group        CATHPERIOD    4     4     6   4 - 6  
 6 Cohen group        OPRTIME     130    90   160   90 - 1…
 7 Cohen group        HOSPTIME      5     5     6   5 - 6  
 8 Lich-Gregoir group AGS           7     6     9   6 - 9  
 9 Lich-Gregoir group BMI          14.1  13.6  15.4 13.6 -…
10 Lich-Gregoir group BLDLOSS      50    40    80   40 - 80
11 Lich-Gregoir group FUPm         25    13    37.5 13 - 3…
12 Lich-Gregoir group CATHPERIOD    3     1     5   1 - 5  
13 Lich-Gregoir group OPRTIME      70    67.5  80   67.5 -…
14 Lich-Gregoir group HOSPTIME      3     2     5   2 - 5  
> # After matching
> 

==================================================================================================
==================================================================================================

5. Descriptive analysis – Matched Cohort

> # Comparative descriptive statistics for the matched cohort (stratified by treatment group):
> 
> # Descriptive analysis generating mean (SD) for numerical variables
> 
> # Load the required package
> if (!requireNamespace("tableone", quietly = TRUE)) {
+   install.packages("tableone")
+ }
> library(tableone)
> 
> # Specify variables
> numeric_vars <- c("AGS", "BMI", "BLDLOSS", "CATHPERIOD", "FUPm", 
+                   "HOSPTIME", "OPRTIME", "UTIpostopFup", "UTIpostopT")
> 
> factor_vars <- c("PREOPVURGRADE", "HISTOINJ", "PREOPRNPLN", "PREOPRNSCR", "VURSIDE", 
+                  "VURPHASE", "PREOPEPISODEn", "PREOPTYPEUn", "SURGTECHn2", "TRTn2", 
+                  "ANASTOMO", "BLDCOMPLEAK", "BLDCOMPRETN", "BLDCOMPVOID", "BLDSPASM", 
+                  "CATH", "Center", "CLAVIENCLASS", "EPIDURAL", "GENDER", "GU30", 
+                  "GU90", "GUER30","GUER90", "HEMAT", "ILEUS", "INCCOMPBLEED", "INCCOMPINF", 
+                  "INCCOMPSCAR", "NARC", "NONARC", "PAIN", "PROC365", "STENT", 
+                  "UDR7M", "URCOMPCVUR", "URCOMPINJ", "URCOMPOBST", "URCOMPSTEN", 
+                  "UTIpostop", "SURGIND", "VURRECG01" , "REC011")
> 
> all_vars <- c(numeric_vars, factor_vars)
> 
> # Create Table m
> tablem <- CreateTableOne(vars = all_vars, strata = "TRTn2", data = mdata, test = TRUE)
> 
> # Print Table 1 with p-values
> print(tablem, showAllLevels = TRUE, pDigits = 3)
                          Stratified by TRTn2
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          Stratified by TRTn2
                           Cohen group    
  n                           127         
  AGS (mean (SD))            7.36 (2.98)  
  BMI (mean (SD))           15.97 (3.53)  
  BLDLOSS (mean (SD))       97.14 (72.09) 
  CATHPERIOD (mean (SD))    12.83 (15.84) 
  FUPm (mean (SD))          40.03 (31.81) 
  HOSPTIME (mean (SD))       5.20 (1.13)  
  OPRTIME (mean (SD))      129.91 (43.63) 
  UTIpostopFup (mean (SD))  31.07 (34.54) 
  UTIpostopT (mean (SD))     0.55 (1.84)  
  PREOPVURGRADE (%)             9 (  7.1) 
                               35 ( 27.6) 
                               83 ( 65.4) 
  HISTOINJ (%)                111 ( 87.4) 
                               16 ( 12.6) 
  PREOPRNPLN (%)               97 ( 76.4) 
                               30 ( 23.6) 
  PREOPRNSCR (%)               85 ( 66.9) 
                               42 ( 33.1) 
  VURSIDE (%)                  49 ( 38.6) 
                               78 ( 61.4) 
  VURPHASE (%)                 88 ( 69.3) 
                                1 (  0.8) 
                               38 ( 29.9) 
  PREOPEPISODEn (%)             7 (  5.5) 
                               39 ( 30.7) 
                               81 ( 63.8) 
  PREOPTYPEUn (%)               2 (  1.6) 
                              125 ( 98.4) 
  SURGTECHn2 (%)               13 ( 10.2) 
                               97 ( 76.4) 
                               17 ( 13.4) 
  TRTn2 (%)                   127 (100.0) 
                                0 (  0.0) 
  ANASTOMO (%)                125 ( 98.4) 
                                2 (  1.6) 
  BLDCOMPLEAK (%)             126 ( 99.2) 
                                1 (  0.8) 
  BLDCOMPRETN (%)             111 ( 87.4) 
                               16 ( 12.6) 
  BLDCOMPVOID (%)             121 ( 95.3) 
                                6 (  4.7) 
  BLDSPASM (%)                 83 ( 65.4) 
                               44 ( 34.6) 
  CATH (%)                      2 (  1.6) 
                              125 ( 98.4) 
  Center (%)                   83 ( 65.4) 
                                2 (  1.6) 
                               12 (  9.4) 
                               30 ( 23.6) 
  CLAVIENCLASS (%)             72 ( 72.0) 
                               17 ( 17.0) 
                               10 ( 10.0) 
                                0 (  0.0) 
                                1 (  1.0) 
  EPIDURAL (%)                115 ( 90.6) 
                               12 (  9.4) 
  GENDER (%)                   69 ( 54.3) 
                               58 ( 45.7) 
  GU30 (%)                     85 ( 66.9) 
                               42 ( 33.1) 
  GU90 (%)                     56 ( 44.1) 
                               71 ( 55.9) 
  GUER30 (%)                   62 ( 48.8) 
                               65 ( 51.2) 
  GUER90 (%)                   60 ( 47.2) 
                               67 ( 52.8) 
  HEMAT (%)                   100 ( 78.7) 
                               27 ( 21.3) 
  ILEUS (%)                   113 ( 89.0) 
                               14 ( 11.0) 
  INCCOMPBLEED (%)            110 ( 86.6) 
                               17 ( 13.4) 
  INCCOMPINF (%)              109 ( 85.8) 
                               18 ( 14.2) 
  INCCOMPSCAR (%)             126 ( 99.2) 
                                1 (  0.8) 
  NARC (%)                     60 ( 47.2) 
                               67 ( 52.8) 
  NONARC (%)                    2 (  1.6) 
                              125 ( 98.4) 
  PAIN (%)                      6 (  4.8) 
                               20 ( 16.0) 
                               35 ( 28.0) 
                               64 ( 51.2) 
  PROC365 (%)                 121 ( 95.3) 
                                6 (  4.7) 
  STENT (%)                    69 ( 54.3) 
                               58 ( 45.7) 
  UDR7M (%)                    27 ( 21.3) 
                              100 ( 78.7) 
  URCOMPCVUR (%)              110 ( 95.7) 
                                5 (  4.3) 
  URCOMPINJ (%)               123 ( 96.9) 
                                4 (  3.1) 
  URCOMPOBST (%)              126 ( 99.2) 
                                1 (  0.8) 
  URCOMPSTEN (%)              122 ( 96.1) 
                                5 (  3.9) 
  UTIpostop (%)                90 ( 70.9) 
                               37 ( 29.1) 
  SURGIND (%)                   7 (  5.5) 
                                1 (  0.8) 
                               51 ( 40.2) 
                               61 ( 48.0) 
                                0 (  0.0) 
                                0 (  0.0) 
                                5 (  3.9) 
                                0 (  0.0) 
                                2 (  1.6) 
                                0 (  0.0) 
                                0 (  0.0) 
  VURRECG01 (%)               101 ( 79.5) 
                               26 ( 20.5) 
  REC011 (%)                   70 ( 55.1) 
                               11 (  8.7) 
                               46 ( 36.2) 
                          Stratified by TRTn2
                           Lich-Gregoir group p      test
  n                          127                         
  AGS (mean (SD))           7.50 (2.60)        0.677     
  BMI (mean (SD))          15.43 (3.09)        0.197     
  BLDLOSS (mean (SD))      68.38 (54.03)      <0.001     
  CATHPERIOD (mean (SD))    8.69 (14.15)       0.029     
  FUPm (mean (SD))         38.71 (33.58)       0.748     
  HOSPTIME (mean (SD))      3.98 (3.97)        0.001     
  OPRTIME (mean (SD))      75.55 (14.87)      <0.001     
  UTIpostopFup (mean (SD)) 31.61 (36.44)       0.903     
  UTIpostopT (mean (SD))    0.38 (1.15)        0.370     
  PREOPVURGRADE (%)            7 (  5.5)       0.323     
                              46 ( 36.2)                 
                              74 ( 58.3)                 
  HISTOINJ (%)               111 ( 87.4)       1.000     
                              16 ( 12.6)                 
  PREOPRNPLN (%)             107 ( 84.3)       0.156     
                              20 ( 15.7)                 
  PREOPRNSCR (%)              92 ( 72.4)       0.413     
                              35 ( 27.6)                 
  VURSIDE (%)                 48 ( 37.8)       1.000     
                              79 ( 62.2)                 
  VURPHASE (%)                93 ( 73.2)       0.397     
                               3 (  2.4)                 
                              31 ( 24.4)                 
  PREOPEPISODEn (%)            6 (  4.7)       0.565     
                              32 ( 25.2)                 
                              89 ( 70.1)                 
  PREOPTYPEUn (%)              1 (  0.8)       1.000     
                             126 ( 99.2)                 
  SURGTECHn2 (%)              14 ( 11.0)       0.254     
                             104 ( 81.9)                 
                               9 (  7.1)                 
  TRTn2 (%)                    0 (  0.0)      <0.001     
                             127 (100.0)                 
  ANASTOMO (%)               126 ( 99.2)       1.000     
                               1 (  0.8)                 
  BLDCOMPLEAK (%)            125 ( 98.4)       1.000     
                               2 (  1.6)                 
  BLDCOMPRETN (%)            108 ( 85.0)       0.716     
                              19 ( 15.0)                 
  BLDCOMPVOID (%)            122 ( 96.1)       1.000     
                               5 (  3.9)                 
  BLDSPASM (%)                93 ( 73.2)       0.221     
                              34 ( 26.8)                 
  CATH (%)                     3 (  2.4)       1.000     
                             124 ( 97.6)                 
  Center (%)                 101 ( 79.5)       0.051     
                               0 (  0.0)                 
                               6 (  4.7)                 
                              20 ( 15.7)                 
  CLAVIENCLASS (%)            48 ( 47.5)       0.004     
                              37 ( 36.6)                 
                              15 ( 14.9)                 
                               1 (  1.0)                 
                               0 (  0.0)                 
  EPIDURAL (%)               119 ( 93.7)       0.485     
                               8 (  6.3)                 
  GENDER (%)                  72 ( 56.7)       0.801     
                              55 ( 43.3)                 
  GU30 (%)                   120 ( 94.5)      <0.001     
                               7 (  5.5)                 
  GU90 (%)                    92 ( 72.4)      <0.001     
                              35 ( 27.6)                 
  GUER30 (%)                 116 ( 91.3)      <0.001     
                              11 (  8.7)                 
  GUER90 (%)                 111 ( 87.4)      <0.001     
                              16 ( 12.6)                 
  HEMAT (%)                  107 ( 84.3)       0.332     
                              20 ( 15.7)                 
  ILEUS (%)                  123 ( 96.9)       0.028     
                               4 (  3.1)                 
  INCCOMPBLEED (%)           106 ( 83.5)       0.598     
                              21 ( 16.5)                 
  INCCOMPINF (%)             117 ( 92.1)       0.161     
                              10 (  7.9)                 
  INCCOMPSCAR (%)            126 ( 99.2)       1.000     
                               1 (  0.8)                 
  NARC (%)                    70 ( 55.1)       0.259     
                              57 ( 44.9)                 
  NONARC (%)                   0 (  0.0)       0.478     
                             127 (100.0)                 
  PAIN (%)                     7 (  5.5)      <0.001     
                              45 ( 35.4)                 
                              47 ( 37.0)                 
                              28 ( 22.0)                 
  PROC365 (%)                121 ( 95.3)       1.000     
                               6 (  4.7)                 
  STENT (%)                   95 ( 74.8)       0.001     
                              32 ( 25.2)                 
  UDR7M (%)                   40 ( 31.5)       0.088     
                              87 ( 68.5)                 
  URCOMPCVUR (%)             120 ( 99.2)       0.192     
                               1 (  0.8)                 
  URCOMPINJ (%)              126 ( 99.2)       0.366     
                               1 (  0.8)                 
  URCOMPOBST (%)             114 ( 89.8)       0.002     
                              13 ( 10.2)                 
  URCOMPSTEN (%)             119 ( 93.7)       0.569     
                               8 (  6.3)                 
  UTIpostop (%)               92 ( 72.4)       0.889     
                              35 ( 27.6)                 
  SURGIND (%)                  7 (  5.5)         NaN     
                               2 (  1.6)                 
                              54 ( 42.5)                 
                              58 ( 45.7)                 
                               1 (  0.8)                 
                               0 (  0.0)                 
                               4 (  3.1)                 
                               0 (  0.0)                 
                               1 (  0.8)                 
                               0 (  0.0)                 
                               0 (  0.0)                 
  VURRECG01 (%)              114 ( 89.8)       0.037     
                              13 ( 10.2)                 
  REC011 (%)                  80 ( 63.0)       0.443     
                               9 (  7.1)                 
                              38 ( 29.9)                 
> 
> # Convert TableOne to a matrix
> tablem_matrix <- print(tablem, showAllLevels = TRUE, pDigits = 3, quote = FALSE, noSpaces = TRUE)
                          Stratified by TRTn2
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          Stratified by TRTn2
                           Cohen group   
  n                        127           
  AGS (mean (SD))          7.36 (2.98)   
  BMI (mean (SD))          15.97 (3.53)  
  BLDLOSS (mean (SD))      97.14 (72.09) 
  CATHPERIOD (mean (SD))   12.83 (15.84) 
  FUPm (mean (SD))         40.03 (31.81) 
  HOSPTIME (mean (SD))     5.20 (1.13)   
  OPRTIME (mean (SD))      129.91 (43.63)
  UTIpostopFup (mean (SD)) 31.07 (34.54) 
  UTIpostopT (mean (SD))   0.55 (1.84)   
  PREOPVURGRADE (%)        9 (7.1)       
                           35 (27.6)     
                           83 (65.4)     
  HISTOINJ (%)             111 (87.4)    
                           16 (12.6)     
  PREOPRNPLN (%)           97 (76.4)     
                           30 (23.6)     
  PREOPRNSCR (%)           85 (66.9)     
                           42 (33.1)     
  VURSIDE (%)              49 (38.6)     
                           78 (61.4)     
  VURPHASE (%)             88 (69.3)     
                           1 (0.8)       
                           38 (29.9)     
  PREOPEPISODEn (%)        7 (5.5)       
                           39 (30.7)     
                           81 (63.8)     
  PREOPTYPEUn (%)          2 (1.6)       
                           125 (98.4)    
  SURGTECHn2 (%)           13 (10.2)     
                           97 (76.4)     
                           17 (13.4)     
  TRTn2 (%)                127 (100.0)   
                           0 (0.0)       
  ANASTOMO (%)             125 (98.4)    
                           2 (1.6)       
  BLDCOMPLEAK (%)          126 (99.2)    
                           1 (0.8)       
  BLDCOMPRETN (%)          111 (87.4)    
                           16 (12.6)     
  BLDCOMPVOID (%)          121 (95.3)    
                           6 (4.7)       
  BLDSPASM (%)             83 (65.4)     
                           44 (34.6)     
  CATH (%)                 2 (1.6)       
                           125 (98.4)    
  Center (%)               83 (65.4)     
                           2 (1.6)       
                           12 (9.4)      
                           30 (23.6)     
  CLAVIENCLASS (%)         72 (72.0)     
                           17 (17.0)     
                           10 (10.0)     
                           0 (0.0)       
                           1 (1.0)       
  EPIDURAL (%)             115 (90.6)    
                           12 (9.4)      
  GENDER (%)               69 (54.3)     
                           58 (45.7)     
  GU30 (%)                 85 (66.9)     
                           42 (33.1)     
  GU90 (%)                 56 (44.1)     
                           71 (55.9)     
  GUER30 (%)               62 (48.8)     
                           65 (51.2)     
  GUER90 (%)               60 (47.2)     
                           67 (52.8)     
  HEMAT (%)                100 (78.7)    
                           27 (21.3)     
  ILEUS (%)                113 (89.0)    
                           14 (11.0)     
  INCCOMPBLEED (%)         110 (86.6)    
                           17 (13.4)     
  INCCOMPINF (%)           109 (85.8)    
                           18 (14.2)     
  INCCOMPSCAR (%)          126 (99.2)    
                           1 (0.8)       
  NARC (%)                 60 (47.2)     
                           67 (52.8)     
  NONARC (%)               2 (1.6)       
                           125 (98.4)    
  PAIN (%)                 6 (4.8)       
                           20 (16.0)     
                           35 (28.0)     
                           64 (51.2)     
  PROC365 (%)              121 (95.3)    
                           6 (4.7)       
  STENT (%)                69 (54.3)     
                           58 (45.7)     
  UDR7M (%)                27 (21.3)     
                           100 (78.7)    
  URCOMPCVUR (%)           110 (95.7)    
                           5 (4.3)       
  URCOMPINJ (%)            123 (96.9)    
                           4 (3.1)       
  URCOMPOBST (%)           126 (99.2)    
                           1 (0.8)       
  URCOMPSTEN (%)           122 (96.1)    
                           5 (3.9)       
  UTIpostop (%)            90 (70.9)     
                           37 (29.1)     
  SURGIND (%)              7 (5.5)       
                           1 (0.8)       
                           51 (40.2)     
                           61 (48.0)     
                           0 (0.0)       
                           0 (0.0)       
                           5 (3.9)       
                           0 (0.0)       
                           2 (1.6)       
                           0 (0.0)       
                           0 (0.0)       
  VURRECG01 (%)            101 (79.5)    
                           26 (20.5)     
  REC011 (%)               70 (55.1)     
                           11 (8.7)      
                           46 (36.2)     
                          Stratified by TRTn2
                           Lich-Gregoir group p      test
  n                        127                           
  AGS (mean (SD))          7.50 (2.60)        0.677      
  BMI (mean (SD))          15.43 (3.09)       0.197      
  BLDLOSS (mean (SD))      68.38 (54.03)      <0.001     
  CATHPERIOD (mean (SD))   8.69 (14.15)       0.029      
  FUPm (mean (SD))         38.71 (33.58)      0.748      
  HOSPTIME (mean (SD))     3.98 (3.97)        0.001      
  OPRTIME (mean (SD))      75.55 (14.87)      <0.001     
  UTIpostopFup (mean (SD)) 31.61 (36.44)      0.903      
  UTIpostopT (mean (SD))   0.38 (1.15)        0.370      
  PREOPVURGRADE (%)        7 (5.5)            0.323      
                           46 (36.2)                     
                           74 (58.3)                     
  HISTOINJ (%)             111 (87.4)         1.000      
                           16 (12.6)                     
  PREOPRNPLN (%)           107 (84.3)         0.156      
                           20 (15.7)                     
  PREOPRNSCR (%)           92 (72.4)          0.413      
                           35 (27.6)                     
  VURSIDE (%)              48 (37.8)          1.000      
                           79 (62.2)                     
  VURPHASE (%)             93 (73.2)          0.397      
                           3 (2.4)                       
                           31 (24.4)                     
  PREOPEPISODEn (%)        6 (4.7)            0.565      
                           32 (25.2)                     
                           89 (70.1)                     
  PREOPTYPEUn (%)          1 (0.8)            1.000      
                           126 (99.2)                    
  SURGTECHn2 (%)           14 (11.0)          0.254      
                           104 (81.9)                    
                           9 (7.1)                       
  TRTn2 (%)                0 (0.0)            <0.001     
                           127 (100.0)                   
  ANASTOMO (%)             126 (99.2)         1.000      
                           1 (0.8)                       
  BLDCOMPLEAK (%)          125 (98.4)         1.000      
                           2 (1.6)                       
  BLDCOMPRETN (%)          108 (85.0)         0.716      
                           19 (15.0)                     
  BLDCOMPVOID (%)          122 (96.1)         1.000      
                           5 (3.9)                       
  BLDSPASM (%)             93 (73.2)          0.221      
                           34 (26.8)                     
  CATH (%)                 3 (2.4)            1.000      
                           124 (97.6)                    
  Center (%)               101 (79.5)         0.051      
                           0 (0.0)                       
                           6 (4.7)                       
                           20 (15.7)                     
  CLAVIENCLASS (%)         48 (47.5)          0.004      
                           37 (36.6)                     
                           15 (14.9)                     
                           1 (1.0)                       
                           0 (0.0)                       
  EPIDURAL (%)             119 (93.7)         0.485      
                           8 (6.3)                       
  GENDER (%)               72 (56.7)          0.801      
                           55 (43.3)                     
  GU30 (%)                 120 (94.5)         <0.001     
                           7 (5.5)                       
  GU90 (%)                 92 (72.4)          <0.001     
                           35 (27.6)                     
  GUER30 (%)               116 (91.3)         <0.001     
                           11 (8.7)                      
  GUER90 (%)               111 (87.4)         <0.001     
                           16 (12.6)                     
  HEMAT (%)                107 (84.3)         0.332      
                           20 (15.7)                     
  ILEUS (%)                123 (96.9)         0.028      
                           4 (3.1)                       
  INCCOMPBLEED (%)         106 (83.5)         0.598      
                           21 (16.5)                     
  INCCOMPINF (%)           117 (92.1)         0.161      
                           10 (7.9)                      
  INCCOMPSCAR (%)          126 (99.2)         1.000      
                           1 (0.8)                       
  NARC (%)                 70 (55.1)          0.259      
                           57 (44.9)                     
  NONARC (%)               0 (0.0)            0.478      
                           127 (100.0)                   
  PAIN (%)                 7 (5.5)            <0.001     
                           45 (35.4)                     
                           47 (37.0)                     
                           28 (22.0)                     
  PROC365 (%)              121 (95.3)         1.000      
                           6 (4.7)                       
  STENT (%)                95 (74.8)          0.001      
                           32 (25.2)                     
  UDR7M (%)                40 (31.5)          0.088      
                           87 (68.5)                     
  URCOMPCVUR (%)           120 (99.2)         0.192      
                           1 (0.8)                       
  URCOMPINJ (%)            126 (99.2)         0.366      
                           1 (0.8)                       
  URCOMPOBST (%)           114 (89.8)         0.002      
                           13 (10.2)                     
  URCOMPSTEN (%)           119 (93.7)         0.569      
                           8 (6.3)                       
  UTIpostop (%)            92 (72.4)          0.889      
                           35 (27.6)                     
  SURGIND (%)              7 (5.5)            NaN        
                           2 (1.6)                       
                           54 (42.5)                     
                           58 (45.7)                     
                           1 (0.8)                       
                           0 (0.0)                       
                           4 (3.1)                       
                           0 (0.0)                       
                           1 (0.8)                       
                           0 (0.0)                       
                           0 (0.0)                       
  VURRECG01 (%)            114 (89.8)         0.037      
                           13 (10.2)                     
  REC011 (%)               80 (63.0)          0.443      
                           9 (7.1)                       
                           38 (29.9)                     
> 
> # Save the matrix as a CSV file
> write.csv(as.data.frame(tablem_matrix), file = "Tablem_descriptive.csv", row.names = TRUE)
>  
> # Calculate median and IQR manually for numeric variables
> calc_median_iqr <- function(var, group) {
+   mdata %>%
+     group_by(.data[[group]]) %>%
+     summarise(
+       Median = median(.data[[var]], na.rm = TRUE),
+       Q1 = quantile(.data[[var]], 0.25, na.rm = TRUE),
+       Q3 = quantile(.data[[var]], 0.75, na.rm = TRUE)
+     )
+ }
> 
> # Loop through numeric variables and calculate median/IQR for treatment groups
> library(dplyr)
> results_numeric <- lapply(numeric_vars, calc_median_iqr, group = "TRTn2")
> names(results_numeric) <- numeric_vars
> 
> # Combine numeric and categorical results
> results_numeric_combined <- do.call(rbind, lapply(results_numeric, function(x) {
+   x %>% mutate(Statistic = paste0(Median, " (", Q1, "-", Q3, ")")) %>%
+     select(Statistic)
+ }))
> 
> # Export the results
> write.csv(results_numeric_combined, "Numeric_mMedian_IQR.csv")
> # Descriptive statistics for the matched cohort (not stratified by treatment group):
>  
> # Load the required package
> if (!requireNamespace("tableone", quietly = TRUE)) {
+   install.packages("tableone")
+ }
> library(tableone)
> 
> # Specify variables
> numeric_vars <- c("AGS", "BMI", "BLDLOSS", "CATHPERIOD", "FUPm", 
+                   "HOSPTIME", "OPRTIME", "UTIpostopFup", "UTIpostopT")
> 
> factor_vars <- c("PREOPVURGRADE", "HISTOINJ", "PREOPRNPLN", "PREOPRNSCR", "VURSIDE", 
+                  "VURPHASE", "PREOPEPISODEn", "PREOPTYPEUn", "SURGTECHn2", "TRTn2", 
+                  "ANASTOMO", "BLDCOMPLEAK", "BLDCOMPRETN", "BLDCOMPVOID", "BLDSPASM", 
+                  "CATH", "Center", "CLAVIENCLASS", "EPIDURAL", "GENDER", "GU30", 
+                  "GU90", "GUER30", "GUER90", "HEMAT", "ILEUS", "INCCOMPBLEED", 
+                  "INCCOMPINF", "INCCOMPSCAR", "NARC", "NONARC", "PAIN", "PROC365", 
+                  "STENT", "UDR7M", "URCOMPCVUR", "URCOMPINJ", "URCOMPOBST", 
+                  "URCOMPSTEN", "UTIpostop", "SURGIND", "VURRECG01", "REC011")
> 
> all_vars <- c(numeric_vars, factor_vars)
> 
> # Create Table mn for the whole cohort
> tablemn <- CreateTableOne(vars = all_vars, data = mdata, test = FALSE)
> 
> # Print Table mn without p-values (since there are no groups)
> print(tablemn, showAllLevels = TRUE)
                          
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          
                           Overall       
  n                           254        
  AGS (mean (SD))            7.43 (2.80) 
  BMI (mean (SD))           15.70 (3.32) 
  BLDLOSS (mean (SD))       82.70 (65.15)
  CATHPERIOD (mean (SD))    10.76 (15.14)
  FUPm (mean (SD))          39.37 (32.65)
  HOSPTIME (mean (SD))       4.59 (2.97) 
  OPRTIME (mean (SD))      102.73 (42.42)
  UTIpostopFup (mean (SD))  31.34 (35.44)
  UTIpostopT (mean (SD))     0.46 (1.54) 
  PREOPVURGRADE (%)            16 ( 6.3) 
                               81 (31.9) 
                              157 (61.8) 
  HISTOINJ (%)                222 (87.4) 
                               32 (12.6) 
  PREOPRNPLN (%)              204 (80.3) 
                               50 (19.7) 
  PREOPRNSCR (%)              177 (69.7) 
                               77 (30.3) 
  VURSIDE (%)                  97 (38.2) 
                              157 (61.8) 
  VURPHASE (%)                181 (71.3) 
                                4 ( 1.6) 
                               69 (27.2) 
  PREOPEPISODEn (%)            13 ( 5.1) 
                               71 (28.0) 
                              170 (66.9) 
  PREOPTYPEUn (%)               3 ( 1.2) 
                              251 (98.8) 
  SURGTECHn2 (%)               27 (10.6) 
                              201 (79.1) 
                               26 (10.2) 
  TRTn2 (%)                   127 (50.0) 
                              127 (50.0) 
  ANASTOMO (%)                251 (98.8) 
                                3 ( 1.2) 
  BLDCOMPLEAK (%)             251 (98.8) 
                                3 ( 1.2) 
  BLDCOMPRETN (%)             219 (86.2) 
                               35 (13.8) 
  BLDCOMPVOID (%)             243 (95.7) 
                               11 ( 4.3) 
  BLDSPASM (%)                176 (69.3) 
                               78 (30.7) 
  CATH (%)                      5 ( 2.0) 
                              249 (98.0) 
  Center (%)                  184 (72.4) 
                                2 ( 0.8) 
                               18 ( 7.1) 
                               50 (19.7) 
  CLAVIENCLASS (%)            120 (59.7) 
                               54 (26.9) 
                               25 (12.4) 
                                1 ( 0.5) 
                                1 ( 0.5) 
  EPIDURAL (%)                234 (92.1) 
                               20 ( 7.9) 
  GENDER (%)                  141 (55.5) 
                              113 (44.5) 
  GU30 (%)                    205 (80.7) 
                               49 (19.3) 
  GU90 (%)                    148 (58.3) 
                              106 (41.7) 
  GUER30 (%)                  178 (70.1) 
                               76 (29.9) 
  GUER90 (%)                  171 (67.3) 
                               83 (32.7) 
  HEMAT (%)                   207 (81.5) 
                               47 (18.5) 
  ILEUS (%)                   236 (92.9) 
                               18 ( 7.1) 
  INCCOMPBLEED (%)            216 (85.0) 
                               38 (15.0) 
  INCCOMPINF (%)              226 (89.0) 
                               28 (11.0) 
  INCCOMPSCAR (%)             252 (99.2) 
                                2 ( 0.8) 
  NARC (%)                    130 (51.2) 
                              124 (48.8) 
  NONARC (%)                    2 ( 0.8) 
                              252 (99.2) 
  PAIN (%)                     13 ( 5.2) 
                               65 (25.8) 
                               82 (32.5) 
                               92 (36.5) 
  PROC365 (%)                 242 (95.3) 
                               12 ( 4.7) 
  STENT (%)                   164 (64.6) 
                               90 (35.4) 
  UDR7M (%)                    67 (26.4) 
                              187 (73.6) 
  URCOMPCVUR (%)              230 (97.5) 
                                6 ( 2.5) 
  URCOMPINJ (%)               249 (98.0) 
                                5 ( 2.0) 
  URCOMPOBST (%)              240 (94.5) 
                               14 ( 5.5) 
  URCOMPSTEN (%)              241 (94.9) 
                               13 ( 5.1) 
  UTIpostop (%)               182 (71.7) 
                               72 (28.3) 
  SURGIND (%)                  14 ( 5.5) 
                                3 ( 1.2) 
                              105 (41.3) 
                              119 (46.9) 
                                1 ( 0.4) 
                                0 ( 0.0) 
                                9 ( 3.5) 
                                0 ( 0.0) 
                                3 ( 1.2) 
                                0 ( 0.0) 
                                0 ( 0.0) 
  VURRECG01 (%)               215 (84.6) 
                               39 (15.4) 
  REC011 (%)                  150 (59.1) 
                               20 ( 7.9) 
                               84 (33.1) 
> 
> # Convert TableOne to a matrix
> tablemn_matrix <- print(tablemn, showAllLevels = TRUE, quote = FALSE, noSpaces = TRUE)
                          
                           level                                            
  n                                                                         
  AGS (mean (SD))                                                           
  BMI (mean (SD))                                                           
  BLDLOSS (mean (SD))                                                       
  CATHPERIOD (mean (SD))                                                    
  FUPm (mean (SD))                                                          
  HOSPTIME (mean (SD))                                                      
  OPRTIME (mean (SD))                                                       
  UTIpostopFup (mean (SD))                                                  
  UTIpostopT (mean (SD))                                                    
  PREOPVURGRADE (%)        III                                              
                           IV                                               
                           V                                                
  HISTOINJ (%)             No                                               
                           Yes                                              
  PREOPRNPLN (%)           No                                               
                           Yes                                              
  PREOPRNSCR (%)           No scarring                                      
                           Any scarring                                     
  VURSIDE (%)              Left                                             
                           Right                                            
  VURPHASE (%)             At voiding                                       
                           At filling                                       
                           At filling and voiding                           
  PREOPEPISODEn (%)        1                                                
                           2                                                
                           ≥ 3                                              
  PREOPTYPEUn (%)          Afebrile                                         
                           Febrile                                          
  SURGTECHn2 (%)           ≥ 100                                            
                           50 - 100                                         
                           <50                                              
  TRTn2 (%)                Cohen group                                      
                           Lich-Gregoir group                               
  ANASTOMO (%)             No                                               
                           Yes                                              
  BLDCOMPLEAK (%)          No                                               
                           Yes                                              
  BLDCOMPRETN (%)          No                                               
                           Yes                                              
  BLDCOMPVOID (%)          No                                               
                           Yes                                              
  BLDSPASM (%)             No                                               
                           Yes                                              
  CATH (%)                 No                                               
                           Yes                                              
  Center (%)               Al-Zahraa hospital                               
                           Dresden Hospital                                 
                           Hotel Dieu Hospital                              
                           India                                            
  CLAVIENCLASS (%)         Clavien grade 1                                  
                           Clavien grade 2                                  
                           Clavien grade 3                                  
                           Clavien grade 4                                  
                           Clavien grade 5                                  
  EPIDURAL (%)             No                                               
                           Yes                                              
  GENDER (%)               Male                                             
                           Female                                           
  GU30 (%)                 No                                               
                           Yes                                              
  GU90 (%)                 No                                               
                           Yes                                              
  GUER30 (%)               No                                               
                           Yes                                              
  GUER90 (%)               No                                               
                           Yes                                              
  HEMAT (%)                No                                               
                           Yes                                              
  ILEUS (%)                No                                               
                           Yes                                              
  INCCOMPBLEED (%)         No                                               
                           Yes                                              
  INCCOMPINF (%)           No                                               
                           Yes                                              
  INCCOMPSCAR (%)          No                                               
                           Yes                                              
  NARC (%)                 No                                               
                           Yes                                              
  NONARC (%)               No                                               
                           Yes                                              
  PAIN (%)                 No pain                                          
                           Mild pain                                        
                           Moderate pain                                    
                           Severe pain                                      
  PROC365 (%)              No                                               
                           Yes                                              
  STENT (%)                No                                               
                           Yes                                              
  UDR7M (%)                < 7 mm                                           
                           ≥ 7mm                                            
  URCOMPCVUR (%)           No                                               
                           Yes                                              
  URCOMPINJ (%)            No                                               
                           Yes                                              
  URCOMPOBST (%)           No                                               
                           Yes                                              
  URCOMPSTEN (%)           No                                               
                           Yes                                              
  UTIpostop (%)            No UTI                                           
                           UTI                                              
  SURGIND (%)              Poor compliance to medical treatment             
                           Children with ineffective or poorly tolerated CAP
                           Symptomatic high-grade reflux (III-V)            
                           Repeated breakthrough UTI                        
                           Girls with persistent VUR after puberty          
                           VUR recurrence after endoscopic injection        
                           Reflux nephropathy                               
                           Presence of new renal scars on DMSA              
                           Worsening in renal function                      
                           Parental preference                              
                           Persistent reflux >2 years                       
  VURRECG01 (%)            No recurrence                                    
                           Recurrence                                       
  REC011 (%)               No recurrence                                    
                           Recurrence                                       
                           missing                                          
                          
                           Overall       
  n                        254           
  AGS (mean (SD))          7.43 (2.80)   
  BMI (mean (SD))          15.70 (3.32)  
  BLDLOSS (mean (SD))      82.70 (65.15) 
  CATHPERIOD (mean (SD))   10.76 (15.14) 
  FUPm (mean (SD))         39.37 (32.65) 
  HOSPTIME (mean (SD))     4.59 (2.97)   
  OPRTIME (mean (SD))      102.73 (42.42)
  UTIpostopFup (mean (SD)) 31.34 (35.44) 
  UTIpostopT (mean (SD))   0.46 (1.54)   
  PREOPVURGRADE (%)        16 (6.3)      
                           81 (31.9)     
                           157 (61.8)    
  HISTOINJ (%)             222 (87.4)    
                           32 (12.6)     
  PREOPRNPLN (%)           204 (80.3)    
                           50 (19.7)     
  PREOPRNSCR (%)           177 (69.7)    
                           77 (30.3)     
  VURSIDE (%)              97 (38.2)     
                           157 (61.8)    
  VURPHASE (%)             181 (71.3)    
                           4 (1.6)       
                           69 (27.2)     
  PREOPEPISODEn (%)        13 (5.1)      
                           71 (28.0)     
                           170 (66.9)    
  PREOPTYPEUn (%)          3 (1.2)       
                           251 (98.8)    
  SURGTECHn2 (%)           27 (10.6)     
                           201 (79.1)    
                           26 (10.2)     
  TRTn2 (%)                127 (50.0)    
                           127 (50.0)    
  ANASTOMO (%)             251 (98.8)    
                           3 (1.2)       
  BLDCOMPLEAK (%)          251 (98.8)    
                           3 (1.2)       
  BLDCOMPRETN (%)          219 (86.2)    
                           35 (13.8)     
  BLDCOMPVOID (%)          243 (95.7)    
                           11 (4.3)      
  BLDSPASM (%)             176 (69.3)    
                           78 (30.7)     
  CATH (%)                 5 (2.0)       
                           249 (98.0)    
  Center (%)               184 (72.4)    
                           2 (0.8)       
                           18 (7.1)      
                           50 (19.7)     
  CLAVIENCLASS (%)         120 (59.7)    
                           54 (26.9)     
                           25 (12.4)     
                           1 (0.5)       
                           1 (0.5)       
  EPIDURAL (%)             234 (92.1)    
                           20 (7.9)      
  GENDER (%)               141 (55.5)    
                           113 (44.5)    
  GU30 (%)                 205 (80.7)    
                           49 (19.3)     
  GU90 (%)                 148 (58.3)    
                           106 (41.7)    
  GUER30 (%)               178 (70.1)    
                           76 (29.9)     
  GUER90 (%)               171 (67.3)    
                           83 (32.7)     
  HEMAT (%)                207 (81.5)    
                           47 (18.5)     
  ILEUS (%)                236 (92.9)    
                           18 (7.1)      
  INCCOMPBLEED (%)         216 (85.0)    
                           38 (15.0)     
  INCCOMPINF (%)           226 (89.0)    
                           28 (11.0)     
  INCCOMPSCAR (%)          252 (99.2)    
                           2 (0.8)       
  NARC (%)                 130 (51.2)    
                           124 (48.8)    
  NONARC (%)               2 (0.8)       
                           252 (99.2)    
  PAIN (%)                 13 (5.2)      
                           65 (25.8)     
                           82 (32.5)     
                           92 (36.5)     
  PROC365 (%)              242 (95.3)    
                           12 (4.7)      
  STENT (%)                164 (64.6)    
                           90 (35.4)     
  UDR7M (%)                67 (26.4)     
                           187 (73.6)    
  URCOMPCVUR (%)           230 (97.5)    
                           6 (2.5)       
  URCOMPINJ (%)            249 (98.0)    
                           5 (2.0)       
  URCOMPOBST (%)           240 (94.5)    
                           14 (5.5)      
  URCOMPSTEN (%)           241 (94.9)    
                           13 (5.1)      
  UTIpostop (%)            182 (71.7)    
                           72 (28.3)     
  SURGIND (%)              14 (5.5)      
                           3 (1.2)       
                           105 (41.3)    
                           119 (46.9)    
                           1 (0.4)       
                           0 (0.0)       
                           9 (3.5)       
                           0 (0.0)       
                           3 (1.2)       
                           0 (0.0)       
                           0 (0.0)       
  VURRECG01 (%)            215 (84.6)    
                           39 (15.4)     
  REC011 (%)               150 (59.1)    
                           20 (7.9)      
                           84 (33.1)     
> 
> # Save the matrix as a CSV file
> write.csv(as.data.frame(tablemn_matrix), file = "Tablemn_MatchedCohort.csv", row.names = TRUE)
> # Calculate median and IQR for numeric variables
> library(dplyr)
> results_numeric <- lapply(numeric_vars, function(var) {
+   mdata %>%
+     summarise(
+       Median = median(.data[[var]], na.rm = TRUE),
+       Q1 = quantile(.data[[var]], 0.25, na.rm = TRUE),
+       Q3 = quantile(.data[[var]], 0.75, na.rm = TRUE)
+     ) %>%
+     mutate(Statistic = paste0(Median, " (", Q1, "-", Q3, ")")) %>%
+     select(Statistic)
+ })
> 
> # Combine numeric results into a data frame
> results_numeric_combined <- do.call(rbind, results_numeric)
> rownames(results_numeric_combined) <- numeric_vars
> 
> # Save numeric results to CSV
> write.csv(results_numeric_combined, "Numeric_mnMedian_IQR_MatchedCohort.csv", row.names = TRUE)
 
==================================================================================================
==================================================================================================

6. Love plot for balance

> library(cobalt)
> 
> # Generate the balance table with unadjusted values
> bal <- bal.tab(m.out, m.threshold = 0.25, un = TRUE)
> 
> # Exclude the "distance" covariate from the balance table
> bal$Balance <- bal$Balance[!rownames(bal$Balance) %in% "distance", ]
> 
> # Create the Love plot without the "distance" covariate
> love_plot <- love.plot(bal, stat = "mean.diffs", grid = TRUE, stars = "raw", 
+           abs = FALSE, sample.names = c("Before Matching", "After Matching"))
> 
> 

==================================================================================================
==================================================================================================

7. Repeat matching – data without labels

> library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 
> summary(m.out, standardize=TRUE)

Call:
matchit(formula = TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI + AGS + 
    PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE + PREOPEPISODEn + 
    PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, 
    method = "nearest", caliper = caliper_width)

Summary of Balance for All Data:
                                                         Means Treated
distance                                                         0.694
PREOPVURGRADEIII                                                 0.042
PREOPVURGRADEIV                                                  0.344
PREOPVURGRADEV                                                   0.614
HISTOINJNo                                                       0.884
HISTOINJYes                                                      0.116
BMI                                                             14.849
AGS                                                              7.679
PREOPRNPLNNo                                                     0.907
PREOPRNPLNYes                                                    0.093
PREOPRNSCRNo scarring                                            0.795
PREOPRNSCRAny scarring                                           0.205
VURSIDELeft                                                      0.381
VURSIDERight                                                     0.619
VURPHASEAt voiding                                               0.530
VURPHASEAt filling                                               0.316
VURPHASEAt filling and voiding                                   0.153
PREOPEPISODEn1                                                   0.037
PREOPEPISODEn2                                                   0.153
PREOPEPISODEn≥ 3                                                 0.809
PREOPTYPEUnAfebrile                                              0.005
PREOPTYPEUnFebrile                                               0.995
SURGTECHn2≥ 100                                                  0.326
SURGTECHn250 - 100                                               0.633
SURGTECHn2<50                                                    0.042
GENDERMale                                                       0.595
GENDERFemale                                                     0.405
UDR7M< 7 mm                                                      0.302
UDR7M≥ 7mm                                                       0.698
SURGINDPoor compliance to medical treatment                      0.042
SURGINDChildren with ineffective or poorly tolerated CAP         0.009
SURGINDSymptomatic high-grade reflux (III-V)                     0.349
SURGINDRepeated breakthrough UTI                                 0.563
SURGINDGirls with persistent VUR after puberty                   0.005
SURGINDVUR recurrence after endoscopic injection                 0.000
SURGINDReflux nephropathy                                        0.023
SURGINDPresence of new renal scars on DMSA                       0.000
SURGINDWorsening in renal function                               0.009
SURGINDParental preference                                       0.000
SURGINDPersistent reflux >2 years                                0.000
                                                         Means Control
distance                                                         0.332
PREOPVURGRADEIII                                                 0.056
PREOPVURGRADEIV                                                  0.263
PREOPVURGRADEV                                                   0.682
HISTOINJNo                                                       0.904
HISTOINJYes                                                      0.096
BMI                                                             16.986
AGS                                                              6.891
PREOPRNPLNNo                                                     0.657
PREOPRNPLNYes                                                    0.343
PREOPRNSCRNo scarring                                            0.525
PREOPRNSCRAny scarring                                           0.475
VURSIDELeft                                                      0.404
VURSIDERight                                                     0.596
VURPHASEAt voiding                                               0.571
VURPHASEAt filling                                               0.005
VURPHASEAt filling and voiding                                   0.424
PREOPEPISODEn1                                                   0.081
PREOPEPISODEn2                                                   0.343
PREOPEPISODEn≥ 3                                                 0.576
PREOPTYPEUnAfebrile                                              0.035
PREOPTYPEUnFebrile                                               0.965
SURGTECHn2≥ 100                                                  0.076
SURGTECHn250 - 100                                               0.697
SURGTECHn2<50                                                    0.227
GENDERMale                                                       0.545
GENDERFemale                                                     0.455
UDR7M< 7 mm                                                      0.162
UDR7M≥ 7mm                                                       0.838
SURGINDPoor compliance to medical treatment                      0.051
SURGINDChildren with ineffective or poorly tolerated CAP         0.056
SURGINDSymptomatic high-grade reflux (III-V)                     0.293
SURGINDRepeated breakthrough UTI                                 0.475
SURGINDGirls with persistent VUR after puberty                   0.000
SURGINDVUR recurrence after endoscopic injection                 0.005
SURGINDReflux nephropathy                                        0.030
SURGINDPresence of new renal scars on DMSA                       0.020
SURGINDWorsening in renal function                               0.020
SURGINDParental preference                                       0.005
SURGINDPersistent reflux >2 years                                0.045
                                                         Std. Mean Diff.
distance                                                           1.422
PREOPVURGRADEIII                                                  -0.068
PREOPVURGRADEIV                                                    0.172
PREOPVURGRADEV                                                    -0.139
HISTOINJNo                                                        -0.063
HISTOINJYes                                                        0.063
BMI                                                               -0.828
AGS                                                                0.353
PREOPRNPLNNo                                                       0.862
PREOPRNPLNYes                                                     -0.862
PREOPRNSCRNo scarring                                              0.669
PREOPRNSCRAny scarring                                            -0.669
VURSIDELeft                                                       -0.047
VURSIDERight                                                       0.047
VURPHASEAt voiding                                                -0.081
VURPHASEAt filling                                                 0.669
VURPHASEAt filling and voiding                                    -0.751
PREOPEPISODEn1                                                    -0.230
PREOPEPISODEn2                                                    -0.527
PREOPEPISODEn≥ 3                                                   0.594
PREOPTYPEUnAfebrile                                               -0.451
PREOPTYPEUnFebrile                                                 0.451
SURGTECHn2≥ 100                                                    0.533
SURGTECHn250 - 100                                                -0.134
SURGTECHn2<50                                                     -0.926
GENDERMale                                                         0.102
GENDERFemale                                                      -0.102
UDR7M< 7 mm                                                        0.306
UDR7M≥ 7mm                                                        -0.306
SURGINDPoor compliance to medical treatment                       -0.043
SURGINDChildren with ineffective or poorly tolerated CAP          -0.482
SURGINDSymptomatic high-grade reflux (III-V)                       0.117
SURGINDRepeated breakthrough UTI                                   0.177
SURGINDGirls with persistent VUR after puberty                     0.068
SURGINDVUR recurrence after endoscopic injection                  -0.103
SURGINDReflux nephropathy                                         -0.047
SURGINDPresence of new renal scars on DMSA                        -0.207
SURGINDWorsening in renal function                                -0.114
SURGINDParental preference                                        -0.103
SURGINDPersistent reflux >2 years                                 -0.315
                                                         Var. Ratio
distance                                                       1.27
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                            0.43
AGS                                                            0.47
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                     0.348
PREOPVURGRADEIII                                             0.014
PREOPVURGRADEIV                                              0.082
PREOPVURGRADEV                                               0.068
HISTOINJNo                                                   0.020
HISTOINJYes                                                  0.020
BMI                                                          0.180
AGS                                                          0.056
PREOPRNPLNNo                                                 0.250
PREOPRNPLNYes                                                0.250
PREOPRNSCRNo scarring                                        0.270
PREOPRNSCRAny scarring                                       0.270
VURSIDELeft                                                  0.023
VURSIDERight                                                 0.023
VURPHASEAt voiding                                           0.040
VURPHASEAt filling                                           0.311
VURPHASEAt filling and voiding                               0.271
PREOPEPISODEn1                                               0.044
PREOPEPISODEn2                                               0.190
PREOPEPISODEn≥ 3                                             0.234
PREOPTYPEUnAfebrile                                          0.031
PREOPTYPEUnFebrile                                           0.031
SURGTECHn2≥ 100                                              0.250
SURGTECHn250 - 100                                           0.064
SURGTECHn2<50                                                0.185
GENDERMale                                                   0.050
GENDERFemale                                                 0.050
UDR7M< 7 mm                                                  0.141
UDR7M≥ 7mm                                                   0.141
SURGINDPoor compliance to medical treatment                  0.009
SURGINDChildren with ineffective or poorly tolerated CAP     0.046
SURGINDSymptomatic high-grade reflux (III-V)                 0.056
SURGINDRepeated breakthrough UTI                             0.088
SURGINDGirls with persistent VUR after puberty               0.005
SURGINDVUR recurrence after endoscopic injection             0.005
SURGINDReflux nephropathy                                    0.007
SURGINDPresence of new renal scars on DMSA                   0.020
SURGINDWorsening in renal function                           0.011
SURGINDParental preference                                   0.005
SURGINDPersistent reflux >2 years                            0.045
                                                         eCDF Max
distance                                                    0.538
PREOPVURGRADEIII                                            0.014
PREOPVURGRADEIV                                             0.082
PREOPVURGRADEV                                              0.068
HISTOINJNo                                                  0.020
HISTOINJYes                                                 0.020
BMI                                                         0.331
AGS                                                         0.201
PREOPRNPLNNo                                                0.250
PREOPRNPLNYes                                               0.250
PREOPRNSCRNo scarring                                       0.270
PREOPRNSCRAny scarring                                      0.270
VURSIDELeft                                                 0.023
VURSIDERight                                                0.023
VURPHASEAt voiding                                          0.040
VURPHASEAt filling                                          0.311
VURPHASEAt filling and voiding                              0.271
PREOPEPISODEn1                                              0.044
PREOPEPISODEn2                                              0.190
PREOPEPISODEn≥ 3                                            0.234
PREOPTYPEUnAfebrile                                         0.031
PREOPTYPEUnFebrile                                          0.031
SURGTECHn2≥ 100                                             0.250
SURGTECHn250 - 100                                          0.064
SURGTECHn2<50                                               0.185
GENDERMale                                                  0.050
GENDERFemale                                                0.050
UDR7M< 7 mm                                                 0.141
UDR7M≥ 7mm                                                  0.141
SURGINDPoor compliance to medical treatment                 0.009
SURGINDChildren with ineffective or poorly tolerated CAP    0.046
SURGINDSymptomatic high-grade reflux (III-V)                0.056
SURGINDRepeated breakthrough UTI                            0.088
SURGINDGirls with persistent VUR after puberty              0.005
SURGINDVUR recurrence after endoscopic injection            0.005
SURGINDReflux nephropathy                                   0.007
SURGINDPresence of new renal scars on DMSA                  0.020
SURGINDWorsening in renal function                          0.011
SURGINDParental preference                                  0.005
SURGINDPersistent reflux >2 years                           0.045

Summary of Balance for Matched Data:
                                                         Means Treated
distance                                                         0.560
PREOPVURGRADEIII                                                 0.055
PREOPVURGRADEIV                                                  0.362
PREOPVURGRADEV                                                   0.583
HISTOINJNo                                                       0.874
HISTOINJYes                                                      0.126
BMI                                                             15.433
AGS                                                              7.504
PREOPRNPLNNo                                                     0.843
PREOPRNPLNYes                                                    0.157
PREOPRNSCRNo scarring                                            0.724
PREOPRNSCRAny scarring                                           0.276
VURSIDELeft                                                      0.378
VURSIDERight                                                     0.622
VURPHASEAt voiding                                               0.732
VURPHASEAt filling                                               0.024
VURPHASEAt filling and voiding                                   0.244
PREOPEPISODEn1                                                   0.047
PREOPEPISODEn2                                                   0.252
PREOPEPISODEn≥ 3                                                 0.701
PREOPTYPEUnAfebrile                                              0.008
PREOPTYPEUnFebrile                                               0.992
SURGTECHn2≥ 100                                                  0.110
SURGTECHn250 - 100                                               0.819
SURGTECHn2<50                                                    0.071
GENDERMale                                                       0.567
GENDERFemale                                                     0.433
UDR7M< 7 mm                                                      0.315
UDR7M≥ 7mm                                                       0.685
SURGINDPoor compliance to medical treatment                      0.055
SURGINDChildren with ineffective or poorly tolerated CAP         0.016
SURGINDSymptomatic high-grade reflux (III-V)                     0.425
SURGINDRepeated breakthrough UTI                                 0.457
SURGINDGirls with persistent VUR after puberty                   0.008
SURGINDVUR recurrence after endoscopic injection                 0.000
SURGINDReflux nephropathy                                        0.031
SURGINDPresence of new renal scars on DMSA                       0.000
SURGINDWorsening in renal function                               0.008
SURGINDParental preference                                       0.000
SURGINDPersistent reflux >2 years                                0.000
                                                         Means Control
distance                                                         0.458
PREOPVURGRADEIII                                                 0.071
PREOPVURGRADEIV                                                  0.276
PREOPVURGRADEV                                                   0.654
HISTOINJNo                                                       0.874
HISTOINJYes                                                      0.126
BMI                                                             15.971
AGS                                                              7.357
PREOPRNPLNNo                                                     0.764
PREOPRNPLNYes                                                    0.236
PREOPRNSCRNo scarring                                            0.669
PREOPRNSCRAny scarring                                           0.331
VURSIDELeft                                                      0.386
VURSIDERight                                                     0.614
VURPHASEAt voiding                                               0.693
VURPHASEAt filling                                               0.008
VURPHASEAt filling and voiding                                   0.299
PREOPEPISODEn1                                                   0.055
PREOPEPISODEn2                                                   0.307
PREOPEPISODEn≥ 3                                                 0.638
PREOPTYPEUnAfebrile                                              0.016
PREOPTYPEUnFebrile                                               0.984
SURGTECHn2≥ 100                                                  0.102
SURGTECHn250 - 100                                               0.764
SURGTECHn2<50                                                    0.134
GENDERMale                                                       0.543
GENDERFemale                                                     0.457
UDR7M< 7 mm                                                      0.213
UDR7M≥ 7mm                                                       0.787
SURGINDPoor compliance to medical treatment                      0.055
SURGINDChildren with ineffective or poorly tolerated CAP         0.008
SURGINDSymptomatic high-grade reflux (III-V)                     0.402
SURGINDRepeated breakthrough UTI                                 0.480
SURGINDGirls with persistent VUR after puberty                   0.000
SURGINDVUR recurrence after endoscopic injection                 0.000
SURGINDReflux nephropathy                                        0.039
SURGINDPresence of new renal scars on DMSA                       0.000
SURGINDWorsening in renal function                               0.016
SURGINDParental preference                                       0.000
SURGINDPersistent reflux >2 years                                0.000
                                                         Std. Mean Diff.
distance                                                           0.401
PREOPVURGRADEIII                                                  -0.079
PREOPVURGRADEIV                                                    0.182
PREOPVURGRADEV                                                    -0.146
HISTOINJNo                                                         0.000
HISTOINJYes                                                        0.000
BMI                                                               -0.208
AGS                                                                0.066
PREOPRNPLNNo                                                       0.271
PREOPRNPLNYes                                                     -0.271
PREOPRNSCRNo scarring                                              0.137
PREOPRNSCRAny scarring                                            -0.137
VURSIDELeft                                                       -0.016
VURSIDERight                                                       0.016
VURPHASEAt voiding                                                 0.079
VURPHASEAt filling                                                 0.034
VURPHASEAt filling and voiding                                    -0.153
PREOPEPISODEn1                                                    -0.042
PREOPEPISODEn2                                                    -0.153
PREOPEPISODEn≥ 3                                                   0.160
PREOPTYPEUnAfebrile                                               -0.116
PREOPTYPEUnFebrile                                                 0.116
SURGTECHn2≥ 100                                                    0.017
SURGTECHn250 - 100                                                 0.114
SURGTECHn2<50                                                     -0.315
GENDERMale                                                         0.048
GENDERFemale                                                      -0.048
UDR7M< 7 mm                                                        0.223
UDR7M≥ 7mm                                                        -0.223
SURGINDPoor compliance to medical treatment                        0.000
SURGINDChildren with ineffective or poorly tolerated CAP           0.082
SURGINDSymptomatic high-grade reflux (III-V)                       0.050
SURGINDRepeated breakthrough UTI                                  -0.048
SURGINDGirls with persistent VUR after puberty                     0.116
SURGINDVUR recurrence after endoscopic injection                   0.000
SURGINDReflux nephropathy                                         -0.052
SURGINDPresence of new renal scars on DMSA                         0.000
SURGINDWorsening in renal function                                -0.082
SURGINDParental preference                                         0.000
SURGINDPersistent reflux >2 years                                  0.000
                                                         Var. Ratio
distance                                                      1.379
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                           0.766
AGS                                                           0.761
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                     0.110
PREOPVURGRADEIII                                             0.016
PREOPVURGRADEIV                                              0.087
PREOPVURGRADEV                                               0.071
HISTOINJNo                                                   0.000
HISTOINJYes                                                  0.000
BMI                                                          0.062
AGS                                                          0.038
PREOPRNPLNNo                                                 0.079
PREOPRNPLNYes                                                0.079
PREOPRNSCRNo scarring                                        0.055
PREOPRNSCRAny scarring                                       0.055
VURSIDELeft                                                  0.008
VURSIDERight                                                 0.008
VURPHASEAt voiding                                           0.039
VURPHASEAt filling                                           0.016
VURPHASEAt filling and voiding                               0.055
PREOPEPISODEn1                                               0.008
PREOPEPISODEn2                                               0.055
PREOPEPISODEn≥ 3                                             0.063
PREOPTYPEUnAfebrile                                          0.008
PREOPTYPEUnFebrile                                           0.008
SURGTECHn2≥ 100                                              0.008
SURGTECHn250 - 100                                           0.055
SURGTECHn2<50                                                0.063
GENDERMale                                                   0.024
GENDERFemale                                                 0.024
UDR7M< 7 mm                                                  0.102
UDR7M≥ 7mm                                                   0.102
SURGINDPoor compliance to medical treatment                  0.000
SURGINDChildren with ineffective or poorly tolerated CAP     0.008
SURGINDSymptomatic high-grade reflux (III-V)                 0.024
SURGINDRepeated breakthrough UTI                             0.024
SURGINDGirls with persistent VUR after puberty               0.008
SURGINDVUR recurrence after endoscopic injection             0.000
SURGINDReflux nephropathy                                    0.008
SURGINDPresence of new renal scars on DMSA                   0.000
SURGINDWorsening in renal function                           0.008
SURGINDParental preference                                   0.000
SURGINDPersistent reflux >2 years                            0.000
                                                         eCDF Max
distance                                                    0.299
PREOPVURGRADEIII                                            0.016
PREOPVURGRADEIV                                             0.087
PREOPVURGRADEV                                              0.071
HISTOINJNo                                                  0.000
HISTOINJYes                                                 0.000
BMI                                                         0.173
AGS                                                         0.118
PREOPRNPLNNo                                                0.079
PREOPRNPLNYes                                               0.079
PREOPRNSCRNo scarring                                       0.055
PREOPRNSCRAny scarring                                      0.055
VURSIDELeft                                                 0.008
VURSIDERight                                                0.008
VURPHASEAt voiding                                          0.039
VURPHASEAt filling                                          0.016
VURPHASEAt filling and voiding                              0.055
PREOPEPISODEn1                                              0.008
PREOPEPISODEn2                                              0.055
PREOPEPISODEn≥ 3                                            0.063
PREOPTYPEUnAfebrile                                         0.008
PREOPTYPEUnFebrile                                          0.008
SURGTECHn2≥ 100                                             0.008
SURGTECHn250 - 100                                          0.055
SURGTECHn2<50                                               0.063
GENDERMale                                                  0.024
GENDERFemale                                                0.024
UDR7M< 7 mm                                                 0.102
UDR7M≥ 7mm                                                  0.102
SURGINDPoor compliance to medical treatment                 0.000
SURGINDChildren with ineffective or poorly tolerated CAP    0.008
SURGINDSymptomatic high-grade reflux (III-V)                0.024
SURGINDRepeated breakthrough UTI                            0.024
SURGINDGirls with persistent VUR after puberty              0.008
SURGINDVUR recurrence after endoscopic injection            0.000
SURGINDReflux nephropathy                                   0.008
SURGINDPresence of new renal scars on DMSA                  0.000
SURGINDWorsening in renal function                          0.008
SURGINDParental preference                                  0.000
SURGINDPersistent reflux >2 years                           0.000
                                                         Std. Pair Dist.
distance                                                           0.401
PREOPVURGRADEIII                                                   0.629
PREOPVURGRADEIV                                                    0.878
PREOPVURGRADEV                                                     0.922
HISTOINJNo                                                         0.252
HISTOINJYes                                                        0.252
BMI                                                                1.253
AGS                                                                1.293
PREOPRNPLNNo                                                       0.759
PREOPRNPLNYes                                                      0.759
PREOPRNSCRNo scarring                                              1.112
PREOPRNSCRAny scarring                                             1.112
VURSIDELeft                                                        0.729
VURSIDERight                                                       0.729
VURPHASEAt voiding                                                 0.805
VURPHASEAt filling                                                 0.068
VURPHASEAt filling and voiding                                     1.070
PREOPEPISODEn1                                                     0.458
PREOPEPISODEn2                                                     1.201
PREOPEPISODEn≥ 3                                                   1.122
PREOPTYPEUnAfebrile                                                0.347
PREOPTYPEUnFebrile                                                 0.347
SURGTECHn2≥ 100                                                    0.386
SURGTECHn250 - 100                                                 0.637
SURGTECHn2<50                                                      0.629
GENDERMale                                                         0.914
GENDERFemale                                                       0.914
UDR7M< 7 mm                                                        0.840
UDR7M≥ 7mm                                                         0.840
SURGINDPoor compliance to medical treatment                        0.094
SURGINDChildren with ineffective or poorly tolerated CAP           0.246
SURGINDSymptomatic high-grade reflux (III-V)                       0.909
SURGINDRepeated breakthrough UTI                                   1.032
SURGINDGirls with persistent VUR after puberty                     0.116
SURGINDVUR recurrence after endoscopic injection                   0.000
SURGINDReflux nephropathy                                          0.470
SURGINDPresence of new renal scars on DMSA                         0.000
SURGINDWorsening in renal function                                 0.246
SURGINDParental preference                                         0.000
SURGINDPersistent reflux >2 years                                  0.000

Sample Sizes:
          Control Treated
All           198     215
Matched       127     127
Unmatched      71      88
Discarded       0       0

==================================================================================================
==================================================================================================
  
8. Univariable and multivariable analyses

8.1 BLDCOMPRETN
> # Extract the matched dataset from the matchit object
> mdata <- match.data(m.out)
> library(geepack)
> 
> # Convert BLDCOMPRETN to numeric binary (0/1) in the matched dataset
> mdata$BLDCOMPRETN <- ifelse(mdata$BLDCOMPRETN == "Yes", 1, 0)
> table(mdata$BLDCOMPRETN)  # Check distribution of "Yes" and "No"

  0   1 
219  35 
> # Check structure of BLDCOMPRETN
> str(mdata$BLDCOMPRETN)
 num [1:254] 0 1 0 0 1 0 1 1 1 0 ...
> # Check frequency of values
> table(mdata$BLDCOMPRETN)  # Should show counts for 0 and 1

  0   1 
219  35 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : num  0 1 0 0 1 0 1 1 1 0 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 2 1 1 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ BLDCOMPRETN  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPRETN ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)    
(Intercept)               -2.048   0.232 78.1   <2e-16 ***
TRTn2Lich-Gregoir group    0.192   0.215  0.8     0.37    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.09   0.547
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0101  0.0189
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR           CI P_value
1 TRTn2Lich-Gregoir group 1.21 (0.8 - 1.84)   0.372
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPRETN  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPRETN ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -1.4482  0.0467 962.29   <2e-16 ***
STENTYes     -1.0465  0.4832   4.69     0.03 *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.956   0.359
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00628  0.0146
Number of clusters:   8  Maximum cluster size: 167 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1


> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )

> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.35 (0.14 - 0.91)    0.03

> #---------
> gee_model <- geeglm(
+ BLDCOMPRETN  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPRETN ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err   Wald Pr(>|W|)    
(Intercept) -1.51450  0.03290 2119.7  < 2e-16 ***
CATHPERIOD  -0.02867  0.00721   15.8  7.1e-05 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.956   0.136
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha  -0.0052 0.00297
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.97 (0.96 - 0.99)       0
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ BLDCOMPRETN  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPRETN ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -1.87083  0.40541 21.30  3.9e-06 ***
OPRTIME     -0.00093  0.00142  0.43     0.51    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.11   0.589
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0124  0.0181
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR      CI P_value
1   OPRTIME  1 (1 - 1)   0.514
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPRETN  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPRETN ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -2.0192  0.3468 33.89  5.8e-09 ***
HOSPTIME      0.0145  0.0196  0.54     0.46    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.09   0.575
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0108  0.0181
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.01 (0.98 - 1.05)   0.461
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   BLDCOMPRETN ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPRETN ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                         Estimate   Std.err Wald Pr(>|W|)
(Intercept)             -2.051346  0.878844 5.45    0.020
TRTn2Lich-Gregoir group  0.069130  0.583212 0.01    0.906
PS                       0.497728  0.379583 1.72    0.190
STENTYes                -0.732444  0.726561 1.02    0.313
CATHPERIOD              -0.011718  0.015683 0.56    0.455
OPRTIME                  0.000606  0.005153 0.01    0.906
HOSPTIME                 0.046912  0.025579 3.36    0.067
                         
(Intercept)             *
TRTn2Lich-Gregoir group  
PS                       
STENTYes                 
CATHPERIOD               
OPRTIME                  
HOSPTIME                .
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.962   0.179
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00651   0.018
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 1.07 (0.34 - 3.36)   0.906
2                      PS 1.64 (0.78 - 3.46)   0.190
3                STENTYes 0.48    (0.12 - 2)   0.313
4              CATHPERIOD 0.99 (0.96 - 1.02)   0.455
5                 OPRTIME 1.00 (0.99 - 1.01)   0.906
6                HOSPTIME 1.05     (1 - 1.1)   0.067
> 
> #---------
> > library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 
> summary(m.out, standardize=TRUE)

Call:
matchit(formula = TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI + AGS + 
    PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE + PREOPEPISODEn + 
    PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, 
    method = "nearest", caliper = caliper_width)

Summary of Balance for All Data:
                                                         Means Treated
distance                                                         0.694
PREOPVURGRADEIII                                                 0.042
PREOPVURGRADEIV                                                  0.344
PREOPVURGRADEV                                                   0.614
HISTOINJNo                                                       0.884
HISTOINJYes                                                      0.116
BMI                                                             14.849
AGS                                                              7.679
PREOPRNPLNNo                                                     0.907
PREOPRNPLNYes                                                    0.093
PREOPRNSCRNo scarring                                            0.795
PREOPRNSCRAny scarring                                           0.205
VURSIDELeft                                                      0.381
VURSIDERight                                                     0.619
VURPHASEAt voiding                                               0.530
VURPHASEAt filling                                               0.316
VURPHASEAt filling and voiding                                   0.153
PREOPEPISODEn1                                                   0.037
PREOPEPISODEn2                                                   0.153
PREOPEPISODEn≥ 3                                                 0.809
PREOPTYPEUnAfebrile                                              0.005
PREOPTYPEUnFebrile                                               0.995
SURGTECHn2≥ 100                                                  0.326
SURGTECHn250 - 100                                               0.633
SURGTECHn2<50                                                    0.042
GENDERMale                                                       0.595
GENDERFemale                                                     0.405
UD
UDR7M≥ 7mm                                                       0.698
SURGINDPoor compliance to medical treatment                      0.042
SURGINDChildren with ineffective or poorly tolerated CAP         0.009
SURGINDSymptomatic high-grade reflux (III-V)                     0.349
SURGINDRepeated breakthrough UTI                                 0.563
SURGINDGirls with persistent VUR after puberty                   0.005
SURGINDVUR recurrence after endoscopic injection                 0.000
SURGINDReflux nephropathy                                        0.023
SURGINDPresence of new renal scars on DMSA                       0.000
SURGINDWorsening in renal function                               0.009
SURGINDParental preference                                       0.000
SURGINDPersistent reflux >2 years                                0.000
                                                         Means Control
distance                                                         0.332
PREOPVURGRADEIII                                                 0.056
PREOPVURGRADEIV                                                  0.263
PREOPVURGRADEV                                                   0.682
HISTOINJNo                                                       0.904
HISTOINJYes                                                      0.096
BMI                                                             16.986
AGS                                                              6.891
PREOPRNPLNNo                                                     0.657
PREOPRNPLNYes                                                    0.343
PREOPRNSCRNo scarring                                            0.525
PREOPRNSCRAny scarring                                           0.475
VURSIDELeft                                                      0.404
VURSIDERight                                                     0.596
VURPHASEAt voiding                                               0.571
VURPHASEAt filling                                               0.005
VURPHASEAt filling and voiding                                   0.424
PREOPEPISODEn1                                                   0.081
PREOPEPISODEn2                                                   0.343
PREOPEPISODEn≥ 3                                                 0.576
PREOPTYPEUnAfebrile                                              0.035
PREOPTYPEUnFebrile                                               0.965
SURGTECHn2≥ 100                                                  0.076
SURGTECHn250 - 100                                               0.697
SURGTECHn2<50                                                    0.227
GENDERMale                                                       0.545
GENDERFemale                                                     0.455
UDR7M< 7 mm                                                      0.162
UDR7M≥ 7mm                                                       0.838
SURGINDPoor compliance to medical treatment                      0.051
SURGINDChildren with ineffective or poorly tolerated CAP         0.056
SURGINDSymptomatic high-grade reflux (III-V)                     0.293
SURGINDRepeated breakthrough UTI                                 0.475
SURGINDGirls with persistent VUR after puberty                   0.000
SURGINDVUR recurrence after endoscopic injection                 0.005
SURGINDReflux nephropathy                                        0.030
SURGINDPresence of new renal scars on DMSA                       0.020
SURGINDWorsening in renal function                               0.020
SURGINDParental preference                                       0.005
SURGINDPersistent reflux >2 years                                0.045
                                                         Std. Mean Diff.
distance                                                           1.422
PREOPVURGRADEIII                                                  -0.068
PREOPVURGRADEIV                                                    0.172
PREOPVURGRADEV                                                    -0.139
HISTOINJNo                                                        -0.063
HISTOINJYes                                                        0.063
BMI                                                               -0.828
AGS                                                                0.353
PREOPRNPLNNo                                                       0.862
PREOPRNPLNYes                                                     -0.862
PREOPRNSCRNo scarring                                              0.669
PREOPRNSCRAny scarring                                            -0.669
VURSIDELeft                                                       -0.047
VURSIDERight                                                       0.047
VURPHASEAt voiding                                                -0.081
VURPHASEAt filling                                                 0.669
VURPHASEAt filling and voiding                                    -0.751
PREOPEPISODEn1                                                    -0.230
PREOPEPISODEn2                                                    -0.527
PREOPEPISODEn≥ 3                                                   0.594
PREOPTYPEUnAfebrile                                               -0.451
PREOPTYPEUnFebrile                                                 0.451
SURGTECHn2≥ 100                                                    0.533
SURGTECHn250 - 100                                                -0.134
SURGTECHn2<50                                                     -0.926
GENDERMale                                                         0.102
GENDERFemale                                                      -0.102
UDR7M< 7 mm                                                        0.306
UDR7M≥ 7mm                                                        -0.306
SURGINDPoor compliance to medical treatment                       -0.043
SURGINDChildren with ineffective or poorly tolerated CAP          -0.482
SURGINDSymptomatic high-grade reflux (III-V)                       0.117
SURGINDRepeated breakthrough UTI                                   0.177
SURGINDGirls with persistent VUR after puberty                     0.068
SURGINDVUR recurrence after endoscopic injection                  -0.103
SURGINDReflux nephropathy                                         -0.047
SURGINDPresence of new renal scars on DMSA                        -0.207
SURGINDWorsening in renal function                                -0.114
SURGINDParental preference                                        -0.103
SURGINDPersistent reflux >2 years                                 -0.315
                                                         Var. Ratio
distance                                                       1.27
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                            0.43
AGS                                                            0.47
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                     0.348
PREOPVURGRADEIII                                             0.014
PREOPVURGRADEIV                                              0.082
PREOPVURGRADEV                                               0.068
HISTOINJNo                                                   0.020
HISTOINJYes                                                  0.020
BMI                                                          0.180
AGS                                                          0.056
PREOPRNPLNNo                                                 0.250
PREOPRNPLNYes                                                0.250
PREOPRNSCRNo scarring                                        0.270
PREOPRNSCRAny scarring                                       0.270
VURSIDELeft                                                  0.023
VURSIDERight                                                 0.023
VURPHASEAt voiding                                           0.040
VURPHASEAt filling                                           0.311
VURPHASEAt filling and voiding                               0.271
PREOPEPISODEn1                                               0.044
PREOPEPISODEn2                                               0.190
PREOPEPISODEn≥ 3                                             0.234
PREOPTYPEUnAfebrile                                          0.031
PREOPTYPEUnFebrile                                           0.031
SURGTECHn2≥ 100                                              0.250
SURGTECHn250 - 100                                           0.064
SURGTECHn2<50                                                0.185
GENDERMale                                                   0.050
GENDERFemale                                                 0.050
UDR7M< 7 mm                                                  0.141
UDR7M≥ 7mm                                                   0.141
SURGINDPoor compliance to medical treatment                  0.009
SURGINDChildren with ineffective or poorly tolerated CAP     0.046
SURGINDSymptomatic high-grade reflux (III-V)                 0.056
SURGINDRepeated breakthrough UTI                             0.088
SURGINDGirls with persistent VUR after puberty               0.005
SURGINDVUR recurrence after endoscopic injection             0.005
SURGINDReflux nephropathy                                    0.007
SURGINDPresence of new renal scars on DMSA                   0.020
SURGINDWorsening in renal function                           0.011
SURGINDParental preference                                   0.005
SURGINDPersistent reflux >2 years                            0.045
                                                         eCDF Max
distance                                                    0.538
PREOPVURGRADEIII                                            0.014
PREOPVURGRADEIV                                             0.082
PREOPVURGRADEV                                              0.068
HISTOINJNo                                                  0.020
HISTOINJYes                                                 0.020
BMI                                                         0.331
AGS                                                         0.201
PREOPRNPLNNo                                                0.250
PREOPRNPLNYes                                               0.250
PREOPRNSCRNo scarring                                       0.270
PREOPRNSCRAny scarring                                      0.270
VURSIDELeft                                                 0.023
VURSIDERight                                                0.023
VURPHASEAt voiding                                          0.040
VURPHASEAt filling                                          0.311
VURPHASEAt filling and voiding                              0.271
PREOPEPISODEn1                                              0.044
PREOPEPISODEn2                                              0.190
PREOPEPISODEn≥ 3                                            0.234
PREOPTYPEUnAfebrile                                         0.031
PREOPTYPEUnFebrile                                          0.031
SURGTECHn2≥ 100                                             0.250
SURGTECHn250 - 100                                          0.064
SURGTECHn2<50                                               0.185
GENDERMale                                                  0.050
GENDERFemale                                                0.050
UDR7M< 7 mm                                                 0.141
UDR7M≥ 7mm                                                  0.141
SURGINDPoor compliance to medical treatment                 0.009
SURGINDChildren with ineffective or poorly tolerated CAP    0.046
SURGINDSymptomatic high-grade reflux (III-V)                0.056
SURGINDRepeated breakthrough UTI                            0.088
SURGINDGirls with persistent VUR after puberty              0.005
SURGINDVUR recurrence after endoscopic injection            0.005
SURGINDReflux nephropathy                                   0.007
SURGINDPresence of new renal scars on DMSA                  0.020
SURGINDWorsening in renal function                          0.011
SURGINDParental preference                                  0.005
SURGINDPersistent reflux >2 years                           0.045

Summary of Balance for Matched Data:
                                                         Means Treated
distance                                                         0.560
PREOPVURGRADEIII                                                 0.055
PREOPVURGRADEIV                                                  0.362
PREOPVURGRADEV                                                   0.583
HISTOINJNo                                                       0.874
HISTOINJYes                                                      0.126
BMI                                                             15.433
AGS                                                              7.504
PREOPRNPLNNo                                                     0.843
PREOPRNPLNYes                                                    0.157
PREOPRNSCRNo scarring                                            0.724
PREOPRNSCRAny scarring                                           0.276
VURSIDELeft                                                      0.378
VURSIDERight                                                     0.622
VURPHASEAt voiding                                               0.732
VURPHASEAt filling                                               0.024
VURPHASEAt filling and voiding                                   0.244
PREOPEPISODEn1                                                   0.047
PREOPEPISODEn2                                                   0.252
PREOPEPISODEn≥ 3                                                 0.701
PREOPTYPEUnAfebrile                                              0.008
PREOPTYPEUnFebrile                                               0.992
SURGTECHn2≥ 100                                                  0.110
SURGTECHn250 - 100                                               0.819
SURGTECHn2<50                                                    0.071
GENDERMale                                                       0.567
GENDERFemale                                                     0.433
UDR7M< 7 mm                                                      0.315
UDR7M≥ 7mm                                                       0.685
SURGINDPoor compliance to medical treatment                      0.055
SURGINDChildren with ineffective or poorly tolerated CAP         0.016
SURGINDSymptomatic high-grade reflux (III-V)                     0.425
SURGINDRepeated breakthrough UTI                                 0.457
SURGINDGirls with persistent VUR after puberty                   0.008
SURGINDVUR recurrence after endoscopic injection                 0.000
SURGINDReflux nephropathy                                        0.031
SURGINDPresence of new renal scars on DMSA                       0.000
SURGINDWorsening in renal function                               0.008
SURGINDParental preference                                       0.000
SURGINDPersistent reflux >2 years                                0.000
                                                         Means Control
distance                                                         0.458
PREOPVURGRADEIII                                                 0.071
PREOPVURGRADEIV                                                  0.276
PREOPVURGRADEV                                                   0.654
HISTOINJNo                                                       0.874
HISTOINJYes                                                      0.126
BMI                                                             15.971
AGS                                                              7.357
PREOPRNPLNNo                                                     0.764
PREOPRNPLNYes                                                    0.236
PREOPRNSCRNo scarring                                            0.669
PREOPRNSCRAny scarring                                           0.331
VURSIDELeft                                                      0.386
VURSIDERight                                                     0.614
VURPHASEAt voiding                                               0.693
VURPHASEAt filling                                               0.008
VURPHASEAt filling and voiding                                   0.299
PREOPEPISODEn1                                                   0.055
PREOPEPISODEn2                                                   0.307
PREOPEPISODEn≥ 3                                                 0.638
PREOPTYPEUnAfebrile                                              0.016
PREOPTYPEUnFebrile                                               0.984
SURGTECHn2≥ 100                                                  0.102
SURGTECHn250 - 100                                               0.764
SURGTECHn2<50                                                    0.134
GENDERMale                                                       0.543
GENDERFemale                                                     0.457
UDR7M< 7 mm                                                      0.213
UDR7M≥ 7mm                                                       0.787
SURGINDPoor compliance to medical treatment                      0.055
SURGINDChildren with ineffective or poorly tolerated CAP         0.008
SURGINDSymptomatic high-grade reflux (III-V)                     0.402
SURGINDRepeated breakthrough UTI                                 0.480
SURGINDGirls with persistent VUR after puberty                   0.000
SURGINDVUR recurrence after endoscopic injection                 0.000
SURGINDReflux nephropathy                                        0.039
SURGINDPresence of new renal scars on DMSA                       0.000
SURGINDWorsening in renal function                               0.016
SURGINDParental preference                                       0.000
SURGINDPersistent reflux >2 years                                0.000
                                                         Std. Mean Diff.
distance                                                           0.401
PREOPVURGRADEIII                                                  -0.079
PREOPVURGRADEIV                                                    0.182
PREOPVURGRADEV                                                    -0.146
HISTOINJNo                                                         0.000
HISTOINJYes                                                        0.000
BMI                                                               -0.208
AGS                                                                0.066
PREOPRNPLNNo                                                       0.271
PREOPRNPLNYes                                                     -0.271
PREOPRNSCRNo scarring                                              0.137
PREOPRNSCRAny scarring                                            -0.137
VURSIDELeft                                                       -0.016
VURSIDERight                                                       0.016
VURPHASEAt voiding                                                 0.079
VURPHASEAt filling                                                 0.034
VURPHASEAt filling and voiding                                    -0.153
PREOPEPISODEn1                                                    -0.042
PREOPEPISODEn2                                                    -0.153
PREOPEPISODEn≥ 3                                                   0.160
PREOPTYPEUnAfebrile                                               -0.116
PREOPTYPEUnFebrile                                                 0.116
SURGTECHn2≥ 100                                                    0.017
SURGTECHn250 - 100                                                 0.114
SURGTECHn2<50                                                     -0.315
GENDERMale                                                         0.048
GENDERFemale                                                      -0.048
UDR7M< 7 mm                                                        0.223
UDR7M≥ 7mm                                                        -0.223
SURGINDPoor compliance to medical treatment                        0.000
SURGINDChildren with ineffective or poorly tolerated CAP           0.082
SURGINDSymptomatic high-grade reflux (III-V)                       0.050
SURGINDRepeated breakthrough UTI                                  -0.048
SURGINDGirls with persistent VUR after puberty                     0.116
SURGINDVUR recurrence after endoscopic injection                   0.000
SURGINDReflux nephropathy                                         -0.052
SURGINDPresence of new renal scars on DMSA                         0.000
SURGINDWorsening in renal function                                -0.082
SURGINDParental preference                                         0.000
SURGINDPersistent reflux >2 years                                  0.000
                                                         Var. Ratio
distance                                                      1.379
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                           0.766
AGS                                                           0.761
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                     0.110
PREOPVURGRADEIII                                             0.016
PREOPVURGRADEIV                                              0.087
PREOPVURGRADEV                                               0.071
HISTOINJNo                                                   0.000
HISTOINJYes                                                  0.000
BMI                                                          0.062
AGS                                                          0.038
PREOPRNPLNNo                                                 0.079
PREOPRNPLNYes                                                0.079
PREOPRNSCRNo scarring                                        0.055
PREOPRNSCRAny scarring                                       0.055
VURSIDELeft                                                  0.008
VURSIDERight                                                 0.008
VURPHASEAt voiding                                           0.039
VURPHASEAt filling                                           0.016
VURPHASEAt filling and voiding                               0.055
PREOPEPISODEn1                                               0.008
PREOPEPISODEn2                                               0.055
PREOPEPISODEn≥ 3                                             0.063
PREOPTYPEUnAfebrile                                          0.008
PREOPTYPEUnFebrile                                           0.008
SURGTECHn2≥ 100                                              0.008
SURGTECHn250 - 100                                           0.055
SURGTECHn2<50                                                0.063
GENDERMale                                                   0.024
GENDERFemale                                                 0.024
UDR7M< 7 mm                                                  0.102
UDR7M≥ 7mm                                                   0.102
SURGINDPoor compliance to medical treatment                  0.000
SURGINDChildren with ineffective or poorly tolerated CAP     0.008
SURGINDSymptomatic high-grade reflux (III-V)                 0.024
SURGINDRepeated breakthrough UTI                             0.024
SURGINDGirls with persistent VUR after puberty               0.008
SURGINDVUR recurrence after endoscopic injection             0.000
SURGINDReflux nephropathy                                    0.008
SURGINDPresence of new renal scars on DMSA                   0.000
SURGINDWorsening in renal function                           0.008
SURGINDParental preference                                   0.000
SURGINDPersistent reflux >2 years                            0.000
                                                         eCDF Max
distance                                                    0.299
PREOPVURGRADEIII                                            0.016
PREOPVURGRADEIV                                             0.087
PREOPVURGRADEV                                              0.071
HISTOINJNo                                                  0.000
HISTOINJYes                                                 0.000
BMI                                                         0.173
AGS                                                         0.118
PREOPRNPLNNo                                                0.079
PREOPRNPLNYes                                               0.079
PREOPRNSCRNo scarring                                       0.055
PREOPRNSCRAny scarring                                      0.055
VURSIDELeft                                                 0.008
VURSIDERight                                                0.008
VURPHASEAt voiding                                          0.039
VURPHASEAt filling                                          0.016
VURPHASEAt filling and voiding                              0.055
PREOPEPISODEn1                                              0.008
PREOPEPISODEn2                                              0.055
PREOPEPISODEn≥ 3                                            0.063
PREOPTYPEUnAfebrile                                         0.008
PREOPTYPEUnFebrile                                          0.008
SURGTECHn2≥ 100                                             0.008
SURGTECHn250 - 100                                          0.055
SURGTECHn2<50                                               0.063
GENDERMale                                                  0.024
GENDERFemale                                                0.024
UDR7M< 7 mm                                                 0.102
UDR7M≥ 7mm                                                  0.102
SURGINDPoor compliance to medical treatment                 0.000
SURGINDChildren with ineffective or poorly tolerated CAP    0.008
SURGINDSymptomatic high-grade reflux (III-V)                0.024
SURGINDRepeated breakthrough UTI                            0.024
SURGINDGirls with persistent VUR after puberty              0.008
SURGINDVUR recurrence after endoscopic injection            0.000
SURGINDReflux nephropathy                                   0.008
SURGINDPresence of new renal scars on DMSA                  0.000
SURGINDWorsening in renal function                          0.008
SURGINDParental preference                                  0.000
SURGINDPersistent reflux >2 years                           0.000
                                                         Std. Pair Dist.
distance                                                           0.401
PREOPVURGRADEIII                                                   0.629
PREOPVURGRADEIV                                                    0.878
PREOPVURGRADEV                                                     0.922
HISTOINJNo                                                         0.252
HISTOINJYes                                                        0.252
BMI                                                                1.253
AGS                                                                1.293
PREOPRNPLNNo                                                       0.759
PREOPRNPLNYes                                                      0.759
PREOPRNSCRNo scarring                                              1.112
PREOPRNSCRAny scarring                                             1.112
VURSIDELeft                                                        0.729
VURSIDERight                                                       0.729
VURPHASEAt voiding                                                 0.805
VURPHASEAt filling                                                 0.068
VURPHASEAt filling and voiding                                     1.070
PREOPEPISODEn1                                                     0.458
PREOPEPISODEn2                                                     1.201
PREOPEPISODEn≥ 3                                                   1.122
PREOPTYPEUnAfebrile                                                0.347
PREOPTYPEUnFebrile                                                 0.347
SURGTECHn2≥ 100                                                    0.386
SURGTECHn250 - 100                                                 0.637
SURGTECHn2<50                                                      0.629
GENDERMale                                                         0.914
GENDERFemale                                                       0.914
UDR7M< 7 mm                                                        0.840
UDR7M≥ 7mm                                                         0.840
SURGINDPoor compliance to medical treatment                        0.094
SURGINDChildren with ineffective or poorly tolerated CAP           0.246
SURGINDSymptomatic high-grade reflux (III-V)                       0.909
SURGINDRepeated breakthrough UTI                                   1.032
SURGINDGirls with persistent VUR after puberty                     0.116
SURGINDVUR recurrence after endoscopic injection                   0.000
SURGINDReflux nephropathy                                          0.470
SURGINDPresence of new renal scars on DMSA                         0.000
SURGINDWorsening in renal function                                 0.246
SURGINDParental preference                                         0.000
SURGINDPersistent reflux >2 years                                  0.000

Sample Sizes:
          Control Treated
All           198     215
Matched       127     127
Unmatched      71      88
Discarded       0       0

> 
> # Extract the matched dataset from the matchit object
> mdata <- match.data(m.out)
> 
> # Convert BLDCOMPRETN to numeric binary (0/1) in the matched dataset
> mdata$BLDCOMPRETN <- ifelse(mdata$BLDCOMPRETN == "Yes", 1, 0)
> table(mdata$BLDCOMPRETN)  # Check distribution of "Yes" and "No"

  0   1 
219  35 

> # Check structure of BLDCOMPRETN
> str(mdata$BLDCOMPRETN)
 num [1:254] 0 1 0 0 1 0 1 1 1 0 ...
> # Check frequency of values
> table(mdata$BLDCOMPRETN)  # Should show counts for 0 and 1

  0   1 
219  35 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : num  0 1 0 0 1 0 1 1 1 0 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 2 1 1 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   BLDCOMPRETN ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPRETN ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                         Estimate   Std.err Wald Pr(>|W|)
(Intercept)             -2.051346  0.878844 5.45    0.020
TRTn2Lich-Gregoir group  0.069130  0.583212 0.01    0.906
PS                       0.497728  0.379583 1.72    0.190
STENTYes                -0.732444  0.726561 1.02    0.313
CATHPERIOD              -0.011718  0.015683 0.56    0.455
OPRTIME                  0.000606  0.005153 0.01    0.906
HOSPTIME                 0.046912  0.025579 3.36    0.067
                         
(Intercept)             *
TRTn2Lich-Gregoir group  
PS                       
STENTYes                 
CATHPERIOD               
OPRTIME                  
HOSPTIME                .
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.962   0.179
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00651   0.018
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 1.07 (0.34 - 3.36)   0.906
2                      PS 1.64 (0.78 - 3.46)   0.190
3                STENTYes 0.48    (0.12 - 2)   0.313
4              CATHPERIOD 0.99 (0.96 - 1.02)   0.455
5                 OPRTIME 1.00 (0.99 - 1.01)   0.906
6                HOSPTIME 1.05     (1 - 1.1)   0.067
> 
> 
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$BLDCOMPRETN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.633"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.541 - 0.634 - 0.723"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.011"
> save.image("OUT.RData")
> save.image("C:\\Users\\USER\\OneDrive\\Desktop\\.RData")
>
 
8.2 URCOMPOBST
> # %URCOMPOBST
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert URCOMPOBST to numeric binary (0/1) in the matched dataset
> mdata$URCOMPOBST <- ifelse(mdata$URCOMPOBST == "Yes", 1, 0)
> table(mdata$URCOMPOBST)  # Check distribution of "Yes" and "No"

  0   1 
240  14 
> # Check structure of URCOMPOBST
> str(mdata$URCOMPOBST)
 num [1:254] 0 0 0 0 0 0 0 1 0 0 ...
> # Check frequency of values
> table(mdata$URCOMPOBST)  # Should show counts for 0 and 1

  0   1 
240  14 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ URCOMPOBST  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPOBST ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)    
(Intercept)               -4.218   0.122 1192   <2e-16 ***
TRTn2Lich-Gregoir group    2.240   0.190  138   <2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.707   0.355
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00578 0.00139
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1 TRTn2Lich-Gregoir group 9.39 (6.47 - 13.64)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPOBST  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPOBST ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -2.3451  0.0761 950.5   <2e-16 ***
STENTYes     -0.9993  0.5419   3.4    0.065 .  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.856   0.588
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00744  0.0127
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.37 (0.13 - 1.06)   0.065
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPOBST  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPOBST ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err   Wald Pr(>|W|)    
(Intercept) -2.40172  0.06493 1368.3  < 2e-16 ***
CATHPERIOD  -0.02970  0.00734   16.4  5.2e-05 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.863   0.199
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00719 0.00245
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.97 (0.96 - 0.98)       0
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ URCOMPOBST  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPOBST ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err Wald Pr(>|W|)  
(Intercept) -1.30572  0.75145 3.02    0.082 .
OPRTIME     -0.01437  0.00662 4.71    0.030 *
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.807   0.142
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00454   0.013
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR         CI P_value
1   OPRTIME 0.99 (0.97 - 1)    0.03
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPOBST  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPOBST ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -3.1321  0.0603 2695.4  < 2e-16 ***
HOSPTIME      0.1024  0.0140   53.8  2.2e-13 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.853  0.0442
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00532 0.00214
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.11 (1.08 - 1.14)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   URCOMPOBST ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPOBST ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err   Wald Pr(>|W|)
(Intercept)              -6.9204  1.0791  41.13  1.4e-10
TRTn2Lich-Gregoir group   3.6594  0.4707  60.45  7.5e-15
PS                       -0.3858  0.4444   0.75   0.3853
STENTYes                 -0.4425  0.5532   0.64   0.4237
CATHPERIOD               -0.0327  0.0124   7.01   0.0081
OPRTIME                   0.0151  0.0076   3.92   0.0476
HOSPTIME                  0.1298  0.0119 118.34  < 2e-16
                           
(Intercept)             ***
TRTn2Lich-Gregoir group ***
PS                         
STENTYes                   
CATHPERIOD              ** 
OPRTIME                 *  
HOSPTIME                ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.691   0.642
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00805  0.0016
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR              CI P_value
1 TRTn2Lich-Gregoir group 38.84 (15.44 - 97.71)   0.000
2                      PS  0.68   (0.28 - 1.62)   0.385
3                STENTYes  0.64    (0.22 - 1.9)   0.424
4              CATHPERIOD  0.97   (0.94 - 0.99)   0.008
5                 OPRTIME  1.02      (1 - 1.03)   0.048
6                HOSPTIME  1.14   (1.11 - 1.17)   0.000
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$URCOMPOBST
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.821"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.721 - 0.825 - 0.911"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
>  
8.3 ILEUS
> # %ILEUS
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert ILEUS to numeric binary (0/1) in the matched dataset
> mdata$ILEUS <- ifelse(mdata$ILEUS == "Yes", 1, 0)
> table(mdata$ILEUS)  # Check distribution of "Yes" and "No"

  0   1 
236  18 
> # Check structure of ILEUS
> str(mdata$ILEUS)
 num [1:254] 0 0 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$ILEUS)  # Should show counts for 0 and 1

  0   1 
236  18 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ ILEUS  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ILEUS ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)    
(Intercept)               -2.818   0.706 15.9  6.6e-05 ***
TRTn2Lich-Gregoir group   -1.918   0.459 17.4  2.9e-05 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     2.75    23.9
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0622   0.451
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.15 (0.06 - 0.36)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ ILEUS  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ILEUS ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err    Wald Pr(>|W|)    
(Intercept)  -1.8449  0.0569 1049.83   <2e-16 ***
STENTYes     -2.5739  0.9015    8.15   0.0043 ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.846    2.16
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00649  0.0254
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.08 (0.01 - 0.45)   0.004
> 
> #---------
> 
> gee_model <- geeglm(
+ ILEUS  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ILEUS ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -3.2211  0.7154 20.3  6.7e-06 ***
CATHPERIOD   -0.0346  0.0207  2.8    0.094 .  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     2.05    7.32
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0679   0.152
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.97 (0.93 - 1.01)   0.094
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ ILEUS  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ILEUS ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -5.1200  1.0527 23.6  1.2e-06 ***
OPRTIME       0.0185  0.0041 20.4  6.2e-06 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.26    4.06
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0215  0.0247
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.02 (1.01 - 1.03)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ ILEUS  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ILEUS ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -3.6725  0.8870 17.14  3.5e-05 ***
HOSPTIME      0.0123  0.0117  1.12     0.29    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     2.66    12.8
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0841   0.295
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.01 (0.99 - 1.04)    0.29
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   ILEUS ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ILEUS ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err   Wald Pr(>|W|)
(Intercept)              -3.6863  0.3138 137.99  < 2e-16
TRTn2Lich-Gregoir group  -0.7405  0.1401  27.96  1.2e-07
PS                        1.2329  0.2448  25.36  4.7e-07
STENTYes                 -2.0388  0.2308  78.01  < 2e-16
CATHPERIOD               -0.0838  0.0243  11.92  0.00055
OPRTIME                   0.0189  0.0015 159.07  < 2e-16
HOSPTIME                 -0.1626  0.0677   5.77  0.01634
                           
(Intercept)             ***
TRTn2Lich-Gregoir group ***
PS                      ***
STENTYes                ***
CATHPERIOD              ***
OPRTIME                 ***
HOSPTIME                *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.651   0.284
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00777 0.00305
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.48 (0.36 - 0.63)   0.000
2                      PS 3.43 (2.12 - 5.54)   0.000
3                STENTYes 0.13  (0.08 - 0.2)   0.000
4              CATHPERIOD 0.92 (0.88 - 0.96)   0.001
5                 OPRTIME 1.02 (1.02 - 1.02)   0.000
6                HOSPTIME 0.85 (0.74 - 0.97)   0.016
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ILEUS
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.844"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.756 - 0.848 - 0.918"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>
> 
8.4 URCOMPCVUR
> # %URCOMPCVUR
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert URCOMPCVUR to numeric binary (0/1) in the matched dataset
> mdata$URCOMPCVUR <- ifelse(mdata$URCOMPCVUR == "Yes", 1, 0)
> table(mdata$URCOMPCVUR)  # Check distribution of "Yes" and "No"

  0   1 
230   6 
> # Check structure of URCOMPCVUR
> str(mdata$URCOMPCVUR)
 num [1:254] 0 0 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$URCOMPCVUR)  # Should show counts for 0 and 1

  0   1 
230   6 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ URCOMPCVUR  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPCVUR ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)    
(Intercept)               -2.889   0.163  313  < 2e-16 ***
TRTn2Lich-Gregoir group   -1.445   0.259   31  2.6e-08 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.736   0.233
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00514 0.00348
Number of clusters:   7  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.24 (0.14 - 0.39)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPCVUR  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPCVUR ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -3.0649  0.0999 941.45   <2e-16 ***
STENTYes     -1.1936  0.9852   1.47     0.23    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.789    1.78
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00662  0.0242
Number of clusters:   7  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate  OR            CI P_value
1  STENTYes 0.3 (0.04 - 2.09)   0.226
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPCVUR  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPCVUR ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -2.9643  0.1192 618.75   <2e-16 ***
CATHPERIOD   -0.0777  0.0272   8.16   0.0043 ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      0.7   0.319
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00739 0.00131
Number of clusters:   7  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.93 (0.88 - 0.98)   0.004
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ URCOMPCVUR  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPCVUR ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -4.36234  0.49098 78.94   <2e-16 ***
OPRTIME      0.00872  0.00372  5.49    0.019 *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.739  0.0578
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00554 0.00683
Number of clusters:   7  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR         CI P_value
1   OPRTIME 1.01 (1 - 1.02)   0.019
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPCVUR  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPCVUR ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -3.3014  0.1308 636.64   <2e-16 ***
HOSPTIME     -0.0142  0.0375   0.14      0.7    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.771   0.111
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00504 0.00448
Number of clusters:   7  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 0.99 (0.92 - 1.06)   0.705
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   URCOMPCVUR ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPCVUR ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err    Wald Pr(>|W|)
(Intercept)             -0.62484  0.31518    3.93  0.04743
TRTn2Lich-Gregoir group -3.35491  0.09439 1263.31  < 2e-16
PS                       1.76460  0.28969   37.11  1.1e-09
STENTYes                -0.03611  0.04973    0.53  0.46777
CATHPERIOD              -0.10327  0.02895   12.72  0.00036
OPRTIME                 -0.00985  0.00419    5.51  0.01889
HOSPTIME                -0.22091  0.07255    9.27  0.00233
                           
(Intercept)             *  
TRTn2Lich-Gregoir group ***
PS                      ***
STENTYes                   
CATHPERIOD              ***
OPRTIME                 *  
HOSPTIME                ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.631   0.268
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00773 0.00137
Number of clusters:   7  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.03 (0.03 - 0.04)   0.000
2                      PS 5.84 (3.31 - 10.3)   0.000
3                STENTYes 0.96 (0.87 - 1.06)   0.468
4              CATHPERIOD 0.90 (0.85 - 0.95)   0.000
5                 OPRTIME 0.99    (0.98 - 1)   0.019
6                HOSPTIME 0.80  (0.7 - 0.92)   0.002
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
>  
> # Ensure predicted probabilities are numeric, and force predict() to use mdata explicitly:
> predicted_probs <- as.numeric(predict(gee_model, newdata=mdata, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$URCOMPCVUR
>  
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
>  
> # Extract AUC
>  auc_value <- auc(roc_curve)
>  
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
>  
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
>  boot_results <- replicate(2000, {
+    shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+    roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+    auc(roc_shuffled)
+  })
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
>  
> # Print the results
>  print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.81"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.664 - 0.811 - 0.939"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.013"
>  
>  
> 
8.5 URCOMPINJ
> # %URCOMPINJ
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert URCOMPINJ to numeric binary (0/1) in the matched dataset
> mdata$URCOMPINJ <- ifelse(mdata$URCOMPINJ == "Yes", 1, 0)
> table(mdata$URCOMPINJ)  # Check distribution of "Yes" and "No"

  0   1 
249   5 
> # Check structure of URCOMPINJ
> str(mdata$URCOMPINJ)
 num [1:254] 0 0 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$URCOMPINJ)  # Should show counts for 0 and 1

  0   1 
249   5 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ URCOMPINJ  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPINJ ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err  Wald Pr(>|W|)
(Intercept)               -3.152   0.167 356.7  < 2e-16
TRTn2Lich-Gregoir group   -1.115   0.282  15.6  7.8e-05
                           
(Intercept)             ***
TRTn2Lich-Gregoir group ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.676   0.206
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00544 0.00365
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.33 (0.19 - 0.57)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPINJ  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPINJ ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)   -5.998   0.554 117.0  < 2e-16 ***
STENTYes       2.949   0.429  47.2  6.3e-12 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.93    18.3
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha  0.00607  0.0371
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR             CI P_value
1  STENTYes 19.1 (8.23 - 44.25)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPINJ  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPINJ ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -3.1972  0.1518 443.33   <2e-16 ***
CATHPERIOD   -0.0440  0.0335   1.72     0.19    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.678    0.27
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00695  0.0108
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR           CI P_value
1 CATHPERIOD 0.96 (0.9 - 1.02)    0.19
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ URCOMPINJ  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPINJ ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -4.67708  0.53598 76.15   <2e-16 ***
OPRTIME      0.01015  0.00437  5.39     0.02 *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.689   0.176
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00608 0.00954
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR         CI P_value
1   OPRTIME 1.01 (1 - 1.02)    0.02
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPINJ  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPINJ ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -4.8617  0.0620 6155   <2e-16 ***
HOSPTIME      0.2123  0.0103  429   <2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.603   0.128
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha  -0.0058 0.00266
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.24 (1.21 - 1.26)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   URCOMPINJ ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
Warning message:
glm.fit: fitted probabilities numerically 0 or 1 occurred 
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPINJ ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                         Estimate   Std.err     Wald
(Intercept)             -4.26e+15  2.03e+14 4.39e+02
TRTn2Lich-Gregoir group -1.59e+15  1.20e+14 1.75e+02
PS                       1.90e+14  2.56e+13 5.53e+01
STENTYes                 3.80e+15  7.21e+13 2.78e+03
CATHPERIOD              -1.15e+14  3.05e+12 1.44e+03
OPRTIME                 -4.57e+12  9.71e+11 2.21e+01
HOSPTIME                 2.56e+14  4.15e+10 3.81e+07
                        Pr(>|W|)    
(Intercept)              < 2e-16 ***
TRTn2Lich-Gregoir group  < 2e-16 ***
PS                       1.0e-13 ***
STENTYes                 < 2e-16 ***
CATHPERIOD               < 2e-16 ***
OPRTIME                  2.5e-06 ***
HOSPTIME                 < 2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate  Std.err
(Intercept) 3.55e+13 2.74e+35
  Link = identity 

Estimated Correlation Parameters:
      Estimate  Std.err
alpha  0.00853 6.58e+19
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate  OR          CI P_value
1 TRTn2Lich-Gregoir group   0     (0 - 0)       0
2                      PS Inf (Inf - Inf)       0
3                STENTYes Inf (Inf - Inf)       0
4              CATHPERIOD   0     (0 - 0)       0
5                 OPRTIME   0     (0 - 0)       0
6                HOSPTIME Inf (Inf - Inf)       0
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$URCOMPINJ
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.8"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.6 - 0.8 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
8.6 INCCOMPINF
> # %INCCOMPINF
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert INCCOMPINF to numeric binary (0/1) in the matched dataset
> mdata$INCCOMPINF <- ifelse(mdata$INCCOMPINF == "Yes", 1, 0)
> table(mdata$INCCOMPINF)  # Check distribution of "Yes" and "No"

  0   1 
226  28 
> # Check structure of INCCOMPINF
> str(mdata$INCCOMPINF)
 num [1:254] 0 0 0 0 1 0 0 1 0 0 ...
> # Check frequency of values
> table(mdata$INCCOMPINF)  # Should show counts for 0 and 1

  0   1 
226  28 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ INCCOMPINF  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPINF ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err  Wald Pr(>|W|)
(Intercept)               -2.194   0.438 25.04  5.6e-07
TRTn2Lich-Gregoir group   -0.805   0.292  7.61   0.0058
                           
(Intercept)             ***
TRTn2Lich-Gregoir group ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      1.5    2.76
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0476  0.0247
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.45 (0.25 - 0.79)   0.006
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPINF  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPINF ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -1.5751  0.0323 2378.0  < 2e-16 ***
STENTYes     -1.4243  0.3544   16.2  5.8e-05 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.904   0.313
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00624 0.00678
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.24 (0.12 - 0.48)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPINF  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPINF ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -2.48200  0.55616 19.92  8.1e-06 ***
CATHPERIOD  -0.00715  0.01452  0.24     0.62    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.46    2.24
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0442  0.0046
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.99 (0.97 - 1.02)   0.623
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ INCCOMPINF  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPINF ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err Wald Pr(>|W|)    
(Intercept) -3.37719  0.59565 32.1  1.4e-08 ***
OPRTIME      0.00886  0.00187 22.6  2.0e-06 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.26    1.46
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0265  0.0089
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.01 (1.01 - 1.01)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPINF  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPINF ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -2.8133  0.5236 28.9  7.7e-08 ***
HOSPTIME      0.0596  0.0103 33.6  6.7e-09 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.43    2.11
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0453 0.00519
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.06 (1.04 - 1.08)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   INCCOMPINF ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPINF ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -3.08155  0.49749 38.37  5.9e-10
TRTn2Lich-Gregoir group -0.49650  0.36968  1.80   0.1793
PS                       1.09469  0.35677  9.41   0.0022
STENTYes                -1.64037  0.42246 15.08   0.0001
CATHPERIOD               0.00903  0.01162  0.60   0.4369
OPRTIME                  0.00587  0.00305  3.70   0.0545
HOSPTIME                 0.08514  0.01105 59.32  1.3e-14
                           
(Intercept)             ***
TRTn2Lich-Gregoir group    
PS                      ** 
STENTYes                ***
CATHPERIOD                 
OPRTIME                 .  
HOSPTIME                ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.867   0.129
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00692 0.00518
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.61 (0.29 - 1.26)   0.179
2                      PS 2.99 (1.49 - 6.01)   0.002
3                STENTYes 0.19 (0.08 - 0.44)   0.000
4              CATHPERIOD 1.01 (0.99 - 1.03)   0.437
5                 OPRTIME 1.01    (1 - 1.01)   0.055
6                HOSPTIME 1.09 (1.07 - 1.11)   0.000
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPINF
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.714"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.622 - 0.718 - 0.802"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
8.7 INCCOMPBLEED
> # %INCCOMPBLEED
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert INCCOMPBLEED to numeric binary (0/1) in the matched dataset
> mdata$INCCOMPBLEED <- ifelse(mdata$INCCOMPBLEED == "Yes", 1, 0)
> table(mdata$INCCOMPBLEED)  # Check distribution of "Yes" and "No"

  0   1 
216  38 
> # Check structure of INCCOMPBLEED
> str(mdata$INCCOMPBLEED)
 num [1:254] 1 1 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$INCCOMPBLEED)  # Should show counts for 0 and 1

  0   1 
216  38 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ INCCOMPBLEED  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPBLEED ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err  Wald Pr(>|W|)
(Intercept)               -2.499   0.671 13.86   0.0002
TRTn2Lich-Gregoir group    0.228   0.145  2.49   0.1149
                           
(Intercept)             ***
TRTn2Lich-Gregoir group    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.69    3.16
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.118  0.0737
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 1.26 (0.95 - 1.67)   0.115
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPBLEED  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPBLEED ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)   -2.128   0.514 17.16  3.4e-05 ***
STENTYes      -0.766   0.565  1.84     0.17    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.49    2.21
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0947  0.0289
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.46 (0.15 - 1.41)   0.175
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPBLEED  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPBLEED ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -1.4538  0.4978  8.53   0.0035 ** 
CATHPERIOD   -0.1430  0.0288 24.72  6.6e-07 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.11    1.29
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0526    0.04
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.87 (0.82 - 0.92)       0
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ INCCOMPBLEED  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPBLEED ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -1.99061  0.59026 11.37  0.00075 ***
OPRTIME     -0.00426  0.00153  7.72  0.00547 ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.82    3.84
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.128   0.112
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR         CI P_value
1   OPRTIME  1 (0.99 - 1)   0.005
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPBLEED  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPBLEED ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)   
(Intercept)  -1.3974  0.4933 8.03   0.0046 **
HOSPTIME     -0.2234  0.0853 6.85   0.0088 **
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.61    3.07
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.113  0.0667
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate  OR            CI P_value
1  HOSPTIME 0.8 (0.68 - 0.95)   0.009
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   INCCOMPBLEED ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPBLEED ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                         Estimate   Std.err  Wald Pr(>|W|)
(Intercept)             -0.393091  0.699449  0.32  0.57411
TRTn2Lich-Gregoir group -0.244201  0.207020  1.39  0.23816
PS                      -0.721952  0.462628  2.44  0.11863
STENTYes                -0.577942  0.517322  1.25  0.26392
CATHPERIOD              -0.078922  0.022128 12.72  0.00036
OPRTIME                  0.000131  0.003218  0.00  0.96747
HOSPTIME                -0.159487  0.065559  5.92  0.01499
                           
(Intercept)                
TRTn2Lich-Gregoir group    
PS                         
STENTYes                   
CATHPERIOD              ***
OPRTIME                    
HOSPTIME                *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.08    1.06
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0485  0.0394
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.78 (0.52 - 1.18)   0.238
2                      PS 0.49   (0.2 - 1.2)   0.119
3                STENTYes 0.56  (0.2 - 1.55)   0.264
4              CATHPERIOD 0.92 (0.88 - 0.97)   0.000
5                 OPRTIME 1.00 (0.99 - 1.01)   0.967
6                HOSPTIME 0.85 (0.75 - 0.97)   0.015
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPBLEED
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })

> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.677"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.602 - 0.677 - 0.749"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
8.8 GU30
> # %GU30
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert GU30 to numeric binary (0/1) in the matched dataset
> mdata$GU30 <- ifelse(mdata$GU30 == "Yes", 1, 0)
> table(mdata$GU30)  # Check distribution of "Yes" and "No"

  0   1 
205  49 
> # Check structure of GU30
> str(mdata$GU30)
 num [1:254] 0 0 0 0 0 1 0 1 0 0 ...
> # Check frequency of values
> table(mdata$GU30)  # Should show counts for 0 and 1

  0   1 
205  49 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ GU30  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU30 ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)   
(Intercept)               -1.011   0.614 2.71    0.100 . 
TRTn2Lich-Gregoir group   -2.775   0.899 9.53    0.002 **
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      1.8    9.54
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0764   0.308
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.06 (0.01 - 0.36)   0.002
> 
> #---------
> 
> gee_model <- geeglm(
+ GU30  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU30 ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)   -2.249   0.455 24.41  7.8e-07 ***
STENTYes      -0.187   0.211  0.79     0.37    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.96    2.44
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.182  0.0864
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.83 (0.55 - 1.25)   0.374
> 
> #---------
> 
> gee_model <- geeglm(
+ GU30  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU30 ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -2.5947  0.5311 23.9    1e-06 ***
CATHPERIOD    0.0225  0.0205  1.2     0.27    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     2.42    4.02
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.219   0.194
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 1.02 (0.98 - 1.06)   0.272
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ GU30  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU30 ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err Wald Pr(>|W|)    
(Intercept) -4.10777  0.76116 29.1  6.8e-08 ***
OPRTIME      0.02280  0.00279 67.0  2.2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.976    0.74
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0146  0.0445
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.02 (1.02 - 1.03)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ GU30  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU30 ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -2.3928  0.6174 15.0  0.00011 ***
HOSPTIME      0.0560  0.0101 30.8  2.9e-08 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.69    2.33
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.157   0.049
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.06 (1.04 - 1.08)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   GU30 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU30 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -1.32618  1.23790  1.15   0.2840
TRTn2Lich-Gregoir group -1.96057  0.45699 18.41  1.8e-05
PS                       0.13607  0.98091  0.02   0.8897
STENTYes                -1.31128  0.47895  7.50   0.0062
CATHPERIOD              -0.04679  0.03433  1.86   0.1729
OPRTIME                  0.00866  0.00488  3.15   0.0758
HOSPTIME                 0.04581  0.03002  2.33   0.1270
                           
(Intercept)                
TRTn2Lich-Gregoir group ***
PS                         
STENTYes                ** 
CATHPERIOD                 
OPRTIME                 .  
HOSPTIME                   
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.897    0.85
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00488  0.0302
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.14 (0.06 - 0.34)   0.000
2                      PS 1.15 (0.17 - 7.84)   0.890
3                STENTYes 0.27 (0.11 - 0.69)   0.006
4              CATHPERIOD 0.95 (0.89 - 1.02)   0.173
5                 OPRTIME 1.01    (1 - 1.02)   0.076
6                HOSPTIME 1.05 (0.99 - 1.11)   0.127
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$GU30
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })

> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.829"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.766 - 0.829 - 0.882"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
8.9 GU90
> # %GU90
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert GU90 to numeric binary (0/1) in the matched dataset
> mdata$GU90 <- ifelse(mdata$GU90 == "Yes", 1, 0)
> table(mdata$GU90)  # Check distribution of "Yes" and "No"

  0   1 
148 106 
> # Check structure of GU90
> str(mdata$GU90)
 num [1:254] 0 1 1 0 1 1 0 1 0 0 ...
> # Check frequency of values
> table(mdata$GU90)  # Should show counts for 0 and 1

  0   1 
148 106 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ GU90  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU90 ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)   
(Intercept)                0.249   0.607 0.17   0.6811   
TRTn2Lich-Gregoir group   -1.068   0.370 8.32   0.0039 **
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.973   0.112
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.131   0.181
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.34 (0.17 - 0.71)   0.004
> 
> #---------
> 
> gee_model <- geeglm(
+ GU90  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU90 ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)
(Intercept)   -0.553   0.489 1.28     0.26
STENTYes       0.563   0.651 0.75     0.39

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.954   0.198
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0768   0.103
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 1.76 (0.49 - 6.29)   0.387
> 
> #---------
> 
> gee_model <- geeglm(
+ GU90  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU90 ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -2.1089  0.6024 12.3  0.00046 ***
CATHPERIOD    0.2417  0.0244 98.3  < 2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.918   0.581
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0428  0.0939
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 1.27 (1.21 - 1.34)       0
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ GU90  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU90 ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
             Estimate   Std.err   Wald Pr(>|W|)    
(Intercept) -1.163005  0.544805   4.56    0.033 *  
OPRTIME      0.012707  0.000727 305.39   <2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.09   0.662
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.267  0.0933
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.01 (1.01 - 1.01)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ GU90  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU90 ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
             Estimate   Std.err Wald Pr(>|W|)
(Intercept)  1.43e+15  1.50e+15 0.91     0.34
HOSPTIME    -6.14e+13  1.35e+14 0.21     0.65

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate  Std.err
(Intercept) 2.61e+15 2.14e+38
  Link = identity 

Estimated Correlation Parameters:
      Estimate  Std.err
alpha    0.746 6.11e+22
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR        CI P_value
1  HOSPTIME  0 (0 - Inf)   0.648
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   GU90 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GU90 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -1.71214  1.07856  2.52   0.1124
TRTn2Lich-Gregoir group -0.88318  0.39842  4.91   0.0266
PS                      -0.31120  0.42455  0.54   0.4636
STENTYes                -1.52602  0.55880  7.46   0.0063
CATHPERIOD               0.23804  0.03013 62.42  2.8e-15
OPRTIME                  0.00840  0.00525  2.56   0.1093
HOSPTIME                -0.03306  0.02323  2.03   0.1546
                           
(Intercept)                
TRTn2Lich-Gregoir group *  
PS                         
STENTYes                ** 
CATHPERIOD              ***
OPRTIME                    
HOSPTIME                   
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.771   0.168
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00639   0.034
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.41  (0.19 - 0.9)   0.027
2                      PS 0.73 (0.32 - 1.68)   0.464
3                STENTYes 0.22 (0.07 - 0.65)   0.006
4              CATHPERIOD 1.27  (1.2 - 1.35)   0.000
5                 OPRTIME 1.01    (1 - 1.02)   0.109
6                HOSPTIME 0.97 (0.92 - 1.01)   0.155
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$GU90
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.865"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.819 - 0.867 - 0.909"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
8.10 GUER30

> # %GUER30
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert GUER30 to numeric binary (0/1) in the matched dataset
> mdata$GUER30 <- ifelse(mdata$GUER30 == "Yes", 1, 0)
> table(mdata$GUER30)  # Check distribution of "Yes" and "No"

  0   1 
178  76 
> # Check structure of GUER30
> str(mdata$GUER30)
 num [1:254] 0 0 0 0 0 1 0 1 0 0 ...
> # Check frequency of values
> table(mdata$GUER30)  # Should show counts for 0 and 1

  0   1 
178  76 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 2 1 1 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ GUER30  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER30 ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)  
(Intercept)               -0.696   0.483 2.08    0.149  
TRTn2Lich-Gregoir group   -3.742   1.968 3.62    0.057 .
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     4.31    80.5
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.186    3.15
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR         CI P_value
1 TRTn2Lich-Gregoir group 0.02 (0 - 1.12)   0.057
> 
> #---------
> 
> gee_model <- geeglm(
+ GUER30  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER30 ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)
(Intercept)    -2.62    1.98 1.76     0.18
STENTYes        1.25    2.30 0.30     0.59

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     3.69    25.1
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.436       2
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate  OR              CI P_value
1  STENTYes 3.5 (0.04 - 318.23)   0.586
> 
> #---------
> 
> gee_model <- geeglm(
+ GUER30  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER30 ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -2.4124  0.6831 12.47  0.00041 ***
CATHPERIOD    0.0450  0.0377  1.42  0.23325    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     2.86     5.4
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha     0.42   0.436
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 1.05 (0.97 - 1.13)   0.233
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ GUER30  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER30 ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)    
(Intercept)  -4.2300  0.8875 22.7  1.9e-06 ***
OPRTIME       0.0309  0.0040 59.5  1.2e-14 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.54     2.9
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha  0.00346  0.0435
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.03 (1.02 - 1.04)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ GUER30  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER30 ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -1.7784  0.9859  3.25    0.071 .  
HOSPTIME      0.1469  0.0358 16.85    4e-05 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      1.3    2.04
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0968   0.269
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.16 (1.08 - 1.24)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   GUER30 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER30 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -1.19222  1.21708  0.96  0.32729
TRTn2Lich-Gregoir group -3.56391  1.15482  9.52  0.00203
PS                       0.22428  0.98316  0.05  0.81955
STENTYes                -0.69828  0.34243  4.16  0.04143
CATHPERIOD              -0.01935  0.01895  1.04  0.30711
OPRTIME                  0.00103  0.00465  0.05  0.82520
HOSPTIME                 0.08241  0.02161 14.54  0.00014
                           
(Intercept)                
TRTn2Lich-Gregoir group ** 
PS                         
STENTYes                *  
CATHPERIOD                 
OPRTIME                    
HOSPTIME                ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     4.12    49.5
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.185    1.99
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.03    (0 - 0.27)   0.002
2                      PS 1.25  (0.18 - 8.6)   0.820
3                STENTYes 0.50 (0.25 - 0.97)   0.041
4              CATHPERIOD 0.98 (0.95 - 1.02)   0.307
5                 OPRTIME 1.00 (0.99 - 1.01)   0.825
6                HOSPTIME 1.09 (1.04 - 1.13)   0.000
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$GUER30
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.865"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.807 - 0.865 - 0.913"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
8.11 GUER90
> # %GUER90
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert GUER90 to numeric binary (0/1) in the matched dataset
> mdata$GUER90 <- ifelse(mdata$GUER90 == "Yes", 1, 0)
> table(mdata$GUER90)  # Check distribution of "Yes" and "No"

  0   1 
171  83 
> # Check structure of GUER90
> str(mdata$GUER90)
 num [1:254] 1 0 1 0 0 1 0 1 0 0 ...
> # Check frequency of values
> table(mdata$GUER90)  # Should show counts for 0 and 1

  0   1 
171  83 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : num  1 0 1 0 0 1 0 1 0 0 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ GUER90  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER90 ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)  
(Intercept)               -0.769   0.411 3.50    0.061 .
TRTn2Lich-Gregoir group   -3.278   2.029 2.61    0.106  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     4.29    63.4
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.263    3.44
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR         CI P_value
1 TRTn2Lich-Gregoir group 0.04 (0 - 2.01)   0.106
> 
> #---------
> 
> gee_model <- geeglm(
+ GUER90  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER90 ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)
(Intercept)    -2.50    2.12 1.39     0.24
STENTYes        1.25    2.63 0.23     0.63

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     3.63    25.2
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.486    2.22
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR              CI P_value
1  STENTYes 3.48 (0.02 - 601.37)   0.635
> 
> #---------
> 
> gee_model <- geeglm(
+ GUER90  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER90 ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)   
(Intercept)  -2.3366  0.7131 10.74   0.0011 **
CATHPERIOD    0.0442  0.0390  1.29   0.2569   
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     2.93    5.61
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.476     0.5
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 1.05 (0.97 - 1.13)   0.257
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ GUER90  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER90 ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err Wald Pr(>|W|)    
(Intercept) -3.60525  0.96417 14.0  0.00018 ***
OPRTIME      0.02597  0.00267 94.5  < 2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.25   0.482
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0296   0.128
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.03 (1.02 - 1.03)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ GUER90  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER90 ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -1.7174  0.9525  3.25    0.071 .  
HOSPTIME      0.0987  0.0204 23.53  1.2e-06 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.33    1.53
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.241    0.12
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate  OR            CI P_value
1  HOSPTIME 1.1 (1.06 - 1.15)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   GUER90 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = GUER90 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err Wald Pr(>|W|)  
(Intercept)             -0.05255  0.68568 0.01    0.939  
TRTn2Lich-Gregoir group -1.13636  1.43567 0.63    0.429  
PS                      -0.94632  0.42446 4.97    0.026 *
STENTYes                -0.80953  0.64383 1.58    0.209  
CATHPERIOD              -0.00841  0.06668 0.02    0.900  
OPRTIME                 -0.00157  0.00605 0.07    0.795  
HOSPTIME                -0.01352  0.13078 0.01    0.918  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      1.4    2.71
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.291    0.24
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.32 (0.02 - 5.35)   0.429
2                      PS 0.39 (0.17 - 0.89)   0.026
3                STENTYes 0.45 (0.13 - 1.57)   0.209
4              CATHPERIOD 0.99 (0.87 - 1.13)   0.900
5                 OPRTIME 1.00 (0.99 - 1.01)   0.795
6                HOSPTIME 0.99 (0.76 - 1.27)   0.918
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$GUER90
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.82"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.758 - 0.82 - 0.876"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
8.12 PROC365
> # %PROC365
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert PROC365 to numeric binary (0/1) in the matched dataset
> mdata$PROC365 <- ifelse(mdata$PROC365 == "Yes", 1, 0)
> table(mdata$PROC365)  # Check distribution of "Yes" and "No"

  0   1 
242  12 
> # Check structure of PROC365
> str(mdata$PROC365)
 num [1:254] 0 0 0 0 0 1 0 0 0 0 ...
> # Check frequency of values
> table(mdata$PROC365)  # Should show counts for 0 and 1

  0   1 
242  12 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : num  1 0 1 0 0 1 0 1 0 0 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : num  0 0 0 0 0 1 0 0 0 0 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ PROC365  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = PROC365 ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)    
(Intercept)              -2.9440  0.2155  187   <2e-16 ***
TRTn2Lich-Gregoir group   0.0172  0.2769    0     0.95    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     0.94   0.251
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00404 0.00608
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 1.02 (0.59 - 1.75)    0.95
> 
> #---------
> 
> gee_model <- geeglm(
+ PROC365  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = PROC365 ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)   -2.827   0.102 763.03   <2e-16 ***
STENTYes      -0.315   0.878   0.13     0.72    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.947   0.984
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00489  0.0268
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.73 (0.13 - 4.08)    0.72
> 
> #---------
> 
> gee_model <- geeglm(
+ PROC365  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = PROC365 ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -2.7867  0.0938 882.68   <2e-16 ***
CATHPERIOD   -0.0198  0.0270   0.54     0.46    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.975   0.935
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha  -0.0053  0.0124
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.98 (0.93 - 1.03)   0.464
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ PROC365  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = PROC365 ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -3.34300  0.37263 80.49   <2e-16 ***
OPRTIME      0.00369  0.00260  2.01     0.16    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.955   0.301
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00423 0.00461
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR         CI P_value
1   OPRTIME  1 (1 - 1.01)   0.156
> 
> #---------
> 
> gee_model <- geeglm(
+ PROC365  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = PROC365 ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -4.1942  0.3076 185.9  < 2e-16 ***
HOSPTIME      0.2188  0.0567  14.9  0.00011 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.933   0.424
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00343 0.00697
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.24 (1.11 - 1.39)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   PROC365 ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = PROC365 ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                         Estimate   Std.err  Wald Pr(>|W|)
(Intercept)             -4.34e+00  8.90e-01 23.76  1.1e-06
TRTn2Lich-Gregoir group -2.67e-02  4.22e-01  0.00     0.95
PS                       2.84e-01  1.46e+00  0.04     0.85
STENTYes                 1.40e-01  5.56e-01  0.06     0.80
CATHPERIOD              -3.23e-02  3.72e-02  0.75     0.39
OPRTIME                  8.03e-05  4.57e-03  0.00     0.99
HOSPTIME                 2.53e-01  5.55e-02 20.79  5.1e-06
                           
(Intercept)             ***
TRTn2Lich-Gregoir group    
PS                         
STENTYes                   
CATHPERIOD                 
OPRTIME                    
HOSPTIME                ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      1.1    4.17
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00399  0.0194
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1 TRTn2Lich-Gregoir group 0.97  (0.43 - 2.23)   0.950
2                      PS 1.33 (0.08 - 23.29)   0.846
3                STENTYes 1.15  (0.39 - 3.42)   0.802
4              CATHPERIOD 0.97   (0.9 - 1.04)   0.385
5                 OPRTIME 1.00  (0.99 - 1.01)   0.986
6                HOSPTIME 1.29  (1.16 - 1.44)   0.000
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$PROC365
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.751"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.566 - 0.756 - 0.899"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.003"
> 
> 
# Other non-significant different outcomes
8.13 BLDCOMPVOID
> # %BLDCOMPVOID
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert BLDCOMPVOID to numeric binary (0/1) in the matched dataset
> mdata$BLDCOMPVOID <- ifelse(mdata$BLDCOMPVOID == "Yes", 1, 0)
> table(mdata$BLDCOMPVOID)  # Check distribution of "Yes" and "No"

  0   1 
243  11 
> # Check structure of BLDCOMPVOID
> str(mdata$BLDCOMPVOID)
 num [1:254] 1 0 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$BLDCOMPVOID)  # Should show counts for 0 and 1

  0   1 
243  11 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : num  1 0 0 0 0 0 0 0 0 0 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : num  1 0 1 0 0 1 0 1 0 0 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : num  0 0 0 0 0 1 0 0 0 0 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ BLDCOMPVOID  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPVOID ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err   Wald Pr(>|W|)
(Intercept)               -3.021   0.182 274.91   <2e-16
TRTn2Lich-Gregoir group   -0.209   0.394   0.28      0.6
                           
(Intercept)             ***
TRTn2Lich-Gregoir group    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.02   0.261
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00627 0.00358
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.81 (0.37 - 1.76)   0.597
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPVOID  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPVOID ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err    Wald Pr(>|W|)    
(Intercept)  -3.1422  0.0746 1771.79   <2e-16 ***
STENTYes      0.1472  0.5204    0.08     0.78    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.996   0.344
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00661 0.00207
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 1.16 (0.42 - 3.21)   0.777
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPVOID  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPVOID ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err   Wald Pr(>|W|)    
(Intercept) -3.12160  0.07706 1640.8   <2e-16 ***
CATHPERIOD   0.01498  0.00177   71.5   <2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.849   0.329
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00748 0.00282
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 1.02 (1.01 - 1.02)       0
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ BLDCOMPVOID  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPVOID ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err   Wald Pr(>|W|)    
(Intercept) -3.44595  0.30264 129.65   <2e-16 ***
OPRTIME      0.00281  0.00262   1.15     0.28    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.05    0.12
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00598 0.00167
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR         CI P_value
1   OPRTIME  1 (1 - 1.01)   0.285
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPVOID  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPVOID ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)   -2.847   0.794 12.86  0.00034 ***
HOSPTIME      -0.067   0.185  0.13  0.71739    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.04  0.0962
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00543 0.00881
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 0.94 (0.65 - 1.34)   0.717
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   BLDCOMPVOID ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPVOID ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err Wald Pr(>|W|)   
(Intercept)             -2.99162  1.13312 6.97   0.0083 **
TRTn2Lich-Gregoir group -0.48685  0.56593 0.74   0.3896   
PS                       1.12513  1.37826 0.67   0.4143   
STENTYes                -2.16362  1.27239 2.89   0.0890 . 
CATHPERIOD               0.10522  0.04847 4.71   0.0300 * 
OPRTIME                  0.01233  0.00724 2.90   0.0886 . 
HOSPTIME                -0.56998  0.43310 1.73   0.1882   
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.892    1.81
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00735 0.00524
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.61  (0.2 - 1.86)   0.390
2                      PS 3.08 (0.21 - 45.9)   0.414
3                STENTYes 0.11 (0.01 - 1.39)   0.089
4              CATHPERIOD 1.11 (1.01 - 1.22)   0.030
5                 OPRTIME 1.01    (1 - 1.03)   0.089
6                HOSPTIME 0.57 (0.24 - 1.32)   0.188
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$BLDCOMPVOID
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.73"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.593 - 0.73 - 0.856"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.013"
> 
> 
8.14 BLDCOMPLEAK
> # %BLDCOMPLEAK
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert BLDCOMPLEAK to numeric binary (0/1) in the matched dataset
> mdata$BLDCOMPLEAK <- ifelse(mdata$BLDCOMPLEAK == "Yes", 1, 0)
> table(mdata$BLDCOMPLEAK)  # Check distribution of "Yes" and "No"

  0   1 
251   3 
> # Check structure of BLDCOMPLEAK
> str(mdata$BLDCOMPLEAK)
 num [1:254] 0 0 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$BLDCOMPLEAK)  # Should show counts for 0 and 1

  0   1 
251   3 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : num  1 0 0 0 0 0 0 0 0 0 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : num  1 0 1 0 0 1 0 1 0 0 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : num  0 0 0 0 0 1 0 0 0 0 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ BLDCOMPLEAK  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPLEAK ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err   Wald Pr(>|W|)
(Intercept)               -4.287   0.125 1184.8  < 2e-16
TRTn2Lich-Gregoir group    0.562   0.160   12.3  0.00045
                           
(Intercept)             ***
TRTn2Lich-Gregoir group ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.631   0.508
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00643 0.00165
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR           CI P_value
1 TRTn2Lich-Gregoir group 1.75 (1.28 - 2.4)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPLEAK  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPLEAK ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)   -3.724   0.142 687.79   <2e-16 ***
STENTYes      -0.768   1.034   0.55     0.46    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.697    2.43
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00707  0.0353
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.46 (0.06 - 3.52)   0.458
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPLEAK  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPLEAK ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -3.6754  0.1756 438.19   <2e-16 ***
CATHPERIOD   -0.0457  0.0337   1.84     0.18    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.662   0.501
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00742 0.00994
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.96 (0.89 - 1.02)   0.176
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ BLDCOMPLEAK  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPLEAK ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -5.87137  0.30187 378.3  < 2e-16 ***
OPRTIME      0.01666  0.00307  29.4  5.7e-08 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.776   0.193
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00698 0.00693
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.02 (1.01 - 1.02)       0
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDCOMPLEAK  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPLEAK ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err Wald Pr(>|W|)    
(Intercept) -4.70364  0.06260 5646   <2e-16 ***
HOSPTIME     0.11217  0.00343 1066   <2e-16 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.604   0.553
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00658 0.00244
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.12 (1.11 - 1.13)       0
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   BLDCOMPLEAK ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
Warning message:
glm.fit: fitted probabilities numerically 0 or 1 occurred 
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDCOMPLEAK ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -32.5590   4.3666 55.60  8.9e-14
TRTn2Lich-Gregoir group  18.3572   2.5102 53.48  2.6e-13
PS                        1.2800   0.4809  7.09   0.0078
STENTYes                 -3.3461   0.5608 35.60  2.4e-09
CATHPERIOD               -0.1173   0.0276 18.10  2.1e-05
OPRTIME                   0.1193   0.0149 63.71  1.4e-15
HOSPTIME                  0.2135   0.0295 52.55  4.2e-13
                           
(Intercept)             ***
TRTn2Lich-Gregoir group ***
PS                      ** 
STENTYes                ***
CATHPERIOD              ***
OPRTIME                 ***
HOSPTIME                ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.409    2.57
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00839  0.0417
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate       OR
1 TRTn2Lich-Gregoir group 9.38e+07
2                      PS 3.60e+00
3                STENTYes 4.00e-02
4              CATHPERIOD 8.90e-01
5                 OPRTIME 1.13e+00
6                HOSPTIME 1.24e+00
                            CI P_value
1 (684982.22 - 12857733301.03)   0.000
2                 (1.4 - 9.23)   0.008
3                (0.01 - 0.11)   0.000
4                (0.84 - 0.94)   0.000
5                (1.09 - 1.16)   0.000
6                (1.17 - 1.31)   0.000
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$BLDCOMPLEAK
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.935"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.813 - 0.936 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.004"
> 
> 
8.15 URCOMPSTEN
> # %URCOMPSTEN
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert URCOMPSTEN to numeric binary (0/1) in the matched dataset
> mdata$URCOMPSTEN <- ifelse(mdata$URCOMPSTEN == "Yes", 1, 0)
> table(mdata$URCOMPSTEN)  # Check distribution of "Yes" and "No"

  0   1 
241  13 
> # Check structure of URCOMPSTEN
> str(mdata$URCOMPSTEN)
 num [1:254] 0 0 0 0 0 0 0 0 1 0 ...
> # Check frequency of values
> table(mdata$URCOMPSTEN)  # Should show counts for 0 and 1

  0   1 
241  13 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : num  1 0 0 0 0 0 0 0 0 0 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : num  1 0 1 0 0 1 0 1 0 0 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : num  0 0 0 0 0 1 0 0 0 0 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : num  0 0 0 0 0 0 0 0 1 0 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ URCOMPSTEN  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPSTEN ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err  Wald Pr(>|W|)
(Intercept)               -3.747   0.718 27.24  1.8e-07
TRTn2Lich-Gregoir group    0.598   0.384  2.43     0.12
                           
(Intercept)             ***
TRTn2Lich-Gregoir group    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      1.6    4.86
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.023  0.0349
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 1.82 (0.86 - 3.86)   0.119
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPSTEN  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPSTEN ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)   -2.365   0.078 920.11   <2e-16 ***
STENTYes      -0.948   0.533   3.16    0.076 .  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.813   0.531
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00687  0.0128
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR           CI P_value
1  STENTYes 0.39 (0.14 - 1.1)   0.076
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPSTEN  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPSTEN ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err   Wald Pr(>|W|)    
(Intercept) -2.41464  0.04917 2411.2  < 2e-16 ***
CATHPERIOD  -0.03117  0.00605   26.6  2.6e-07 ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.827    0.24
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00671 0.00251
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.97 (0.96 - 0.98)       0
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ URCOMPSTEN  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPSTEN ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
             Estimate   Std.err  Wald Pr(>|W|)    
(Intercept) -3.313131  0.776147 18.22    2e-05 ***
OPRTIME     -0.000651  0.002928  0.05     0.82    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.54    3.47
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0212  0.0175
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR            CI P_value
1   OPRTIME  1 (0.99 - 1.01)   0.824
> 
> #---------
> 
> gee_model <- geeglm(
+ URCOMPSTEN  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPSTEN ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -2.9530  0.5074 33.87  5.9e-09 ***
HOSPTIME     -0.0940  0.0841  1.25     0.26    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.51    3.77
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0203  0.0191
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 0.91 (0.77 - 1.07)   0.264
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   URCOMPSTEN ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = URCOMPSTEN ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -4.96814  0.81252 37.39  9.7e-10
TRTn2Lich-Gregoir group  0.91156  0.44386  4.22    0.040
PS                       1.59862  0.40844 15.32  9.1e-05
STENTYes                -0.18846  0.52060  0.13    0.717
CATHPERIOD              -0.01801  0.01064  2.87    0.090
OPRTIME                  0.01059  0.00636  2.77    0.096
HOSPTIME                -0.00611  0.02762  0.05    0.825
                           
(Intercept)             ***
TRTn2Lich-Gregoir group *  
PS                      ***
STENTYes                   
CATHPERIOD              .  
OPRTIME                 .  
HOSPTIME                   
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.746    0.15
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00702  0.0117
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1 TRTn2Lich-Gregoir group 2.49  (1.04 - 5.94)   0.040
2                      PS 4.95 (2.22 - 11.01)   0.000
3                STENTYes 0.83    (0.3 - 2.3)   0.717
4              CATHPERIOD 0.98     (0.96 - 1)   0.090
5                 OPRTIME 1.01     (1 - 1.02)   0.096
6                HOSPTIME 0.99  (0.94 - 1.05)   0.825
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$URCOMPSTEN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.641"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.504 - 0.646 - 0.776"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.086"
> 
> 
8.16 INCCOMPSCAR
# Note: Stenting was excluded from the multivariable analysis for incisional hernia due to zero occurrence of the variable among cases.


> # %INCCOMPSCAR
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert INCCOMPSCAR to numeric binary (0/1) in the matched dataset
> mdata$INCCOMPSCAR <- ifelse(mdata$INCCOMPSCAR == "Yes", 1, 0)
> table(mdata$INCCOMPSCAR)  # Check distribution of "Yes" and "No"

  0   1 
252   2 
> # Check structure of INCCOMPSCAR
> str(mdata$INCCOMPSCAR)
 num [1:254] 0 0 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$INCCOMPSCAR)  # Should show counts for 0 and 1

  0   1 
252   2 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 2 1 1 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ INCCOMPSCAR  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPSCAR ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)    
(Intercept)              -5.0448  0.6958 52.6  4.2e-13 ***
TRTn2Lich-Gregoir group   0.0691  1.6790  0.0     0.97    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.19    1.66
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00463 0.00485
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1 TRTn2Lich-Gregoir group 1.07 (0.04 - 28.79)   0.967
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPSCAR  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPSCAR ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)   -4.468   0.961 21.61  3.3e-06 ***
CATHPERIOD    -0.162   0.277  0.34     0.56    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.13   0.582
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00552 0.00112
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.85 (0.49 - 1.46)    0.56
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ INCCOMPSCAR  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPSCAR ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)   
(Intercept)  -6.1144  2.2331 7.50   0.0062 **
OPRTIME       0.0113  0.0129 0.76   0.3832   
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)      1.1    18.5
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha 0.000315  0.0113
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1   OPRTIME 1.01 (0.99 - 1.04)   0.383
> 
> #---------
> 
> gee_model <- geeglm(
+ INCCOMPSCAR  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPSCAR ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -4.8881  1.2274 15.86  6.8e-05 ***
HOSPTIME     -0.0268  0.2353  0.01     0.91    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.19    2.07
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00466 0.00639
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 0.97 (0.61 - 1.54)   0.909
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   INCCOMPSCAR ~ TRTn2 + PS + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
Warning message:
glm.fit: fitted probabilities numerically 0 or 1 occurred 
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = INCCOMPSCAR ~ TRTn2 + PS + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -8.86982  2.25718 15.44  8.5e-05
TRTn2Lich-Gregoir group  0.45075  0.11427 15.56  8.0e-05
PS                       4.94501  1.45739 11.51  0.00069
CATHPERIOD              -0.29835  0.13676  4.76  0.02914
OPRTIME                  0.01692  0.00628  7.26  0.00704
HOSPTIME                 0.12970  0.05115  6.43  0.01122
                           
(Intercept)             ***
TRTn2Lich-Gregoir group ***
PS                      ***
CATHPERIOD              *  
OPRTIME                 ** 
HOSPTIME                *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.257    1.17
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0322   0.188
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "CATHPERIOD"              "OPRTIME"                
[5] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 5
> print(length(std_errors))
[1] 5
> print(length(p_values))
[1] 5
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate     OR               CI P_value
1 TRTn2Lich-Gregoir group   1.57    (1.25 - 1.96)   0.000
2                      PS 140.47 (8.07 - 2444.23)   0.001
3              CATHPERIOD   0.74    (0.57 - 0.97)   0.029
4                 OPRTIME   1.02       (1 - 1.03)   0.007
5                HOSPTIME   1.14    (1.03 - 1.26)   0.011
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPSCAR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.885"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.754 - 0.883 - 0.992"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.054"
> 
> 
8.17 ANASTOMO
# Note: Stenting was excluded from the multivariable analysis for anastomosis due to zero occurrence of the variable among cases.


> # %ANASTOMO
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert ANASTOMO to numeric binary (0/1) in the matched dataset
> mdata$ANASTOMO <- ifelse(mdata$ANASTOMO == "Yes", 1, 0)
> table(mdata$ANASTOMO)  # Check distribution of "Yes" and "No"

  0   1 
251   3 
> # Check structure of ANASTOMO
> str(mdata$ANASTOMO)
 num [1:254] 0 0 0 0 0 0 0 0 0 0 ...
> # Check frequency of values
> table(mdata$ANASTOMO)  # Should show counts for 0 and 1

  0   1 
251   3 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 2 1 1 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ ANASTOMO  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ANASTOMO ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err    Wald Pr(>|W|)
(Intercept)              -3.7495  0.0666 3166.93   <2e-16
TRTn2Lich-Gregoir group  -0.5165  0.2134    5.86    0.015
                           
(Intercept)             ***
TRTn2Lich-Gregoir group *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.634   0.487
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00636 0.00112
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate  OR            CI P_value
1 TRTn2Lich-Gregoir group 0.6 (0.39 - 0.91)   0.015
> 
> #---------
> 
> gee_model <- geeglm(
+ ANASTOMO  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ANASTOMO ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -3.6550  0.1770 426.21   <2e-16 ***
CATHPERIOD   -0.0633  0.0317   3.98    0.046 *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.632   0.471
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00759 0.00286
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR         CI P_value
1 CATHPERIOD 0.94 (0.88 - 1)   0.046
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ ANASTOMO  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ANASTOMO ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -4.11042  0.65859 38.95  4.3e-10 ***
OPRTIME      0.00143  0.00616  0.05     0.82    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.645  0.0984
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00642 0.00809
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR            CI P_value
1   OPRTIME  1 (0.99 - 1.01)   0.817
> 
> #---------
> 
> gee_model <- geeglm(
+ ANASTOMO  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ANASTOMO ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err   Wald Pr(>|W|)    
(Intercept) -3.99936  0.12935 955.92   <2e-16 ***
HOSPTIME     0.00755  0.02619   0.08     0.77    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.641   0.435
  Link = identity 

Estimated Correlation Parameters:
      Estimate  Std.err
alpha -0.00637 0.000879
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.01 (0.96 - 1.06)   0.773
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   ANASTOMO ~ TRTn2 + PS + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = ANASTOMO ~ TRTn2 + PS + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err Wald Pr(>|W|)   
(Intercept)             -2.00552  1.83456 1.20   0.2743   
TRTn2Lich-Gregoir group -1.07552  0.74197 2.10   0.1472   
PS                      -1.04511  0.48113 4.72   0.0298 * 
CATHPERIOD              -0.08322  0.02905 8.21   0.0042 **
OPRTIME                 -0.00812  0.01127 0.52   0.4714   
HOSPTIME                 0.05975  0.02344 6.50   0.0108 * 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.592   0.428
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00749  0.0194
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "CATHPERIOD"              "OPRTIME"                
[5] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 5
> print(length(std_errors))
[1] 5
> print(length(p_values))
[1] 5
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.34 (0.08 - 1.46)   0.147
2                      PS 0.35  (0.14 - 0.9)   0.030
3              CATHPERIOD 0.92 (0.87 - 0.97)   0.004
4                 OPRTIME 0.99 (0.97 - 1.01)   0.471
5                HOSPTIME 1.06 (1.01 - 1.11)   0.011
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ANASTOMO
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.709"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.307 - 0.712 - 0.94"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.243"
> 
> 
8.18 BLDSPASM
> # %BLDSPASM
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert BLDSPASM to numeric binary (0/1) in the matched dataset
> mdata$BLDSPASM <- ifelse(mdata$BLDSPASM == "Yes", 1, 0)
> table(mdata$BLDSPASM)  # Check distribution of "Yes" and "No"

  0   1 
176  78 
> # Check structure of BLDSPASM
> str(mdata$BLDSPASM)
 num [1:254] 0 1 0 0 1 0 1 1 0 0 ...
> # Check frequency of values
> table(mdata$BLDSPASM)  # Should show counts for 0 and 1

  0   1 
176  78 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ BLDCOMPLEAK                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : num  1 0 0 0 0 0 0 0 0 0 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : num  0 1 0 0 1 0 1 1 0 0 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : num  1 0 1 0 0 1 0 1 0 0 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : num  0 0 0 0 0 1 0 0 0 0 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : num  0 0 0 0 0 0 0 0 1 0 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ BLDSPASM  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDSPASM ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)    
(Intercept)               -0.713   0.156 21.0  4.7e-06 ***
TRTn2Lich-Gregoir group   -0.410   0.225  3.3    0.069 .  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.04     0.2
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0158  0.0299
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.66 (0.43 - 1.03)   0.069
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDSPASM  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDSPASM ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err   Wald Pr(>|W|)    
(Intercept)  -0.6187  0.0355 303.58   <2e-16 ***
STENTYes     -0.4714  0.4245   1.23     0.27    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.991  0.0914
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00337   0.021
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.62 (0.27 - 1.43)   0.267
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDSPASM  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDSPASM ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -0.52715  0.03151 279.9   <2e-16 ***
CATHPERIOD  -0.02632  0.00816  10.4   0.0012 ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.992  0.0642
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00707 0.00213
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.97 (0.96 - 0.99)   0.001
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ BLDSPASM  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDSPASM ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
             Estimate   Std.err  Wald Pr(>|W|)    
(Intercept) -1.026339  0.219610 21.84    3e-06 ***
OPRTIME      0.001315  0.000677  3.77    0.052 .  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.03   0.145
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.011  0.0231
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR      CI P_value
1   OPRTIME  1 (1 - 1)   0.052
> 
> #---------
> 
> gee_model <- geeglm(
+ BLDSPASM  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDSPASM ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -0.9852  0.1873 27.68  1.4e-07 ***
HOSPTIME      0.0180  0.0124  2.11     0.15    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.04   0.158
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0133  0.0259
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.02 (0.99 - 1.04)   0.146
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   BLDSPASM ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = BLDSPASM ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err  Wald Pr(>|W|)
(Intercept)             -0.18583  0.50637  0.13  0.71363
TRTn2Lich-Gregoir group -0.79651  0.39554  4.06  0.04404
PS                       0.71303  0.28837  6.11  0.01341
STENTYes                -0.07143  0.36864  0.04  0.84635
CATHPERIOD              -0.02847  0.01063  7.18  0.00739
OPRTIME                 -0.00466  0.00316  2.18  0.13991
HOSPTIME                 0.04105  0.01244 10.88  0.00097
                           
(Intercept)                
TRTn2Lich-Gregoir group *  
PS                      *  
STENTYes                   
CATHPERIOD              ** 
OPRTIME                    
HOSPTIME                ***
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.972  0.0292
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00658 0.00928
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.45 (0.21 - 0.98)   0.044
2                      PS 2.04 (1.16 - 3.59)   0.013
3                STENTYes 0.93 (0.45 - 1.92)   0.846
4              CATHPERIOD 0.97 (0.95 - 0.99)   0.007
5                 OPRTIME 1.00    (0.99 - 1)   0.140
6                HOSPTIME 1.04 (1.02 - 1.07)   0.001
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$BLDSPASM
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.6"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.526 - 0.6 - 0.667"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.016"
> 
> 
8.19 HEMAT
> # %HEMAT
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert HEMAT to numeric binary (0/1) in the matched dataset
> mdata$HEMAT <- ifelse(mdata$HEMAT == "Yes", 1, 0)
> table(mdata$HEMAT)  # Check distribution of "Yes" and "No"

  0   1 
207  47 
> # Check structure of HEMAT
> str(mdata$HEMAT)
 num [1:254] 0 1 1 0 1 1 0 1 0 0 ...
> # Check frequency of values
> table(mdata$HEMAT)  # Should show counts for 0 and 1

  0   1 
207  47 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ BLDCOMPLEAK                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : num  1 0 0 0 0 0 0 0 0 0 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : num  0 1 0 0 1 0 1 1 0 0 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GU90                           : num  0 1 1 0 1 1 0 1 0 0 ...
 $ GUER30                         : num  0 0 0 0 0 1 0 1 0 0 ...
 $ GUER90                         : num  1 0 1 0 0 1 0 1 0 0 ...
 $ HEMAT                          : num  0 1 1 0 1 1 0 1 0 0 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ INCCOMPBLEED                   : num  1 1 0 0 0 0 0 0 0 0 ...
 $ INCCOMPINF                     : num  0 0 0 0 1 0 0 1 0 0 ...
 $ INCCOMPSCAR                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : num  0 0 0 0 0 1 0 0 0 0 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPINJ                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ URCOMPOBST                     : num  0 0 0 0 0 0 0 1 0 0 ...
 $ URCOMPSTEN                     : num  0 0 0 0 0 0 0 0 1 0 ...
 $ UTIpostop                      : Factor w/ 2 levels "No UTI","UTI": 2 1 1 1 1 2 1 1 2 1 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ HEMAT  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = HEMAT ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err   Wald Pr(>|W|)
(Intercept)              -1.2785  0.0889 206.98   <2e-16
TRTn2Lich-Gregoir group  -0.3547  0.2234   2.52     0.11
                           
(Intercept)             ***
TRTn2Lich-Gregoir group    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.977  0.0534
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha  -0.0037 0.00354
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate  OR            CI P_value
1 TRTn2Lich-Gregoir group 0.7 (0.45 - 1.09)   0.112
> 
> #---------
> 
> gee_model <- geeglm(
+ HEMAT  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = HEMAT ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err    Wald Pr(>|W|)    
(Intercept)  -1.3228  0.0241 3003.34   <2e-16 ***
STENTYes     -0.5745  0.2515    5.22    0.022 *  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.01    0.16
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00695  0.0058
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.56 (0.34 - 0.92)   0.022
> 
> #---------
> 
> gee_model <- geeglm(
+ HEMAT  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = HEMAT ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err    Wald Pr(>|W|)    
(Intercept) -1.33256  0.02425 3018.75   <2e-16 ***
CATHPERIOD  -0.01938  0.00705    7.55    0.006 ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.01  0.0981
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00638 0.00294
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.98 (0.97 - 0.99)   0.006
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ HEMAT  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = HEMAT ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err  Wald Pr(>|W|)    
(Intercept) -1.64712  0.20840 62.47  2.7e-15 ***
OPRTIME      0.00196  0.00170  1.33     0.25    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.977  0.0157
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha  -0.0047 0.00219
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR         CI P_value
1   OPRTIME  1 (1 - 1.01)   0.249
> 
> #---------
> 
> gee_model <- geeglm(
+ HEMAT  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = HEMAT ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)  -1.6217  0.0722 504.9   <2e-16 ***
HOSPTIME      0.0381  0.0117  10.7   0.0011 ** 
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.973  0.0179
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00429 0.00235
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HOSPTIME 1.04 (1.02 - 1.06)   0.001
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   HEMAT ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = HEMAT ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + 
    HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err Wald Pr(>|W|)   
(Intercept)             -0.48007  0.93030 0.27   0.6058   
TRTn2Lich-Gregoir group -0.88849  0.68714 1.67   0.1960   
PS                       0.18038  0.69820 0.07   0.7961   
STENTYes                -0.52317  0.48259 1.18   0.2783   
CATHPERIOD              -0.01680  0.01108 2.30   0.1293   
OPRTIME                 -0.00680  0.00757 0.81   0.3687   
HOSPTIME                 0.06398  0.02040 9.84   0.0017 **
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.993   0.101
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00674  0.0184
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.41 (0.11 - 1.58)   0.196
2                      PS 1.20  (0.3 - 4.71)   0.796
3                STENTYes 0.59 (0.23 - 1.53)   0.278
4              CATHPERIOD 0.98    (0.96 - 1)   0.129
5                 OPRTIME 0.99 (0.98 - 1.01)   0.369
6                HOSPTIME 1.07 (1.02 - 1.11)   0.002
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$HEMAT
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.583"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.498 - 0.585 - 0.665"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.065"
> 
> 
8.20 UTIpostop
> # %UTIpostop
> # =================
> 
> # Univariable and multivariable analysis for the outcomes using the multivariable GEE model with a logit link function and an exchangeable correlation
> 
> 
> # Convert UTIpostop to numeric binary (0/1) in the matched dataset
> mdata$UTIpostop <- ifelse(mdata$UTIpostop == "UTI", 1, 0)
> table(mdata$UTIpostop)  # Check distribution of "UTI" and "No UTI"

  0   1 
182  72 
> # Check structure of UTIpostop
> str(mdata$UTIpostop)
 num [1:254] 1 0 0 0 0 1 0 0 1 0 ...
> # Check frequency of values
> table(mdata$UTIpostop)  # Should show counts for 0 and 1

  0   1 
182  72 
> 
> #Ensure that all the other variable are in the correct format
> mdata$TRTn2 <-as.factor (mdata$TRTn2)
> mdata$CATHPERIOD <-as.numeric (mdata$CATHPERIOD)
> mdata$OPRTIME <-as.numeric (mdata$OPRTIME)
> mdata$HOSPTIME <-as.numeric (mdata$HOSPTIME)
> mdata$STENT <-as.factor (mdata$STENT)
> mdata$Center <-as.factor (mdata$Center)
> str (mdata)
Classes ‘matchdata’ and 'data.frame':   254 obs. of  68 variables:
 $ Case                           : chr  "S1" "S100" "S101" "S103" ...
 $ NEW.CASE.CODE.QCODEVUR.DATASETS: chr  "S1" "S102" "S103" "S106" ...
 $ QCODE                          : chr  "102" "3" "4" "7" ...
 $ REC011                         : Factor w/ 3 levels "No recurrence",..: 1 1 2 1 2 2 1 2 2 1 ...
 $ AGS                            : num  5 7 10 7 9 10 8 7 11 6 ...
 $ ANASTOMO                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPLEAK                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ BLDCOMPRETN                    : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 2 1 ...
 $ BLDCOMPVOID                    : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 1 1 ...
 $ BLDLOSS                        : num  70 150 55 55 190 75 100 55 55 65 ...
 $ BLDSPASM                       : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 2 2 1 1 ...
 $ BMI                            : num  13.5 12 13.3 15 15.8 15.3 15.3 14.8 15.3 13.6 ...
 $ CATH                           : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ CATHPERIOD                     : num  2 5 5 4 7 4 5 5 7 6 ...
 $ Center                         : Factor w/ 4 levels "Al-Zahraa hospital",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ CLAVIENCLASS                   : Factor w/ 5 levels "Clavien grade 1",..: 2 2 2 1 2 2 1 2 3 2 ...
 $ EPIDURAL                       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ FUPm                           : num  24 44 36 120 36 36 37 12 36 12 ...
 $ GENDER                         : Factor w/ 2 levels "Male","Female": 1 2 2 2 1 1 2 2 1 2 ...
 $ GU30                           : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GU90                           : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ GUER30                         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 2 1 1 ...
 $ GUER90                         : Factor w/ 2 levels "No","Yes": 2 1 2 1 1 2 1 2 1 1 ...
 $ HEMAT                          : Factor w/ 2 levels "No","Yes": 1 2 2 1 2 2 1 2 1 1 ...
 $ HISTOINJ                       : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 2 1 1 1 ...
 $ HOSPTIME                       : num  2 5 5 4 5 8 5 5 4 5 ...
 $ ILEUS                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ INCCOMPBLEED                   : Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...
 $ INCCOMPINF                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 2 1 1 2 1 1 ...
 $ INCCOMPSCAR                    : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ NARC                           : Factor w/ 2 levels "No","Yes": 1 2 1 1 2 1 1 2 1 1 ...
 $ NONARC                         : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
 $ OPRTIME                        : num  76 80 83 90 75 90 88 85 80 88 ...
 $ PAIN                           : Factor w/ 4 levels "No pain","Mild pain",..: 2 4 2 2 3 3 2 4 2 2 ...
 $ PREOPEPISODEn                  : Factor w/ 3 levels "1","2","≥ 3": 2 3 3 3 3 3 2 3 3 3 ...
 $ PREOPRNPLN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
 $ PREOPRNSCR                     : Factor w/ 2 levels "No scarring",..: 1 1 2 1 1 1 1 2 1 2 ...
 $ PREOPTYPEUn                    : Factor w/ 2 levels "Afebrile","Febrile": 2 2 2 2 2 2 2 2 2 2 ...
 $ PREOPVURGRADE                  : Factor w/ 3 levels "III","IV","V": 3 3 3 2 3 2 2 3 2 2 ...
 $ PROC365                        : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...
 $ STENT                          : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ SURGIND                        : Factor w/ 11 levels "Poor compliance to medical treatment",..: 3 3 3 4 4 4 3 3 3 3 ...
 $ SURGTECHn2                     : Factor w/ 3 levels "≥ 100","50 - 100",..: 3 2 2 2 2 2 2 2 2 2 ...
 $ TRTn2                          : Factor w/ 2 levels "Cohen group",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ UDR7M                          : Factor w/ 2 levels "< 7 mm","≥ 7mm": 2 2 2 1 2 2 2 2 2 2 ...
 $ URCOMPCVUR                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPINJ                      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ URCOMPOBST                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 2 1 1 ...
 $ URCOMPSTEN                     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
 $ UTIpostop                      : num  1 0 0 0 0 1 0 0 1 0 ...
 $ UTIpostopFup                   : num  1 44 36 120 36 1 37 12 1 12 ...
 $ UTIpostopT                     : num  1 0 0 0 0 1 0 0 1 0 ...
 $ VURPHASE                       : Factor w/ 3 levels "At voiding","At filling",..: 1 3 3 1 1 1 1 1 1 2 ...
 $ VURRECG01                      : Factor w/ 2 levels "No recurrence",..: 1 1 2 1 2 2 1 2 1 1 ...
 $ VURSIDE                        : Factor w/ 2 levels "Left","Right": 1 2 2 1 2 2 1 1 2 2 ...
 $ VURREC                         : chr  "1" "0" "1" "0. No" ...
 $ VURRECGRADE                    : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD1M                     : chr  "1" "0" "2" "1" ...
 $ DOWNGRAD3M                     : chr  "1" "1" "2" "0" ...
 $ DOWNGRAD1Y                     : chr  "1" "0" "2" "0" ...
 $ DOWNGRAD2Y                     : chr  "N/A" "0" "2" "0" ...
 $ DOWNGRAD3Y                     : chr  "N/A" "0" "N/A" "N/A" ...
 $ DOWNGRAD5Y                     : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ DOWNGRAD10Y                    : chr  "N/A" "N/A" "N/A" "N/A" ...
 $ PS                             : num  0.274 0.754 0.702 0.684 0.456 ...
 $ distance                       : num  0.274 0.754 0.702 0.684 0.456 ...
 $ weights                        : num  1 1 1 1 1 1 1 1 1 1 ...
 $ subclass                       : Factor w/ 127 levels "1","2","3","4",..: 1 45 74 86 95 105 114 123 2 6 ...
 - attr(*, "distance")= chr "distance"
 - attr(*, "weights")= chr "weights"
 - attr(*, "subclass")= chr "subclass"
> 
> #---------
> 
> #Fit the GEE model for univariate analysis - TRTn2
> gee_model <- geeglm(
+ UTIpostop  ~ TRTn2 , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = UTIpostop ~ TRTn2, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate Std.err Wald Pr(>|W|)  
(Intercept)               -1.143   0.457 6.25    0.012 *
TRTn2Lich-Gregoir group   -0.267   0.116 5.25    0.022 *
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.22   0.733
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.112  0.0696
Number of clusters:   8  Maximum cluster size: 167 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.77 (0.61 - 0.96)   0.022
> 
> #---------
> 
> gee_model <- geeglm(
+ UTIpostop  ~ STENT , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = UTIpostop ~ STENT, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err  Wald Pr(>|W|)    
(Intercept)   -1.128   0.325 12.04  0.00052 ***
STENTYes      -0.427   0.548  0.61  0.43600    
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.14   0.485
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0905  0.0553
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "STENTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  STENTYes 0.65 (0.22 - 1.91)   0.436
> 
> #---------
> 
> gee_model <- geeglm(
+ UTIpostop  ~ CATHPERIOD , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = UTIpostop ~ CATHPERIOD, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)   
(Intercept)  -0.3800  0.1912 3.95   0.0469 * 
CATHPERIOD   -0.0829  0.0264 9.90   0.0017 **
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)        1    1.15
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha   0.0018  0.0133
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CATHPERIOD"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
   Covariate   OR            CI P_value
1 CATHPERIOD 0.92 (0.87 - 0.97)   0.002
> 
> #---------
> 
> 
> gee_model <- geeglm(
+ UTIpostop  ~ OPRTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = UTIpostop ~ OPRTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate  Std.err Wald Pr(>|W|)   
(Intercept) -1.38405  0.46103 9.01   0.0027 **
OPRTIME      0.00110  0.00153 0.52   0.4718   
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.21   0.665
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.109  0.0717
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "OPRTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate OR      CI P_value
1   OPRTIME  1 (1 - 1)   0.472
> 
> #---------
> 
> gee_model <- geeglm(
+ UTIpostop  ~ HOSPTIME , 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = UTIpostop ~ HOSPTIME, family = binomial(link = "logit"), 
    data = mdata, id = Center, corstr = "exchangeable")

 Coefficients:
            Estimate Std.err Wald Pr(>|W|)  
(Intercept)  -0.8788  0.3948 4.95    0.026 *
HOSPTIME     -0.0947  0.0641 2.18    0.140  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)     1.22   0.688
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha    0.118  0.0705
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HOSPTIME"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR           CI P_value
1  HOSPTIME 0.91 (0.8 - 1.03)    0.14
> 
> #---------
> 
> # Fit the GEE model for multivariable analysis
> gee_model <- geeglm(
+   UTIpostop ~ TRTn2 + PS + STENT + CATHPERIOD + OPRTIME + HOSPTIME, 
+   data = mdata, 
+   id = Center, 
+   family = binomial(link = "logit"), 
+   corstr = "exchangeable"
+ )
> # Display the summary of the model
> summary(gee_model)

Call:
geeglm(formula = UTIpostop ~ TRTn2 + PS + STENT + CATHPERIOD + 
    OPRTIME + HOSPTIME, family = binomial(link = "logit"), data = mdata, 
    id = Center, corstr = "exchangeable")

 Coefficients:
                        Estimate  Std.err Wald Pr(>|W|)  
(Intercept)              0.11991  0.68237 0.03    0.861  
TRTn2Lich-Gregoir group -0.31245  0.16523 3.58    0.059 .
PS                      -0.45489  0.49161 0.86    0.355  
STENTYes                -0.68926  0.67304 1.05    0.306  
CATHPERIOD              -0.07535  0.03499 4.64    0.031 *
OPRTIME                  0.00243  0.00237 1.06    0.304  
HOSPTIME                -0.04502  0.04479 1.01    0.315  
---
Signif. codes:  
0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Correlation structure = exchangeable 
Estimated Scale Parameters:

            Estimate Std.err
(Intercept)    0.979    1.33
  Link = identity 

Estimated Correlation Parameters:
      Estimate Std.err
alpha -0.00364  0.0333
Number of clusters:   8  Maximum cluster size: 167 
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "TRTn2Lich-Gregoir group" "PS"                     
[3] "STENTYes"                "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1 TRTn2Lich-Gregoir group 0.73 (0.53 - 1.01)   0.059
2                      PS 0.63 (0.24 - 1.66)   0.355
3                STENTYes 0.50 (0.13 - 1.88)   0.306
4              CATHPERIOD 0.93 (0.87 - 0.99)   0.031
5                 OPRTIME 1.00    (1 - 1.01)   0.304
6                HOSPTIME 0.96 (0.88 - 1.04)   0.315
> 
> #---------
> 
> # Check the performance of the multivariate model using AUC, 95% CI of AUC and p-value
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$UTIpostop
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = 0, case = 1
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.684"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.615 - 0.685 - 0.752"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>

==================================================================================================
==================================================================================================

9. Rosenbaum’s sensitivity analysis

> # Rosenbaum’s sensitivity analysis
> # Recall the Matchit object (Perform it if it was not done before)
> library(MatchIt)
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 
> summary(m.out, standardize=TRUE)

Call:
matchit(formula = TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI + AGS + 
    PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE + PREOPEPISODEn + 
    PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, 
    method = "nearest", caliper = caliper_width)

Summary of Balance for All Data:
                                                         Means Treated
distance                                                        0.6939
PREOPVURGRADEIII                                                0.0419
PREOPVURGRADEIV                                                 0.3442
PREOPVURGRADEV                                                  0.6140
HISTOINJNo                                                      0.8837
HISTOINJYes                                                     0.1163
BMI                                                            14.8493
AGS                                                             7.6791
PREOPRNPLNNo                                                    0.9070
PREOPRNPLNYes                                                   0.0930
PREOPRNSCRNo scarring                                           0.7953
PREOPRNSCRAny scarring                                          0.2047
VURSIDELeft                                                     0.3814
VURSIDERight                                                    0.6186
VURPHASEAt voiding                                              0.5302
VURPHASEAt filling                                              0.3163
VURPHASEAt filling and voiding                                  0.1535
PREOPEPISODEn1                                                  0.0372
PREOPEPISODEn2                                                  0.1535
PREOPEPISODEn≥ 3                                                0.8093
PREOPTYPEUnAfebrile                                             0.0047
PREOPTYPEUnFebrile                                              0.9953
SURGTECHn2≥ 100                                                 0.3256
SURGTECHn250 - 100                                              0.6326
SURGTECHn2<50                                                   0.0419
GENDERMale                                                      0.5953
GENDERFemale                                                    0.4047
UDR7M< 7 mm                                                     0.3023
UDR7M≥ 7mm                                                      0.6977
SURGINDPoor compliance to medical treatment                     0.0419
SURGINDChildren with ineffective or poorly tolerated CAP        0.0093
SURGINDSymptomatic high-grade reflux (III-V)                    0.3488
SURGINDRepeated breakthrough UTI                                0.5628
SURGINDGirls with persistent VUR after puberty                  0.0047
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0233
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0093
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Means Control
distance                                                        0.3324
PREOPVURGRADEIII                                                0.0556
PREOPVURGRADEIV                                                 0.2626
PREOPVURGRADEV                                                  0.6818
HISTOINJNo                                                      0.9040
HISTOINJYes                                                     0.0960
BMI                                                            16.9864
AGS                                                             6.8914
PREOPRNPLNNo                                                    0.6566
PREOPRNPLNYes                                                   0.3434
PREOPRNSCRNo scarring                                           0.5253
PREOPRNSCRAny scarring                                          0.4747
VURSIDELeft                                                     0.4040
VURSIDERight                                                    0.5960
VURPHASEAt voiding                                              0.5707
VURPHASEAt filling                                              0.0051
VURPHASEAt filling and voiding                                  0.4242
PREOPEPISODEn1                                                  0.0808
PREOPEPISODEn2                                                  0.3434
PREOPEPISODEn≥ 3                                                0.5758
PREOPTYPEUnAfebrile                                             0.0354
PREOPTYPEUnFebrile                                              0.9646
SURGTECHn2≥ 100                                                 0.0758
SURGTECHn250 - 100                                              0.6970
SURGTECHn2<50                                                   0.2273
GENDERMale                                                      0.5455
GENDERFemale                                                    0.4545
UDR7M< 7 mm                                                     0.1616
UDR7M≥ 7mm                                                      0.8384
SURGINDPoor compliance to medical treatment                     0.0505
SURGINDChildren with ineffective or poorly tolerated CAP        0.0556
SURGINDSymptomatic high-grade reflux (III-V)                    0.2929
SURGINDRepeated breakthrough UTI                                0.4747
SURGINDGirls with persistent VUR after puberty                  0.0000
SURGINDVUR recurrence after endoscopic injection                0.0051
SURGINDReflux nephropathy                                       0.0303
SURGINDPresence of new renal scars on DMSA                      0.0202
SURGINDWorsening in renal function                              0.0202
SURGINDParental preference                                      0.0051
SURGINDPersistent reflux >2 years                               0.0455
                                                         Std. Mean Diff.
distance                                                          1.4219
PREOPVURGRADEIII                                                 -0.0684
PREOPVURGRADEIV                                                   0.1717
PREOPVURGRADEV                                                   -0.1394
HISTOINJNo                                                       -0.0634
HISTOINJYes                                                       0.0634
BMI                                                              -0.8280
AGS                                                               0.3528
PREOPRNPLNNo                                                      0.8621
PREOPRNPLNYes                                                    -0.8621
PREOPRNSCRNo scarring                                             0.6695
PREOPRNSCRAny scarring                                           -0.6695
VURSIDELeft                                                      -0.0466
VURSIDERight                                                      0.0466
VURPHASEAt voiding                                               -0.0811
VURPHASEAt filling                                                0.6693
VURPHASEAt filling and voiding                                   -0.7511
PREOPEPISODEn1                                                   -0.2303
PREOPEPISODEn2                                                   -0.5270
PREOPEPISODEn≥ 3                                                  0.5945
PREOPTYPEUnAfebrile                                              -0.4512
PREOPTYPEUnFebrile                                                0.4512
SURGTECHn2≥ 100                                                   0.5331
SURGTECHn250 - 100                                               -0.1336
SURGTECHn2<50                                                    -0.9258
GENDERMale                                                        0.1017
GENDERFemale                                                     -0.1017
UDR7M< 7 mm                                                       0.3064
UDR7M≥ 7mm                                                       -0.3064
SURGINDPoor compliance to medical treatment                      -0.0432
SURGINDChildren with ineffective or poorly tolerated CAP         -0.4818
SURGINDSymptomatic high-grade reflux (III-V)                      0.1173
SURGINDRepeated breakthrough UTI                                  0.1775
SURGINDGirls with persistent VUR after puberty                    0.0684
SURGINDVUR recurrence after endoscopic injection                 -0.1029
SURGINDReflux nephropathy                                        -0.0468
SURGINDPresence of new renal scars on DMSA                       -0.2074
SURGINDWorsening in renal function                               -0.1135
SURGINDParental preference                                       -0.1029
SURGINDPersistent reflux >2 years                                -0.3152
                                                         Var. Ratio
distance                                                     1.2698
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                          0.4302
AGS                                                          0.4700
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                    0.3476
PREOPVURGRADEIII                                            0.0137
PREOPVURGRADEIV                                             0.0816
PREOPVURGRADEV                                              0.0679
HISTOINJNo                                                  0.0203
HISTOINJYes                                                 0.0203
BMI                                                         0.1801
AGS                                                         0.0560
PREOPRNPLNNo                                                0.2504
PREOPRNPLNYes                                               0.2504
PREOPRNSCRNo scarring                                       0.2701
PREOPRNSCRAny scarring                                      0.2701
VURSIDELeft                                                 0.0226
VURSIDERight                                                0.0226
VURPHASEAt voiding                                          0.0405
VURPHASEAt filling                                          0.3112
VURPHASEAt filling and voiding                              0.2708
PREOPEPISODEn1                                              0.0436
PREOPEPISODEn2                                              0.1899
PREOPEPISODEn≥ 3                                            0.2335
PREOPTYPEUnAfebrile                                         0.0307
PREOPTYPEUnFebrile                                          0.0307
SURGTECHn2≥ 100                                             0.2498
SURGTECHn250 - 100                                          0.0644
SURGTECHn2<50                                               0.1854
GENDERMale                                                  0.0499
GENDERFemale                                                0.0499
UDR7M< 7 mm                                                 0.1407
UDR7M≥ 7mm                                                  0.1407
SURGINDPoor compliance to medical treatment                 0.0086
SURGINDChildren with ineffective or poorly tolerated CAP    0.0463
SURGINDSymptomatic high-grade reflux (III-V)                0.0559
SURGINDRepeated breakthrough UTI                            0.0880
SURGINDGirls with persistent VUR after puberty              0.0047
SURGINDVUR recurrence after endoscopic injection            0.0051
SURGINDReflux nephropathy                                   0.0070
SURGINDPresence of new renal scars on DMSA                  0.0202
SURGINDWorsening in renal function                          0.0109
SURGINDParental preference                                  0.0051
SURGINDPersistent reflux >2 years                           0.0455
                                                         eCDF Max
distance                                                   0.5375
PREOPVURGRADEIII                                           0.0137
PREOPVURGRADEIV                                            0.0816
PREOPVURGRADEV                                             0.0679
HISTOINJNo                                                 0.0203
HISTOINJYes                                                0.0203
BMI                                                        0.3310
AGS                                                        0.2014
PREOPRNPLNNo                                               0.2504
PREOPRNPLNYes                                              0.2504
PREOPRNSCRNo scarring                                      0.2701
PREOPRNSCRAny scarring                                     0.2701
VURSIDELeft                                                0.0226
VURSIDERight                                               0.0226
VURPHASEAt voiding                                         0.0405
VURPHASEAt filling                                         0.3112
VURPHASEAt filling and voiding                             0.2708
PREOPEPISODEn1                                             0.0436
PREOPEPISODEn2                                             0.1899
PREOPEPISODEn≥ 3                                           0.2335
PREOPTYPEUnAfebrile                                        0.0307
PREOPTYPEUnFebrile                                         0.0307
SURGTECHn2≥ 100                                            0.2498
SURGTECHn250 - 100                                         0.0644
SURGTECHn2<50                                              0.1854
GENDERMale                                                 0.0499
GENDERFemale                                               0.0499
UDR7M< 7 mm                                                0.1407
UDR7M≥ 7mm                                                 0.1407
SURGINDPoor compliance to medical treatment                0.0086
SURGINDChildren with ineffective or poorly tolerated CAP   0.0463
SURGINDSymptomatic high-grade reflux (III-V)               0.0559
SURGINDRepeated breakthrough UTI                           0.0880
SURGINDGirls with persistent VUR after puberty             0.0047
SURGINDVUR recurrence after endoscopic injection           0.0051
SURGINDReflux nephropathy                                  0.0070
SURGINDPresence of new renal scars on DMSA                 0.0202
SURGINDWorsening in renal function                         0.0109
SURGINDParental preference                                 0.0051
SURGINDPersistent reflux >2 years                          0.0455

Summary of Balance for Matched Data:
                                                         Means Treated
distance                                                        0.5601
PREOPVURGRADEIII                                                0.0551
PREOPVURGRADEIV                                                 0.3622
PREOPVURGRADEV                                                  0.5827
HISTOINJNo                                                      0.8740
HISTOINJYes                                                     0.1260
BMI                                                            15.4328
AGS                                                             7.5039
PREOPRNPLNNo                                                    0.8425
PREOPRNPLNYes                                                   0.1575
PREOPRNSCRNo scarring                                           0.7244
PREOPRNSCRAny scarring                                          0.2756
VURSIDELeft                                                     0.3780
VURSIDERight                                                    0.6220
VURPHASEAt voiding                                              0.7323
VURPHASEAt filling                                              0.0236
VURPHASEAt filling and voiding                                  0.2441
PREOPEPISODEn1                                                  0.0472
PREOPEPISODEn2                                                  0.2520
PREOPEPISODEn≥ 3                                                0.7008
PREOPTYPEUnAfebrile                                             0.0079
PREOPTYPEUnFebrile                                              0.9921
SURGTECHn2≥ 100                                                 0.1102
SURGTECHn250 - 100                                              0.8189
SURGTECHn2<50                                                   0.0709
GENDERMale                                                      0.5669
GENDERFemale                                                    0.4331
UDR7M< 7 mm                                                     0.3150
UDR7M≥ 7mm                                                      0.6850
SURGINDPoor compliance to medical treatment                     0.0551
SURGINDChildren with ineffective or poorly tolerated CAP        0.0157
SURGINDSymptomatic high-grade reflux (III-V)                    0.4252
SURGINDRepeated breakthrough UTI                                0.4567
SURGINDGirls with persistent VUR after puberty                  0.0079
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0315
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0079
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Means Control
distance                                                        0.4582
PREOPVURGRADEIII                                                0.0709
PREOPVURGRADEIV                                                 0.2756
PREOPVURGRADEV                                                  0.6535
HISTOINJNo                                                      0.8740
HISTOINJYes                                                     0.1260
BMI                                                            15.9707
AGS                                                             7.3575
PREOPRNPLNNo                                                    0.7638
PREOPRNPLNYes                                                   0.2362
PREOPRNSCRNo scarring                                           0.6693
PREOPRNSCRAny scarring                                          0.3307
VURSIDELeft                                                     0.3858
VURSIDERight                                                    0.6142
VURPHASEAt voiding                                              0.6929
VURPHASEAt filling                                              0.0079
VURPHASEAt filling and voiding                                  0.2992
PREOPEPISODEn1                                                  0.0551
PREOPEPISODEn2                                                  0.3071
PREOPEPISODEn≥ 3                                                0.6378
PREOPTYPEUnAfebrile                                             0.0157
PREOPTYPEUnFebrile                                              0.9843
SURGTECHn2≥ 100                                                 0.1024
SURGTECHn250 - 100                                              0.7638
SURGTECHn2<50                                                   0.1339
GENDERMale                                                      0.5433
GENDERFemale                                                    0.4567
UDR7M< 7 mm                                                     0.2126
UDR7M≥ 7mm                                                      0.7874
SURGINDPoor compliance to medical treatment                     0.0551
SURGINDChildren with ineffective or poorly tolerated CAP        0.0079
SURGINDSymptomatic high-grade reflux (III-V)                    0.4016
SURGINDRepeated breakthrough UTI                                0.4803
SURGINDGirls with persistent VUR after puberty                  0.0000
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0394
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0157
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Std. Mean Diff.
distance                                                          0.4011
PREOPVURGRADEIII                                                 -0.0786
PREOPVURGRADEIV                                                   0.1823
PREOPVURGRADEV                                                   -0.1456
HISTOINJNo                                                        0.0000
HISTOINJYes                                                       0.0000
BMI                                                              -0.2084
AGS                                                               0.0656
PREOPRNPLNNo                                                      0.2711
PREOPRNPLNYes                                                    -0.2711
PREOPRNSCRNo scarring                                             0.1366
PREOPRNSCRAny scarring                                           -0.1366
VURSIDELeft                                                      -0.0162
VURSIDERight                                                      0.0162
VURPHASEAt voiding                                                0.0789
VURPHASEAt filling                                                0.0339
VURPHASEAt filling and voiding                                   -0.1529
PREOPEPISODEn1                                                   -0.0416
PREOPEPISODEn2                                                   -0.1529
PREOPEPISODEn≥ 3                                                  0.1603
PREOPTYPEUnAfebrile                                              -0.1157
PREOPTYPEUnFebrile                                                0.1157
SURGTECHn2≥ 100                                                   0.0168
SURGTECHn250 - 100                                                0.1143
SURGTECHn2<50                                                    -0.3145
GENDERMale                                                        0.0481
GENDERFemale                                                     -0.0481
UDR7M< 7 mm                                                       0.2229
UDR7M≥ 7mm                                                       -0.2229
SURGINDPoor compliance to medical treatment                       0.0000
SURGINDChildren with ineffective or poorly tolerated CAP          0.0820
SURGINDSymptomatic high-grade reflux (III-V)                      0.0496
SURGINDRepeated breakthrough UTI                                 -0.0476
SURGINDGirls with persistent VUR after puberty                    0.1157
SURGINDVUR recurrence after endoscopic injection                  0.0000
SURGINDReflux nephropathy                                        -0.0522
SURGINDPresence of new renal scars on DMSA                        0.0000
SURGINDWorsening in renal function                               -0.0820
SURGINDParental preference                                        0.0000
SURGINDPersistent reflux >2 years                                 0.0000
                                                         Var. Ratio
distance                                                     1.3787
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                          0.7659
AGS                                                          0.7608
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                    0.1102
PREOPVURGRADEIII                                            0.0157
PREOPVURGRADEIV                                             0.0866
PREOPVURGRADEV                                              0.0709
HISTOINJNo                                                  0.0000
HISTOINJYes                                                 0.0000
BMI                                                         0.0622
AGS                                                         0.0379
PREOPRNPLNNo                                                0.0787
PREOPRNPLNYes                                               0.0787
PREOPRNSCRNo scarring                                       0.0551
PREOPRNSCRAny scarring                                      0.0551
VURSIDELeft                                                 0.0079
VURSIDERight                                                0.0079
VURPHASEAt voiding                                          0.0394
VURPHASEAt filling                                          0.0157
VURPHASEAt filling and voiding                              0.0551
PREOPEPISODEn1                                              0.0079
PREOPEPISODEn2                                              0.0551
PREOPEPISODEn≥ 3                                            0.0630
PREOPTYPEUnAfebrile                                         0.0079
PREOPTYPEUnFebrile                                          0.0079
SURGTECHn2≥ 100                                             0.0079
SURGTECHn250 - 100                                          0.0551
SURGTECHn2<50                                               0.0630
GENDERMale                                                  0.0236
GENDERFemale                                                0.0236
UDR7M< 7 mm                                                 0.1024
UDR7M≥ 7mm                                                  0.1024
SURGINDPoor compliance to medical treatment                 0.0000
SURGINDChildren with ineffective or poorly tolerated CAP    0.0079
SURGINDSymptomatic high-grade reflux (III-V)                0.0236
SURGINDRepeated breakthrough UTI                            0.0236
SURGINDGirls with persistent VUR after puberty              0.0079
SURGINDVUR recurrence after endoscopic injection            0.0000
SURGINDReflux nephropathy                                   0.0079
SURGINDPresence of new renal scars on DMSA                  0.0000
SURGINDWorsening in renal function                          0.0079
SURGINDParental preference                                  0.0000
SURGINDPersistent reflux >2 years                           0.0000
                                                         eCDF Max
distance                                                   0.2992
PREOPVURGRADEIII                                           0.0157
PREOPVURGRADEIV                                            0.0866
PREOPVURGRADEV                                             0.0709
HISTOINJNo                                                 0.0000
HISTOINJYes                                                0.0000
BMI                                                        0.1732
AGS                                                        0.1181
PREOPRNPLNNo                                               0.0787
PREOPRNPLNYes                                              0.0787
PREOPRNSCRNo scarring                                      0.0551
PREOPRNSCRAny scarring                                     0.0551
VURSIDELeft                                                0.0079
VURSIDERight                                               0.0079
VURPHASEAt voiding                                         0.0394
VURPHASEAt filling                                         0.0157
VURPHASEAt filling and voiding                             0.0551
PREOPEPISODEn1                                             0.0079
PREOPEPISODEn2                                             0.0551
PREOPEPISODEn≥ 3                                           0.0630
PREOPTYPEUnAfebrile                                        0.0079
PREOPTYPEUnFebrile                                         0.0079
SURGTECHn2≥ 100                                            0.0079
SURGTECHn250 - 100                                         0.0551
SURGTECHn2<50                                              0.0630
GENDERMale                                                 0.0236
GENDERFemale                                               0.0236
UDR7M< 7 mm                                                0.1024
UDR7M≥ 7mm                                                 0.1024
SURGINDPoor compliance to medical treatment                0.0000
SURGINDChildren with ineffective or poorly tolerated CAP   0.0079
SURGINDSymptomatic high-grade reflux (III-V)               0.0236
SURGINDRepeated breakthrough UTI                           0.0236
SURGINDGirls with persistent VUR after puberty             0.0079
SURGINDVUR recurrence after endoscopic injection           0.0000
SURGINDReflux nephropathy                                  0.0079
SURGINDPresence of new renal scars on DMSA                 0.0000
SURGINDWorsening in renal function                         0.0079
SURGINDParental preference                                 0.0000
SURGINDPersistent reflux >2 years                          0.0000
                                                         Std. Pair Dist.
distance                                                          0.4013
PREOPVURGRADEIII                                                  0.6291
PREOPVURGRADEIV                                                   0.8784
PREOPVURGRADEV                                                    0.9219
HISTOINJNo                                                        0.2520
HISTOINJYes                                                       0.2520
BMI                                                               1.2533
AGS                                                               1.2928
PREOPRNPLNNo                                                      0.7590
PREOPRNPLNYes                                                     0.7590
PREOPRNSCRNo scarring                                             1.1125
PREOPRNSCRAny scarring                                            1.1125
VURSIDELeft                                                       0.7295
VURSIDERight                                                      0.7295
VURPHASEAt voiding                                                0.8046
VURPHASEAt filling                                                0.0677
VURPHASEAt filling and voiding                                    1.0704
PREOPEPISODEn1                                                    0.4576
PREOPEPISODEn2                                                    1.2014
PREOPEPISODEn≥ 3                                                  1.1224
PREOPTYPEUnAfebrile                                               0.3472
PREOPTYPEUnFebrile                                                0.3472
SURGTECHn2≥ 100                                                   0.3865
SURGTECHn250 - 100                                                0.6370
SURGTECHn2<50                                                     0.6291
GENDERMale                                                        0.9144
GENDERFemale                                                      0.9144
UDR7M< 7 mm                                                       0.8401
UDR7M≥ 7mm                                                        0.8401
SURGINDPoor compliance to medical treatment                       0.0945
SURGINDChildren with ineffective or poorly tolerated CAP          0.2461
SURGINDSymptomatic high-grade reflux (III-V)                      0.9087
SURGINDRepeated breakthrough UTI                                  1.0318
SURGINDGirls with persistent VUR after puberty                    0.1157
SURGINDVUR recurrence after endoscopic injection                  0.0000
SURGINDReflux nephropathy                                         0.4702
SURGINDPresence of new renal scars on DMSA                        0.0000
SURGINDWorsening in renal function                                0.2461
SURGINDParental preference                                        0.0000
SURGINDPersistent reflux >2 years                                 0.0000

Sample Sizes:
          Control Treated
All           198     215
Matched       127     127
Unmatched      71      88
Discarded       0       0

> 
> # Extract the matched dataset from the matchit object
> mdata <- match.data(m.out)
> mdata$BLDCOMPRETN <- ifelse(mdata$BLDCOMPRETN == "Yes", 1, 0)
> mdata$BLDSPASM <- ifelse(mdata$BLDSPASM == "Yes", 1, 0)
> mdata$HEMAT <- ifelse(mdata$HEMAT == "Yes", 1, 0)
> mdata$UTIpostop <- ifelse(mdata$UTIpostop == "UTI", 1, 0)
> mdata$BLDCOMPVOID <- ifelse(mdata$BLDCOMPVOID == "Yes", 1, 0)
> mdata$BLDCOMPLEAK <- ifelse(mdata$BLDCOMPLEAK == "Yes", 1, 0)
> mdata$URCOMPOBST <- ifelse(mdata$URCOMPOBST == "Yes", 1, 0)
> mdata$URCOMPINJ <- ifelse(mdata$URCOMPINJ == "Yes", 1, 0)
> mdata$URCOMPSTEN <- ifelse(mdata$URCOMPSTEN == "Yes", 1, 0)
> mdata$INCCOMPBLEED <- ifelse(mdata$INCCOMPBLEED == "Yes", 1, 0)
> mdata$INCCOMPINF <- ifelse(mdata$INCCOMPINF == "Yes", 1, 0)
> mdata$INCCOMPSCAR <- ifelse(mdata$INCCOMPSCAR == "Yes", 1, 0)
> mdata$ILEUS <- ifelse(mdata$ILEUS == "Yes", 1, 0)
> mdata$ANASTOMO <- ifelse(mdata$ANASTOMO == "Yes", 1, 0)
> mdata$URCOMPCVUR <- ifelse(mdata$URCOMPCVUR == "Yes", 1, 0)
> mdata$GU30 <- ifelse(mdata$GU30 == "Yes", 1, 0)
> mdata$GU90 <- ifelse(mdata$GU90 == "Yes", 1, 0)
> mdata$GUER30 <- ifelse(mdata$GUER30 == "Yes", 1, 0)
> mdata$GUER90 <- ifelse(mdata$GUER90 == "Yes", 1, 0)
> mdata$PROC365 <- ifelse(mdata$PROC365 == "Yes", 1, 0)
> 


 
9.1 BLDCOMPRETN
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'BLDCOMPRETN'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'BLDCOMPRETN']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    1    0
  [4,]    0    0
  [5,]    0    0
  [6,]    1    0
  [7,]    0    0
  [8,]    1    0
  [9,]    1    0
 [10,]    1    1
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    1
 [16,]    0    0
 [17,]    1    0
 [18,]    1    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    1    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    1    0
 [33,]    0    0
 [34,]    1    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    1
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    1
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    1
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    1    0
 [68,]    0    1
 [69,]   NA   NA
 [70,]    0    1
 [71,]    1    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    1    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    1    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    1    0
[106,]    0    0
[107,]    0    0
[108,]    1    0
[109,]    0    0
[110,]   NA   NA
[111,]    1    0
[112,]    1    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    1
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    1
[131,]    0    1
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    1
[136,]    0    0
[137,]    0    1
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    1
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    1    1
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    1    0
  [3,]    0    0
  [4,]    0    0
  [5,]    1    0
  [6,]    0    0
  [7,]    1    0
  [8,]    1    0
  [9,]    1    1
 [10,]    0    0
 [11,]    0    1
 [12,]    0    0
 [13,]    1    0
 [14,]    1    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    1
 [18,]    1    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]    1    0
 [27,]    0    0
 [28,]    1    0
 [29,]    0    0
 [30,]    0    1
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    1
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    1
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    1    0
 [54,]    0    1
 [55,]    0    1
 [56,]    1    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    1    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    1    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    1
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    0
 [80,]    1    0
 [81,]    0    0
 [82,]    0    0
 [83,]    1    0
 [84,]    0    0
 [85,]    1    0
 [86,]    1    0
 [87,]    0    0
 [88,]    0    1
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    1
 [98,]    0    1
 [99,]    0    0
[100,]    0    0
[101,]    0    1
[102,]    0    0
[103,]    0    1
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    1
[117,]    0    0
[118,]    0    0
[119,]    1    1
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 14
> print(y) 
[1] 17
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.2366 

 Gamma Lower bound Upper bound
     1     0.23656     0.23656
     3     0.00009     0.98847
     5     0.00000     0.99980
     7     0.00000     0.99999
     9     0.00000     1.00000
    11     0.00000     1.00000
    13     0.00000     1.00000
    15     0.00000     1.00000

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.2 URCOMPOBST
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'URCOMPOBST'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'URCOMPOBST']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    1    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    1    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    1    0
 [28,]    0    0
 [29,]    1    0
 [30,]    0    0
 [31,]    0    0
 [32,]    1    0
 [33,]    0    0
 [34,]    0    0
 [35,]    1   NA
 [36,]    0    1
 [37,]    1    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    1    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    1    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    1    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    1    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    1    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    1    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    1    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    1    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    1    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    1    0
 [22,]    0    0
 [23,]    1    0
 [24,]    0    0
 [25,]    0    0
 [26,]    1    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    1
 [30,]    1    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    1    0
 [44,]    0    0
 [45,]    0    0
 [46,]    1    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    1    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    1    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    1    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    1    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    1    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 1
> print(y) 
[1] 13
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  1e-04 

 Gamma Lower bound Upper bound
     1       6e-05     0.00006
     3       0e+00     0.01782
     5       0e+00     0.07789
     7       0e+00     0.15421
     9       0e+00     0.22877
    11       0e+00     0.29577
    13       0e+00     0.35434
    15       0e+00     0.40513

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.3 ILEUS
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'ILEUS'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'ILEUS']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    1
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    1
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    1
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    1    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    1    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    1
 [65,]    0    1
 [66,]    0    0
 [67,]    0    1
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    1    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    1
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    1    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    1
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    1
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    1
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    1
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    1
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    1
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    1
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    1
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    1    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    1    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    1
 [51,]    0    1
 [52,]    0    0
 [53,]    0    1
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    1    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    1
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    1
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    1    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    1
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    1
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]    0    1
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    1
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    1
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 14
> print(y) 
[1] 4
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.0038 

 Gamma Lower bound Upper bound
     1     0.00377     0.00377
     3     0.00000     0.30569
     5     0.00000     0.64785
     7     0.00000     0.82014
     9     0.00000     0.90180
    11     0.00000     0.94267
    13     0.00000     0.96453
    15     0.00000     0.97698

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>


 
9.4 URCOMPCVUR
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'URCOMPCVUR'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'URCOMPCVUR']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    1
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0   NA
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0   NA
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    1    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0   NA
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    1
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    1
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0   NA
 [74,]    0    0
 [75,]    0    0
 [76,]    0    1
 [77,]   NA   NA
 [78,]    0   NA
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0   NA
 [87,]    0   NA
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0   NA
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0   NA
[106,]    0   NA
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]   NA    0
[121,]   NA    0
[122,]   NA   NA
[123,]   NA    0
[124,]   NA    0
[125,]   NA    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    1
[156,]    0   NA
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    1    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    1
 [42,]    0    0
 [43,]    0    0
 [44,]    0    1
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    1
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    1
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
attr(,"na.action")
  [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
 [18]  93  94  98 100 101 102 104 110 113 114 117 118 119 120 121 122 123
 [35] 124 125 126 128 132 138 143 144 147 149 150 154 157 158 159 160 162
 [52] 163 164 165 166 167 168 170 171 173 174 175 176 177 178 179 181 184
 [69] 185 186 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203
 [86] 204 207 208 209 210 211 212 213  34  35  40  53  73  78  86  87  91
[103] 105 106 156
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 5
> print(y) 
[1] 1
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.0156 

 Gamma Lower bound Upper bound
     1     0.01562     0.01562
     3     0.00024     0.17798
     5     0.00002     0.33490
     7     0.00000     0.44880
     9     0.00000     0.53144
    11     0.00000     0.59329
    13     0.00000     0.64105
    15     0.00000     0.67893

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.5 URCOMPINJ
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'URCOMPINJ'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'URCOMPINJ']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    1
 [29,]    0    1
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    1
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    1    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    1
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    1
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    1    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    1
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 4
> print(y) 
[1] 1
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.0312 

 Gamma Lower bound Upper bound
     1     0.03125     0.03125
     3     0.00098     0.23730
     5     0.00013     0.40188
     7     0.00003     0.51291
     9     0.00001     0.59049
    11     0.00000     0.64723
    13     0.00000     0.69036
    15     0.00000     0.72420

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.6 INCCOMPINF
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'INCCOMPINF'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'INCCOMPINF']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    1    0
  [7,]    0    0
  [8,]    0    0
  [9,]    1    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    1
 [15,]    0    0
 [16,]    0    0
 [17,]    1    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    1
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    1    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    1
 [47,]    0    0
 [48,]    0    1
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    1
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    1
 [57,]    1    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    1
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    1
 [67,]    0    0
 [68,]    1    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    1    0
 [81,]    0    1
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    1    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    1    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    1
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    1
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    1    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    1
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    1
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    1
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    1
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    1
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    1    0
  [6,]    0    0
  [7,]    0    0
  [8,]    1    0
  [9,]    0    0
 [10,]    0    1
 [11,]    0    0
 [12,]    0    0
 [13,]    1    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    1
 [18,]    0    1
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    1
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    1    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    1
 [36,]    0    0
 [37,]    0    1
 [38,]    0    0
 [39,]    0    1
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    1
 [44,]    1    0
 [45,]    0    0
 [46,]    0    1
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    1
 [53,]    0    0
 [54,]    1    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    1    0
 [65,]    0    1
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    1    0
 [75,]    0    0
 [76,]    1    0
 [77,]    0    0
 [78,]    0    1
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    1
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    1    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    1
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    1
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    1
[118,]    0    0
[119,]    0    1
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    1
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 18
> print(y) 
[1] 10
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.0436 

 Gamma Lower bound Upper bound
     1     0.04358     0.04358
     3     0.00000     0.86155
     5     0.00000     0.98819
     7     0.00000     0.99857
     9     0.00000     0.99976
    11     0.00000     0.99995
    13     0.00000     0.99999
    15     0.00000     1.00000

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.7 INCCOMPBLEED
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'INCCOMPBLEED'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'INCCOMPBLEED']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]   NA   NA
  [3,]    1    0
  [4,]    0    0
  [5,]    0    1
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    1
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    1    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    1    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    1
 [25,]    0    0
 [26,]   NA   NA
 [27,]    1    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    1
 [32,]    0    1
 [33,]    0    1
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    1    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    1
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    1    1
 [48,]    1    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    1    1
 [59,]   NA   NA
 [60,]    1    0
 [61,]    0    0
 [62,]    1    0
 [63,]    1    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    1
 [71,]    0    0
 [72,]    1    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    1    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    1    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    1    0
 [85,]    1    1
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    1
 [90,]    1    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    1
[104,]   NA   NA
[105,]    0    0
[106,]    1    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    1    0
[116,]    1    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    1
[128,]   NA   NA
[129,]    0    1
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    1
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    1
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]    1    0
  [3,]    0    0
  [4,]    0    1
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    1
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    1    0
 [15,]    0    0
 [16,]    1    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    1
 [20,]    0    0
 [21,]    1    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    1
 [26,]    0    1
 [27,]    0    1
 [28,]    0    0
 [29,]    0    0
 [30,]    1    0
 [31,]    0    0
 [32,]    0    1
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    1    1
 [37,]    1    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    1    1
 [46,]    1    0
 [47,]    0    0
 [48,]    1    0
 [49,]    1    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    1
 [56,]    0    0
 [57,]    1    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    1    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    1    0
 [66,]    0    0
 [67,]    1    0
 [68,]    1    1
 [69,]    0    0
 [70,]    0    0
 [71,]    0    1
 [72,]    1    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    1
 [80,]    0    0
 [81,]    1    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    1    0
 [88,]    1    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    1
 [96,]    0    1
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    1
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    1
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 14
> print(y) 
[1] 18
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.1885 

 Gamma Lower bound Upper bound
     1     0.18854     0.18854
     3     0.00004     0.98414
     5     0.00000     0.99971
     7     0.00000     0.99999
     9     0.00000     1.00000
    11     0.00000     1.00000
    13     0.00000     1.00000
    15     0.00000     1.00000

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.8 GU30
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'GU30'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'GU30']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    1
  [6,]    0    0
  [7,]    1    0
  [8,]    0    0
  [9,]    1    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    1
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    1
 [30,]    0    1
 [31,]    0    1
 [32,]    0    1
 [33,]    0    1
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    1
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    1
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]   NA   NA
 [51,]    0    0
 [52,]    1    0
 [53,]    0    0
 [54,]    0    1
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    1
 [58,]    0    0
 [59,]   NA   NA
 [60,]    1    0
 [61,]    0    1
 [62,]    0    1
 [63,]    0    1
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    1    0
 [75,]    0    1
 [76,]    0    1
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]   NA   NA
 [84,]    0    1
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    1
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    1
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    1
[108,]    0    1
[109,]    0    1
[110,]   NA   NA
[111,]    0    0
[112,]    0    1
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    1
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    0
[125,]    0    1
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    1
[130,]    0    1
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    1
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    1
[140,]    0    1
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    1
[146,]    0    1
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    1
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    1
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    1    1
[215,]    1    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    1
  [5,]    0    0
  [6,]    1    0
  [7,]    0    0
  [8,]    1    0
  [9,]    0    0
 [10,]    0    1
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    1
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    1
 [24,]    0    1
 [25,]    0    1
 [26,]    0    1
 [27,]    0    1
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    1
 [33,]    0    0
 [34,]    0    0
 [35,]    0    1
 [36,]    0    1
 [37,]    0    1
 [38,]    0    1
 [39,]    0    0
 [40,]    1    0
 [41,]    0    0
 [42,]    0    1
 [43,]    0    0
 [44,]    0    1
 [45,]    0    0
 [46,]    1    0
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    1    0
 [60,]    0    1
 [61,]    0    1
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    1
 [67,]    0    1
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    1
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    1
 [79,]    0    1
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]    0    1
 [84,]    0    1
 [85,]    0    0
 [86,]    0    1
 [87,]    0    0
 [88,]    0    1
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]    0    0
 [94,]    0    1
 [95,]    0    0
 [96,]    0    1
 [97,]    0    1
 [98,]    0    0
 [99,]    0    0
[100,]    0    1
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    1
[105,]    0    1
[106,]    0    0
[107,]    0    0
[108,]    0    1
[109,]    0    1
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    1
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    1
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    1    1
[127,]    1    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 41
> print(y) 
[1] 6
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0 

 Gamma Lower bound Upper bound
     1           0     0.00000
     3           0     0.01242
     5           0     0.18221
     7           0     0.45633
     9           0     0.67143
    11           0     0.80547
    13           0     0.88357
    15           0     0.92871

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.9 GU90
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'GU90'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'GU90']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    1
  [2,]   NA   NA
  [3,]    1    0
  [4,]    1    0
  [5,]    0    0
  [6,]    1    1
  [7,]    1    0
  [8,]    0    1
  [9,]    1    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    1
 [15,]    0    0
 [16,]    0    1
 [17,]    1    1
 [18,]    0    1
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    1
 [28,]    0    0
 [29,]    1    1
 [30,]    0    1
 [31,]    0    1
 [32,]    0    1
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    1
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    1
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    1
 [45,]    0    1
 [46,]    0    1
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]   NA   NA
 [51,]    1    0
 [52,]    1    0
 [53,]    0    0
 [54,]    0    1
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    1
 [58,]    0    0
 [59,]   NA   NA
 [60,]    1    1
 [61,]    0    1
 [62,]    0    1
 [63,]    0    1
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    1
 [72,]    0    0
 [73,]    0    0
 [74,]    1    0
 [75,]    0    1
 [76,]    0    1
 [77,]   NA   NA
 [78,]    0    0
 [79,]    1    1
 [80,]    0    1
 [81,]    0    1
 [82,]    0    1
 [83,]   NA   NA
 [84,]    0    1
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    1    1
 [91,]    0    0
 [92,]    0    1
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    1
 [96,]    0    1
 [97,]    0    1
 [98,]   NA   NA
 [99,]    0    1
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    1
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    1
[108,]    0    1
[109,]    0    1
[110,]   NA   NA
[111,]    0    0
[112,]    0    1
[113,]   NA   NA
[114,]   NA   NA
[115,]    1    0
[116,]    0    1
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    1
[121,]    0    1
[122,]    0    0
[123,]    0    1
[124,]    0    0
[125,]    0    1
[126,]   NA   NA
[127,]    1    0
[128,]   NA   NA
[129,]    1    1
[130,]    1    1
[131,]    0    1
[132,]   NA   NA
[133,]    1    1
[134,]    1    1
[135,]    1    0
[136,]    1    1
[137,]    1    1
[138,]   NA   NA
[139,]    1    1
[140,]    1    1
[141,]    1    1
[142,]    1    1
[143,]   NA   NA
[144,]   NA   NA
[145,]    1    1
[146,]    1    1
[147,]   NA   NA
[148,]    1    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    1    1
[152,]    1    1
[153,]    1    0
[154,]   NA   NA
[155,]    1    1
[156,]    1    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    1
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    1
[181,]   NA   NA
[182,]    0    1
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    1    1
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    1
  [2,]    1    0
  [3,]    1    0
  [4,]    0    0
  [5,]    1    1
  [6,]    1    0
  [7,]    0    1
  [8,]    1    0
  [9,]    0    0
 [10,]    0    1
 [11,]    0    0
 [12,]    0    1
 [13,]    1    1
 [14,]    0    1
 [15,]    0    0
 [16,]    0    0
 [17,]    0    1
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    1
 [22,]    0    0
 [23,]    1    1
 [24,]    0    1
 [25,]    0    1
 [26,]    0    1
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    1
 [31,]    0    0
 [32,]    0    1
 [33,]    0    1
 [34,]    0    1
 [35,]    0    1
 [36,]    0    1
 [37,]    0    1
 [38,]    0    1
 [39,]    1    0
 [40,]    1    0
 [41,]    0    0
 [42,]    0    1
 [43,]    0    0
 [44,]    0    1
 [45,]    0    0
 [46,]    1    1
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    1
 [57,]    0    0
 [58,]    0    0
 [59,]    1    0
 [60,]    0    1
 [61,]    0    1
 [62,]    0    0
 [63,]    1    1
 [64,]    0    1
 [65,]    0    1
 [66,]    0    1
 [67,]    0    1
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    1    1
 [73,]    0    0
 [74,]    0    1
 [75,]    0    1
 [76,]    0    1
 [77,]    0    1
 [78,]    0    1
 [79,]    0    1
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]    0    1
 [84,]    0    1
 [85,]    0    0
 [86,]    0    1
 [87,]    1    0
 [88,]    0    1
 [89,]    0    1
 [90,]    0    1
 [91,]    0    0
 [92,]    0    1
 [93,]    0    0
 [94,]    0    1
 [95,]    1    0
 [96,]    1    1
 [97,]    1    1
 [98,]    0    1
 [99,]    1    1
[100,]    1    1
[101,]    1    0
[102,]    1    1
[103,]    1    1
[104,]    1    1
[105,]    1    1
[106,]    1    1
[107,]    1    1
[108,]    1    1
[109,]    1    1
[110,]    1    0
[111,]    1    1
[112,]    1    1
[113,]    1    0
[114,]    1    1
[115,]    1    0
[116,]    0    0
[117,]    0    0
[118,]    0    1
[119,]    0    1
[120,]    0    1
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    1    1
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 49
> print(y) 
[1] 13
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0 

 Gamma Lower bound Upper bound
     1           0     0.00000
     3           0     0.19096
     5           0     0.77512
     7           0     0.95906
     9           0     0.99243
    11           0     0.99842
    13           0     0.99962
    15           0     0.99990

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.10 GUER30
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'GUER30'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'GUER30']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    1
  [6,]    0    0
  [7,]    1    1
  [8,]    0    0
  [9,]    1    1
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    1
 [15,]    0    0
 [16,]    0    0
 [17,]    1    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    1
 [29,]    1    1
 [30,]    0    1
 [31,]    0    1
 [32,]    0    1
 [33,]    0    1
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    1
 [37,]    0    1
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    1    1
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    1
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]   NA   NA
 [51,]    0    0
 [52,]    1    1
 [53,]    0    0
 [54,]    0    1
 [55,]   NA   NA
 [56,]    0    1
 [57,]    0    1
 [58,]    0    0
 [59,]   NA   NA
 [60,]    1    0
 [61,]    0    1
 [62,]    0    1
 [63,]    0    1
 [64,]    1    0
 [65,]    0    1
 [66,]    0    1
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    1
 [72,]    0    1
 [73,]    0    0
 [74,]    1    0
 [75,]    0    0
 [76,]    0    1
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]   NA   NA
 [84,]    0    1
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    1
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    1
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    1
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    1    1
[108,]    0    1
[109,]    0    1
[110,]   NA   NA
[111,]    0    1
[112,]    0    1
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    1
[116,]    0    1
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    1
[125,]    0    1
[126,]   NA   NA
[127,]    0    1
[128,]   NA   NA
[129,]    0    1
[130,]    0    1
[131,]    0    1
[132,]   NA   NA
[133,]    0    0
[134,]    0    1
[135,]    0    0
[136,]    0    0
[137,]    0    1
[138,]   NA   NA
[139,]    0    1
[140,]    0    1
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    1
[146,]    0    1
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    1
[154,]   NA   NA
[155,]    0    1
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    1
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    1
[181,]   NA   NA
[182,]    0    0
[183,]    0    1
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    1
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    1    1
[215,]    0    1
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    1
  [5,]    0    0
  [6,]    1    1
  [7,]    0    0
  [8,]    1    1
  [9,]    0    0
 [10,]    0    1
 [11,]    0    0
 [12,]    0    0
 [13,]    1    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    1
 [18,]    0    1
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    1    1
 [24,]    0    1
 [25,]    0    1
 [26,]    0    1
 [27,]    0    1
 [28,]    0    0
 [29,]    0    1
 [30,]    0    1
 [31,]    0    0
 [32,]    1    1
 [33,]    0    0
 [34,]    0    0
 [35,]    0    1
 [36,]    0    1
 [37,]    0    1
 [38,]    0    1
 [39,]    0    0
 [40,]    1    1
 [41,]    0    0
 [42,]    0    1
 [43,]    0    1
 [44,]    0    1
 [45,]    0    0
 [46,]    1    0
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]    1    0
 [51,]    0    1
 [52,]    0    1
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    1
 [57,]    0    1
 [58,]    0    0
 [59,]    1    0
 [60,]    0    0
 [61,]    0    1
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    1
 [67,]    0    1
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    1
 [72,]    0    0
 [73,]    0    0
 [74,]    0    1
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    1
 [79,]    0    1
 [80,]    0    0
 [81,]    0    0
 [82,]    1    1
 [83,]    0    1
 [84,]    0    1
 [85,]    0    1
 [86,]    0    1
 [87,]    0    1
 [88,]    0    1
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]    0    1
 [94,]    0    1
 [95,]    0    1
 [96,]    0    1
 [97,]    0    1
 [98,]    0    1
 [99,]    0    0
[100,]    0    1
[101,]    0    0
[102,]    0    0
[103,]    0    1
[104,]    0    1
[105,]    0    1
[106,]    0    0
[107,]    0    0
[108,]    0    1
[109,]    0    1
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    1
[114,]    0    1
[115,]    0    0
[116,]    0    1
[117,]    0    0
[118,]    0    0
[119,]    0    1
[120,]    0    0
[121,]    0    1
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    1
[126,]    1    1
[127,]    0    1
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 58
> print(y) 
[1] 4
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0 

 Gamma Lower bound Upper bound
     1           0     0.00000
     3           0     0.00003
     5           0     0.00483
     7           0     0.04028
     9           0     0.12098
    11           0     0.23011
    13           0     0.34533
    15           0     0.45257

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.11 GUER90
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'GUER90'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'GUER90']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    1    1
  [5,]    0    0
  [6,]    0    0
  [7,]    1    1
  [8,]    0    0
  [9,]    1    1
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    1
 [15,]    0    0
 [16,]    0    0
 [17,]    1    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    1
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    1    1
 [30,]    0    1
 [31,]    0    1
 [32,]    0    1
 [33,]    0    1
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    1
 [37,]    0    1
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    1
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    1
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]   NA   NA
 [51,]    1    0
 [52,]    1    1
 [53,]    0    0
 [54,]    0    1
 [55,]   NA   NA
 [56,]    0    1
 [57,]    0    1
 [58,]    0    0
 [59,]   NA   NA
 [60,]    1    0
 [61,]    0    1
 [62,]    0    1
 [63,]    0    1
 [64,]    1    0
 [65,]    0    1
 [66,]    0    1
 [67,]    0    0
 [68,]    0    1
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    1
 [72,]    0    1
 [73,]    0    0
 [74,]    1    0
 [75,]    0    0
 [76,]    0    1
 [77,]   NA   NA
 [78,]    0    0
 [79,]    1    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]   NA   NA
 [84,]    0    1
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    1
 [90,]    1    0
 [91,]    1    0
 [92,]    0    1
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    1
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    1
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    1    1
[108,]    0    1
[109,]    0    1
[110,]   NA   NA
[111,]    0    1
[112,]    0    1
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    1
[116,]    0    1
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    1
[125,]    0    1
[126,]   NA   NA
[127,]    0    1
[128,]   NA   NA
[129,]    0    1
[130,]    0    1
[131,]    0    1
[132,]   NA   NA
[133,]    0    0
[134,]    0    1
[135,]    0    0
[136,]    0    1
[137,]    0    1
[138,]   NA   NA
[139,]    0    1
[140,]    0    1
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    1
[146,]    0    1
[147,]   NA   NA
[148,]    0    1
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    1
[154,]   NA   NA
[155,]    0    1
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    1
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    1
[181,]   NA   NA
[182,]    0    0
[183,]    0    1
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    1
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    1    1
[215,]    0    1
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]    0    0
  [3,]    1    1
  [4,]    0    0
  [5,]    0    0
  [6,]    1    1
  [7,]    0    0
  [8,]    1    1
  [9,]    0    0
 [10,]    0    1
 [11,]    0    0
 [12,]    0    0
 [13,]    1    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    1
 [18,]    0    1
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    1    1
 [24,]    0    1
 [25,]    0    1
 [26,]    0    1
 [27,]    0    1
 [28,]    0    0
 [29,]    0    1
 [30,]    0    1
 [31,]    0    0
 [32,]    0    1
 [33,]    0    0
 [34,]    0    0
 [35,]    0    1
 [36,]    0    1
 [37,]    0    1
 [38,]    0    1
 [39,]    1    0
 [40,]    1    1
 [41,]    0    0
 [42,]    0    1
 [43,]    0    1
 [44,]    0    1
 [45,]    0    0
 [46,]    1    0
 [47,]    0    1
 [48,]    0    1
 [49,]    0    1
 [50,]    1    0
 [51,]    0    1
 [52,]    0    1
 [53,]    0    0
 [54,]    0    1
 [55,]    0    0
 [56,]    0    1
 [57,]    0    1
 [58,]    0    0
 [59,]    1    0
 [60,]    0    0
 [61,]    0    1
 [62,]    0    0
 [63,]    1    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    1
 [67,]    0    1
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    1
 [72,]    1    0
 [73,]    1    0
 [74,]    0    1
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    1
 [79,]    0    1
 [80,]    0    0
 [81,]    0    0
 [82,]    1    1
 [83,]    0    1
 [84,]    0    1
 [85,]    0    1
 [86,]    0    1
 [87,]    0    1
 [88,]    0    1
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]    0    1
 [94,]    0    1
 [95,]    0    1
 [96,]    0    1
 [97,]    0    1
 [98,]    0    1
 [99,]    0    0
[100,]    0    1
[101,]    0    0
[102,]    0    1
[103,]    0    1
[104,]    0    1
[105,]    0    1
[106,]    0    0
[107,]    0    0
[108,]    0    1
[109,]    0    1
[110,]    0    1
[111,]    0    0
[112,]    0    0
[113,]    0    1
[114,]    0    1
[115,]    0    0
[116,]    0    1
[117,]    0    0
[118,]    0    0
[119,]    0    1
[120,]    0    0
[121,]    0    1
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    1
[126,]    1    1
[127,]    0    1
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 60
> print(y) 
[1] 9
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0 

 Gamma Lower bound Upper bound
     1           0     0.00000
     3           0     0.00477
     5           0     0.16645
     7           0     0.50030
     9           0     0.74979
    11           0     0.88131
    13           0     0.94353
    15           0     0.97242

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.12 PROC365
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'PROC365'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'PROC365']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    1    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    1    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    1    1
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    1
 [65,]    0    0
 [66,]    0    1
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    1
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    1    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    1    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    1
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    1
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    1    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    1    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    1    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    1    1
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    1
 [51,]    0    0
 [52,]    0    1
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    1
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    1    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    1    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    1
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    1
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    1    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 5
> print(y) 
[1] 5
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.377 

 Gamma Lower bound Upper bound
     1     0.37695     0.37695
     3     0.01973     0.92187
     5     0.00244     0.98454
     7     0.00051     0.99555
     9     0.00015     0.99837
    11     0.00005     0.99929
    13     0.00002     0.99965
    15     0.00001     0.99982

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.13 BLDCOMPVOID
> m.pairs <- cbind(
+     mdata[row.names(m.out$match.matrix), 'BLDCOMPVOID'],  # Replace 'OUTCOME_VAR' with your binary outcome
+     mdata[m.out$match.matrix, 'BLDCOMPVOID']
+ )
> 
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    1
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    1    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    1
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    1    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    1    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    1
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    1
[132,]   NA   NA
[133,]    1    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    1
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    1
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    1    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    1
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    1    0
 [54,]    0    0
 [55,]    0    0
 [56,]    1    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    1
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    1
 [99,]    1    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    1
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 6
> print(y) 
[1] 5
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.2744 

 Gamma Lower bound Upper bound
     1     0.27441     0.27441
     3     0.00756     0.88537
     5     0.00063     0.97549
     7     0.00010     0.99267
     9     0.00002     0.99725
    11     0.00001     0.99879
    13     0.00000     0.99940
    15     0.00000     0.99968

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>


 
9.14 BLDCOMPLEAK
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'BLDCOMPLEAK'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'BLDCOMPLEAK']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    1
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    1    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    1    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    1
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    1    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    1    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 1
> print(y) 
[1] 2
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.125 

 Gamma Lower bound Upper bound
     1     0.12500     0.12500
     3     0.01562     0.42188
     5     0.00463     0.57870
     7     0.00195     0.66992
     9     0.00100     0.72900
    11     0.00058     0.77025
    13     0.00036     0.80066
    15     0.00024     0.82397

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.15 URCOMPSTEN
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'URCOMPSTEN'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'URCOMPSTEN']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    1    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    1    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    1    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    1    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    1    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    1
 [71,]    1    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    1
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    1    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    1
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    1
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    1
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    1    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    1    0
 [10,]    0    0
 [11,]    0    0
 [12,]    1    0
 [13,]    0    0
 [14,]    0    0
 [15,]    1    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    1    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    1    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    1
 [56,]    1    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    1
 [60,]    0    0
 [61,]    0    0
 [62,]    1    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    1
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]    0    0
 [84,]    0    0
 [85,]    0    1
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    1    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 5
> print(y) 
[1] 8
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.1334 

 Gamma Lower bound Upper bound
     1     0.13342     0.13342
     3     0.00099     0.79396
     5     0.00004     0.94885
     7     0.00000     0.98352
     9     0.00000     0.99354
    11     0.00000     0.99708
    13     0.00000     0.99853
    15     0.00000     0.99920

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.16 INCCOMPSCAR
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'INCCOMPSCAR'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'INCCOMPSCAR']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    1
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    1    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    1
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    0
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    1    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 1
> print(y) 
[1] 1
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.25 

 Gamma Lower bound Upper bound
     1     0.25000     0.25000
     3     0.06250     0.56250
     5     0.02778     0.69444
     7     0.01562     0.76563
     9     0.01000     0.81000
    11     0.00694     0.84028
    13     0.00510     0.86224
    15     0.00391     0.87891

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.17 ANASTOMO
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'ANASTOMO'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'ANASTOMO']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    0    0
 [28,]    1    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    1
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    1
[109,]    0    0
[110,]   NA   NA
[111,]    0    0
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    0
[138,]   NA   NA
[139,]    0    0
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    0    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    0    0
  [8,]    0    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    0    0
 [22,]    1    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    0    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    0    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    0    0
 [42,]    0    0
 [43,]    0    0
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    0
 [54,]    0    0
 [55,]    0    1
 [56,]    0    0
 [57,]    0    0
 [58,]    0    0
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    0
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    0
 [83,]    0    1
 [84,]    0    0
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    0
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    0
[104,]    0    0
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    0    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    0
[125,]    0    0
[126,]    0    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 2
> print(y) 
[1] 1
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.125 

 Gamma Lower bound Upper bound
     1     0.12500     0.12500
     3     0.01562     0.42188
     5     0.00463     0.57870
     7     0.00195     0.66992
     9     0.00100     0.72900
    11     0.00058     0.77025
    13     0.00036     0.80066
    15     0.00024     0.82397

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.18 BLDSPASM
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'BLDSPASM'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'BLDSPASM']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    1    1
  [4,]    0    0
  [5,]    0    0
  [6,]    1    0
  [7,]    0    0
  [8,]    1    1
  [9,]    1    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    1
 [15,]    1    1
 [16,]    0    0
 [17,]    1    0
 [18,]    1    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    1    0
 [28,]    1    1
 [29,]    1    0
 [30,]    0    0
 [31,]    1    0
 [32,]    0    0
 [33,]    0    1
 [34,]    1    0
 [35,]    0   NA
 [36,]    1    1
 [37,]    0    1
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    1    0
 [47,]    1    0
 [48,]    1    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    1
 [52,]    1    0
 [53,]    1    1
 [54,]    1    1
 [55,]   NA   NA
 [56,]    0    1
 [57,]    0    1
 [58,]    0    0
 [59,]   NA   NA
 [60,]    1    0
 [61,]    0    1
 [62,]    0    0
 [63,]    1    1
 [64,]    0    0
 [65,]    0    1
 [66,]    0    1
 [67,]    0    0
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    0
 [71,]    1    1
 [72,]    0    1
 [73,]    0    1
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    1    0
 [79,]    0    1
 [80,]    0    0
 [81,]    0    1
 [82,]    0    0
 [83,]   NA   NA
 [84,]    1    1
 [85,]    0    0
 [86,]    0    1
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    0    0
 [91,]    1    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    1    0
 [96,]    1    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    1
[104,]   NA   NA
[105,]    0    0
[106,]    0    1
[107,]    0    0
[108,]    0    1
[109,]    0    1
[110,]   NA   NA
[111,]    1    0
[112,]    0    1
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    1
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    1
[121,]    0    0
[122,]    0    1
[123,]    0    1
[124,]    0    1
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    1    1
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    0
[136,]    0    0
[137,]    0    1
[138,]   NA   NA
[139,]    0    1
[140,]    0    0
[141,]    0    0
[142,]    0    1
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    1
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    1    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    1    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    1
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    1
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    0
[206,]    1    1
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    1    0
[215,]    1    1
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    1    1
  [3,]    0    0
  [4,]    0    0
  [5,]    1    0
  [6,]    0    0
  [7,]    1    1
  [8,]    1    0
  [9,]    0    0
 [10,]    0    1
 [11,]    1    1
 [12,]    0    0
 [13,]    1    0
 [14,]    1    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    1
 [19,]    0    0
 [20,]    0    0
 [21,]    1    0
 [22,]    1    1
 [23,]    1    0
 [24,]    0    0
 [25,]    1    0
 [26,]    0    0
 [27,]    0    1
 [28,]    1    0
 [29,]    1    1
 [30,]    0    1
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    1    0
 [36,]    1    0
 [37,]    1    0
 [38,]    0    0
 [39,]    0    1
 [40,]    1    0
 [41,]    1    1
 [42,]    1    1
 [43,]    0    1
 [44,]    0    1
 [45,]    0    0
 [46,]    1    0
 [47,]    0    1
 [48,]    0    0
 [49,]    1    1
 [50,]    0    0
 [51,]    0    1
 [52,]    0    1
 [53,]    0    0
 [54,]    0    0
 [55,]    0    0
 [56,]    1    1
 [57,]    0    1
 [58,]    0    1
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    1    0
 [63,]    0    1
 [64,]    0    0
 [65,]    0    1
 [66,]    0    0
 [67,]    1    1
 [68,]    0    0
 [69,]    0    1
 [70,]    0    0
 [71,]    0    0
 [72,]    0    0
 [73,]    1    0
 [74,]    0    0
 [75,]    1    0
 [76,]    1    0
 [77,]    0    0
 [78,]    0    0
 [79,]    0    1
 [80,]    0    0
 [81,]    0    1
 [82,]    0    0
 [83,]    0    1
 [84,]    0    1
 [85,]    1    0
 [86,]    0    1
 [87,]    0    1
 [88,]    0    0
 [89,]    0    1
 [90,]    0    0
 [91,]    0    1
 [92,]    0    1
 [93,]    0    1
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    1    1
 [99,]    0    0
[100,]    0    0
[101,]    0    0
[102,]    0    0
[103,]    0    1
[104,]    0    1
[105,]    0    0
[106,]    0    0
[107,]    0    1
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    1
[115,]    0    0
[116,]    1    0
[117,]    0    0
[118,]    1    0
[119,]    0    1
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    0
[125,]    1    1
[126,]    1    0
[127,]    1    1
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 31
> print(y) 
[1] 21
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.0632 

 Gamma Lower bound Upper bound
     1     0.06317     0.06317
     3     0.00000     0.98946
     5     0.00000     0.99996
     7     0.00000     1.00000
     9     0.00000     1.00000
    11     0.00000     1.00000
    13     0.00000     1.00000
    15     0.00000     1.00000

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.19 HEMAT
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'HEMAT'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'HEMAT']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]   NA   NA
  [3,]    1    0
  [4,]    1    0
  [5,]    0    1
  [6,]    1    0
  [7,]    1    0
  [8,]    0    1
  [9,]    1    0
 [10,]    0    0
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    1
 [16,]    0    0
 [17,]    0    0
 [18,]    0    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    1    0
 [23,]    0    0
 [24,]    0    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    1    0
 [28,]    1    1
 [29,]    0    1
 [30,]    0    0
 [31,]    0    0
 [32,]    0    0
 [33,]    1    0
 [34,]    0    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    0    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    1    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    1    0
 [48,]    0    0
 [49,]    0    1
 [50,]   NA   NA
 [51,]    0    1
 [52,]    0    0
 [53,]    0    1
 [54,]    0    0
 [55,]   NA   NA
 [56,]    0    1
 [57,]    0    1
 [58,]    0    1
 [59,]   NA   NA
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    0
 [66,]    0    0
 [67,]    0    1
 [68,]    0    0
 [69,]   NA   NA
 [70,]    0    1
 [71,]    0    0
 [72,]    0    0
 [73,]    0    1
 [74,]    0    0
 [75,]    0    0
 [76,]    0    0
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    0    1
 [82,]    0    0
 [83,]   NA   NA
 [84,]    0    1
 [85,]    0    0
 [86,]    0    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    0
 [90,]    1    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    1    0
 [96,]    1    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    0    0
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    1    1
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    1
[108,]    0    0
[109,]    0    0
[110,]   NA   NA
[111,]    1    0
[112,]    1    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    0    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    1
[121,]    0    0
[122,]    0    0
[123,]    0    0
[124,]    0    1
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    1    1
[132,]   NA   NA
[133,]    0    0
[134,]    0    0
[135,]    0    1
[136,]    0    0
[137,]    0    1
[138,]   NA   NA
[139,]    0    1
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    0
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    1
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    1    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    0
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    0    0
[181,]   NA   NA
[182,]    0    0
[183,]    0    0
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    0    1
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    0    1
[206,]    0    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    1    0
[215,]    0    0
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    0    0
  [2,]    1    0
  [3,]    1    0
  [4,]    0    1
  [5,]    1    0
  [6,]    1    0
  [7,]    0    1
  [8,]    1    0
  [9,]    0    0
 [10,]    0    0
 [11,]    0    1
 [12,]    0    0
 [13,]    0    0
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    1    0
 [18,]    0    0
 [19,]    0    0
 [20,]    0    0
 [21,]    1    0
 [22,]    1    1
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]    0    0
 [27,]    1    0
 [28,]    0    0
 [29,]    0    0
 [30,]    0    0
 [31,]    1    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    1    0
 [37,]    0    0
 [38,]    0    1
 [39,]    0    1
 [40,]    0    0
 [41,]    0    1
 [42,]    0    0
 [43,]    0    1
 [44,]    0    1
 [45,]    0    1
 [46,]    0    0
 [47,]    0    0
 [48,]    0    0
 [49,]    0    0
 [50,]    0    0
 [51,]    0    0
 [52,]    0    0
 [53,]    0    1
 [54,]    0    0
 [55,]    0    1
 [56,]    0    0
 [57,]    0    0
 [58,]    0    1
 [59,]    0    0
 [60,]    0    0
 [61,]    0    0
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    0    1
 [66,]    0    0
 [67,]    0    1
 [68,]    0    0
 [69,]    0    0
 [70,]    0    0
 [71,]    0    0
 [72,]    1    0
 [73,]    0    0
 [74,]    0    0
 [75,]    1    0
 [76,]    1    0
 [77,]    0    0
 [78,]    0    0
 [79,]    1    1
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]    0    0
 [84,]    0    0
 [85,]    1    0
 [86,]    1    0
 [87,]    0    0
 [88,]    0    0
 [89,]    0    1
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]    0    1
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    1    1
 [99,]    0    0
[100,]    0    0
[101,]    0    1
[102,]    0    0
[103,]    0    1
[104,]    0    1
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    0
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    1
[114,]    0    0
[115,]    0    0
[116,]    1    0
[117,]    0    0
[118,]    0    0
[119,]    0    0
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    1
[125,]    0    0
[126,]    1    0
[127,]    0    0
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 24
> print(y) 
[1] 17
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.1055 

 Gamma Lower bound Upper bound
     1     0.10551     0.10551
     3     0.00000     0.98477
     5     0.00000     0.99985
     7     0.00000     1.00000
     9     0.00000     1.00000
    11     0.00000     1.00000
    13     0.00000     1.00000
    15     0.00000     1.00000

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
>

 
9.20 UTIpostop
> 
> m.pairs <- cbind(
+      mdata[row.names(m.out$match.matrix), 'UTIpostop'],  # Replace 'OUTCOME_VAR' with your binary outcome
+      mdata[m.out$match.matrix, 'UTIpostop']
+  )
>  
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]   NA   NA
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    0    0
  [7,]    1    1
  [8,]    0    0
  [9,]    0    0
 [10,]    1    1
 [11,]   NA   NA
 [12,]   NA   NA
 [13,]   NA   NA
 [14,]    0    0
 [15,]    0    0
 [16,]    0    0
 [17,]    1    0
 [18,]    1    0
 [19,]   NA   NA
 [20,]    0    0
 [21,]    0    0
 [22,]    0    0
 [23,]    0    1
 [24,]    1    0
 [25,]    0    0
 [26,]   NA   NA
 [27,]    1    0
 [28,]    1    1
 [29,]    0    1
 [30,]    0    0
 [31,]    0    0
 [32,]    1    1
 [33,]    0    0
 [34,]    1    0
 [35,]    0   NA
 [36,]    0    0
 [37,]    1    0
 [38,]   NA   NA
 [39,]   NA   NA
 [40,]    0    0
 [41,]    0    0
 [42,]   NA   NA
 [43,]   NA   NA
 [44,]    0    0
 [45,]    0    0
 [46,]    0    0
 [47,]    1    0
 [48,]    0    0
 [49,]    0    0
 [50,]   NA   NA
 [51,]    0    0
 [52,]    0    0
 [53,]    1    1
 [54,]    1    0
 [55,]   NA   NA
 [56,]    0    0
 [57,]    1    0
 [58,]    0    1
 [59,]   NA   NA
 [60,]    1    0
 [61,]    0    1
 [62,]    1    1
 [63,]    1    1
 [64,]    0    1
 [65,]    1    1
 [66,]    0    1
 [67,]    0    1
 [68,]    1    1
 [69,]   NA   NA
 [70,]    1    1
 [71,]    0    0
 [72,]    0    1
 [73,]    0    0
 [74,]    0    1
 [75,]    1    1
 [76,]    0    1
 [77,]   NA   NA
 [78,]    0    0
 [79,]    0    0
 [80,]    0    0
 [81,]    1    0
 [82,]    1    0
 [83,]   NA   NA
 [84,]    0    1
 [85,]    0    1
 [86,]    1    0
 [87,]    0    0
 [88,]   NA   NA
 [89,]    0    1
 [90,]    0    0
 [91,]    0    0
 [92,]    0    0
 [93,]   NA   NA
 [94,]   NA   NA
 [95,]    1    0
 [96,]    0    0
 [97,]    0    0
 [98,]   NA   NA
 [99,]    1    1
[100,]   NA   NA
[101,]   NA   NA
[102,]   NA   NA
[103,]    0    0
[104,]   NA   NA
[105,]    0    0
[106,]    0    0
[107,]    0    1
[108,]    0    0
[109,]    1    0
[110,]   NA   NA
[111,]    0    1
[112,]    0    0
[113,]   NA   NA
[114,]   NA   NA
[115,]    0    0
[116,]    1    0
[117,]   NA   NA
[118,]   NA   NA
[119,]   NA   NA
[120,]    0    0
[121,]    0    0
[122,]    0    0
[123,]    0    1
[124,]    0    1
[125,]    0    0
[126,]   NA   NA
[127,]    0    0
[128,]   NA   NA
[129,]    0    0
[130,]    0    0
[131,]    0    0
[132,]   NA   NA
[133,]    0    0
[134,]    0    1
[135,]    0    1
[136,]    0    1
[137,]    0    0
[138,]   NA   NA
[139,]    0    1
[140,]    0    0
[141,]    0    0
[142,]    0    0
[143,]   NA   NA
[144,]   NA   NA
[145,]    0    1
[146,]    0    0
[147,]   NA   NA
[148,]    0    0
[149,]   NA   NA
[150,]   NA   NA
[151,]    0    0
[152,]    0    0
[153,]    0    0
[154,]   NA   NA
[155,]    0    0
[156,]    0    0
[157,]   NA   NA
[158,]   NA   NA
[159,]   NA   NA
[160,]   NA   NA
[161,]    1    0
[162,]   NA   NA
[163,]   NA   NA
[164,]   NA   NA
[165,]   NA   NA
[166,]   NA   NA
[167,]   NA   NA
[168,]   NA   NA
[169,]    0    1
[170,]   NA   NA
[171,]   NA   NA
[172,]    0    0
[173,]   NA   NA
[174,]   NA   NA
[175,]   NA   NA
[176,]   NA   NA
[177,]   NA   NA
[178,]   NA   NA
[179,]   NA   NA
[180,]    1    0
[181,]   NA   NA
[182,]    0    0
[183,]    1    1
[184,]   NA   NA
[185,]   NA   NA
[186,]   NA   NA
[187,]    0    0
[188,]    1    0
[189,]   NA   NA
[190,]   NA   NA
[191,]   NA   NA
[192,]   NA   NA
[193,]   NA   NA
[194,]   NA   NA
[195,]   NA   NA
[196,]   NA   NA
[197,]   NA   NA
[198,]   NA   NA
[199,]   NA   NA
[200,]   NA   NA
[201,]   NA   NA
[202,]   NA   NA
[203,]   NA   NA
[204,]   NA   NA
[205,]    1    0
[206,]    1    0
[207,]   NA   NA
[208,]   NA   NA
[209,]   NA   NA
[210,]   NA   NA
[211,]   NA   NA
[212,]   NA   NA
[213,]   NA   NA
[214,]    0    0
[215,]    0    1
> 
> m.pairs <- na.omit(m.pairs)
> print(m.pairs)
       [,1] [,2]
  [1,]    1    0
  [2,]    0    0
  [3,]    0    0
  [4,]    0    0
  [5,]    0    0
  [6,]    1    1
  [7,]    0    0
  [8,]    0    0
  [9,]    1    1
 [10,]    0    0
 [11,]    0    0
 [12,]    0    0
 [13,]    1    0
 [14,]    1    0
 [15,]    0    0
 [16,]    0    0
 [17,]    0    0
 [18,]    0    1
 [19,]    1    0
 [20,]    0    0
 [21,]    1    0
 [22,]    1    1
 [23,]    0    1
 [24,]    0    0
 [25,]    0    0
 [26,]    1    1
 [27,]    0    0
 [28,]    1    0
 [29,]    0    0
 [30,]    1    0
 [31,]    0    0
 [32,]    0    0
 [33,]    0    0
 [34,]    0    0
 [35,]    0    0
 [36,]    1    0
 [37,]    0    0
 [38,]    0    0
 [39,]    0    0
 [40,]    0    0
 [41,]    1    1
 [42,]    1    0
 [43,]    0    0
 [44,]    1    0
 [45,]    0    1
 [46,]    1    0
 [47,]    0    1
 [48,]    1    1
 [49,]    1    1
 [50,]    0    1
 [51,]    1    1
 [52,]    0    1
 [53,]    0    1
 [54,]    1    1
 [55,]    1    1
 [56,]    0    0
 [57,]    0    1
 [58,]    0    0
 [59,]    0    1
 [60,]    1    1
 [61,]    0    1
 [62,]    0    0
 [63,]    0    0
 [64,]    0    0
 [65,]    1    0
 [66,]    1    0
 [67,]    0    1
 [68,]    0    1
 [69,]    1    0
 [70,]    0    0
 [71,]    0    1
 [72,]    0    0
 [73,]    0    0
 [74,]    0    0
 [75,]    1    0
 [76,]    0    0
 [77,]    0    0
 [78,]    1    1
 [79,]    0    0
 [80,]    0    0
 [81,]    0    0
 [82,]    0    1
 [83,]    0    0
 [84,]    1    0
 [85,]    0    1
 [86,]    0    0
 [87,]    0    0
 [88,]    1    0
 [89,]    0    0
 [90,]    0    0
 [91,]    0    0
 [92,]    0    1
 [93,]    0    1
 [94,]    0    0
 [95,]    0    0
 [96,]    0    0
 [97,]    0    0
 [98,]    0    0
 [99,]    0    0
[100,]    0    1
[101,]    0    1
[102,]    0    1
[103,]    0    0
[104,]    0    1
[105,]    0    0
[106,]    0    0
[107,]    0    0
[108,]    0    1
[109,]    0    0
[110,]    0    0
[111,]    0    0
[112,]    0    0
[113,]    0    0
[114,]    0    0
[115,]    0    0
[116,]    1    0
[117,]    0    1
[118,]    0    0
[119,]    1    0
[120,]    0    0
[121,]    1    1
[122,]    0    0
[123,]    1    0
[124,]    1    0
[125,]    1    0
[126,]    0    0
[127,]    0    1
attr(,"na.action")
 [1]   2  11  12  13  19  26  38  39  42  43  50  55  59  69  77  83  88
[18]  93  94  98 100 101 102 104 110 113 114 117 118 119 126 128 132 138
[35] 143 144 147 149 150 154 157 158 159 160 162 163 164 165 166 167 168
[52] 170 171 173 174 175 176 177 178 179 181 184 185 186 189 190 191 192
[69] 193 194 195 196 197 198 199 200 201 202 203 204 207 208 209 210 211
[86] 212 213  35
attr(,"class")
[1] "omit"
> 
> 
> x <- sum((m.pairs[, 1] == 0) & (m.pairs[, 2] == 1))
> y <- sum((m.pairs[, 1] == 1) & (m.pairs[, 2] == 0))
> print(x)
[1] 24
> print(y) 
[1] 22
> library(rbounds) 
> primal <- binarysens(x=x, y=y, Gamma = 15, GammaInc = 2)
> print(primal)

 Rosenbaum Sensitivity Test 
 
Unconfounded estimate ....  0.3294 

 Gamma Lower bound Upper bound
     1     0.32937     0.32937
     3     0.00002     0.99932
     5     0.00000     1.00000
     7     0.00000     1.00000
     9     0.00000     1.00000
    11     0.00000     1.00000
    13     0.00000     1.00000
    15     0.00000     1.00000

 Note: Gamma is Odds of Differential Assignment To
 Treatment Due to Unobserved Factors 
 
==================================================================================================
==================================================================================================

10. Secondary outcome: Univariable and multivariable: healthcare burden X postoperative outcomes

> table(data$CLAVIENCLASS)

Clavien grade 1 Clavien grade 2 Clavien grade 3 Clavien grade 4 
            201              83              36               1 
Clavien grade 5 
              1 
> mdata <- mdata %>%
+   mutate(CLAVIENCLASS2 = recode(CLAVIENCLASS, 
+                                `Clavien grade 1` = "Clavien grade 1-2", 
+                                `Clavien grade 2` = "Clavien grade 1-2", 
+                                `Clavien grade 3` = "Clavien grade 3-5", 
+                                `Clavien grade 4` = "Clavien grade 3-5", 
+                                `Clavien grade 5` = "Clavien grade 3-5"))
> 
> # Check the structure of the new variable
> table(mdata$CLAVIENCLASS2)

Clavien grade 1-2 Clavien grade 3-5 
              174                27 
> sum(is.na(mdata$CLAVIENCLASS2))
[1] 53
> sum(is.na(mdata$URCOMPCVUR))
[1] 18





> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(tidyr)

Attaching package: ‘tidyr’

The following objects are masked _by_ ‘.GlobalEnv’:

    table1, table5

> # Drop rows with missing values in the CLAVIENCLASS column
> mdata_clean <- mdata %>% drop_na(CLAVIENCLASS2,URCOMPCVUR)
> sum(is.na(mdata_clean$CLAVIENCLASS2))
[1] 0
> sum(is.na(mdata_clean$URCOMPCVUR))
[1] 0

> # Ensure the type of the dependent variable is numeric
> mdata$GU30 <- ifelse(mdata$GU30 == "Yes", 1, 0)
> mdata$GU90 <- ifelse(mdata$GU90 == "Yes", 1, 0)
> mdata$GUER30 <- ifelse(mdata$GUER30 == "Yes", 1, 0)
> mdata$GUER90 <- ifelse(mdata$GUER90 == "Yes", 1, 0)
> mdata$PROC365 <- ifelse(mdata$PROC365 == "Yes", 1, 0)

> mdata_clean$GU30 <- ifelse(mdata_clean$GU30 == "Yes", 1, 0)
> mdata_clean$GU90 <- ifelse(mdata_clean$GU90 == "Yes", 1, 0)
> mdata_clean$GUER30 <- ifelse(mdata_clean$GUER30 == "Yes", 1, 0)
> mdata_clean$GUER90 <- ifelse(mdata_clean$GUER90 == "Yes", 1, 0)
> mdata_clean$PROC365 <- ifelse(mdata_clean$PROC365 == "Yes", 1, 0)

==================================================================================================

10. A.  Association with: GU30

 
10.A.0 CLAVIENCLASS2

> #NOTE : Use  mdata_clean for the variables: CLAVIENCLASS2

PREOPVURGRADEIV                                                   0.8784
PREOPVURGRADEV                                                    0.9219
HISTOINJNo                                                        0.2520
HISTOINJYes                                                       0.2520
BMI                                                               1.2533
AGS                                                               1.2928
PREOPRNPLNNo                                                      0.7590
PREOPRNPLNYes                                                     0.7590
PREOPRNSCRNo scarring                                             1.1125
PREOPRNSCRAny scarring                                            1.1125
VURSIDELeft                                                       0.7295
VURSIDERight                                                      0.7295
VURPHASEAt voiding                                                0.8046
VURPHASEAt filling                                                0.0677
VURPHASEAt filling and voiding                                    1.0704
PREOPEPISODEn1                                                    0.4576
PREOPEPISODEn2                                                    1.2014
PREOPEPISODEn≥ 3                                                  1.1224
PREOPTYPEUnAfebrile                                               0.3472
PREOPTYPEUnFebrile                                                0.3472
SURGTECHn2≥ 100                                                   0.3865
SURGTECHn250 - 100                                                0.6370
SURGTECHn2<50                                                     0.6291
GENDERMale                                                        0.9144
GENDERFemale                                                      0.9144
UDR7M< 7 mm                                                       0.8401
UDR7M≥ 7mm                                                        0.8401
SURGINDPoor compliance to medical treatment                       0.0945
SURGINDChildren with ineffective or poorly tolerated CAP          0.2461
SURGINDSymptomatic high-grade reflux (III-V)                      0.9087
SURGINDRepeated breakthrough UTI                                  1.0318
SURGINDGirls with persistent VUR after puberty                    0.1157
SURGINDVUR recurrence after endoscopic injection                  0.0000
SURGINDReflux nephropathy                                         0.4702
SURGINDPresence of new renal scars on DMSA                        0.0000
SURGINDWorsening in renal function                                0.2461
SURGINDParental preference                                        0.0000
SURGINDPersistent reflux >2 years                                 0.0000

Sample Sizes:
          Control Treated
All           198     215
Matched       127     127
Unmatched      71      88
Discarded       0       0

> 
> # Extract the matched dataset from the matchit object
> mdata <- match.data(m.out)
> mdata <- mdata %>%
+   mutate(CLAVIENCLASS2 = recode(CLAVIENCLASS, 
+                                `Clavien grade 1` = "Clavien grade 1-2", 
+                                `Clavien grade 2` = "Clavien grade 1-2", 
+                                `Clavien grade 3` = "Clavien grade 3-5", 
+                                `Clavien grade 4` = "Clavien grade 3-5", 
+                                `Clavien grade 5` = "Clavien grade 3-5"))
> 
> # Check the structure of the new variable
> table(mdata$CLAVIENCLASS2)

Clavien grade 1-2 Clavien grade 3-5 
              174                27 
> 
> sum(is.na(mdata$CLAVIENCLASS2))
[1] 53
> mdata_clean <- mdata %>% drop_na(CLAVIENCLASS2)
> sum(is.na(mdata$CLAVIENCLASS2))
[1] 53
> sum(is.na(mdata_clean$CLAVIENCLASS2))
[1] 0
> 
> mdata_clean$GU30 <- ifelse(mdata_clean$GU30 == "Yes", 1, 0)
> mdata_clean$GU90 <- ifelse(mdata_clean$GU90 == "Yes", 1, 0)
> mdata_clean$GUER30 <- ifelse(mdata_clean$GUER30 == "Yes", 1, 0)
> mdata_clean$GUER90 <- ifelse(mdata_clean$GUER90 == "Yes", 1, 0)
> mdata_clean$PROC365 <- ifelse(mdata_clean$PROC365 == "Yes", 1, 0)
> 
> 
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ CLAVIENCLASS2,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR            CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 0.87 (0.46 - 1.66)   0.674
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.6742689
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ CLAVIENCLASS2 + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5" "PS"                            
[3] "TRTn2Lich-Gregoir group"        "CATHPERIOD"                    
[5] "STENTYes"                       "OPRTIME"                       
[7] "HOSPTIME"                      
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR            CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 0.97 (0.48 - 1.98)   0.936
2                             PS 0.59  (0.11 - 3.1)   0.532
3        TRTn2Lich-Gregoir group 0.08 (0.05 - 0.11)   0.000
4                     CATHPERIOD 0.95    (0.89 - 1)   0.047
5                       STENTYes 0.48 (0.38 - 0.61)   0.000
6                        OPRTIME 1.00       (1 - 1)   0.000
7                       HOSPTIME 1.04    (1 - 1.09)   0.082
> 
> # Display the p-value with more precision
> print(p_values)
[1] 9.360554e-01 5.324480e-01 0.000000e+00 4.664988e-02 2.276459e-09
[6] 7.579967e-09 8.208366e-02
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ CLAVIENCLASS2
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = Clavien grade 1-2, case = Clavien grade 3-5
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.548"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.435 - 0.547 - 0.66"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.398"
> 
>

 
10.A.1 BLDCOMPRETN
> #NOTE : Use  mdata 
> mdata$GU30 <- ifelse(mdata$GU30 == "Yes", 1, 0)
> mdata$GU90 <- ifelse(mdata$GU90 == "Yes", 1, 0)
> mdata$GUER30 <- ifelse(mdata$GUER30 == "Yes", 1, 0)
> mdata$GUER90 <- ifelse(mdata$GUER90 == "Yes", 1, 0)
> mdata$PROC365 <- ifelse(mdata$PROC365 == "Yes", 1, 0)
>
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDCOMPRETN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPRETNYes 1.05 (0.69 - 1.62)   0.811
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.8114709
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDCOMPRETN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPRETNYes 0.95  (0.64 - 1.4)   0.784
2                      PS 1.13 (0.16 - 7.88)   0.901
3 TRTn2Lich-Gregoir group 0.14 (0.06 - 0.33)   0.000
4              CATHPERIOD 0.96  (0.9 - 1.02)   0.188
5                STENTYes 0.28 (0.11 - 0.69)   0.006
6                 OPRTIME 1.01    (1 - 1.02)   0.073
7                HOSPTIME 1.04 (0.98 - 1.11)   0.146
> 
> # Display the p-value with more precision
> print(p_values)
[1] 7.844310e-01 9.010277e-01 1.139993e-05 1.881539e-01 5.823650e-03
[6] 7.342133e-02 1.455258e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPRETN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.476"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.388 - 0.476 - 0.568"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.959"
> 
>

 
10.A.2 URCOMPOBST
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ URCOMPOBST,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 URCOMPOBSTYes 0.68 (0.41 - 1.14)   0.143
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.1433636
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ URCOMPOBST + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPOBSTYes 1.95 (0.97 - 3.92)   0.060
2                      PS 1.18 (0.17 - 7.98)   0.864
3 TRTn2Lich-Gregoir group 0.12 (0.05 - 0.32)   0.000
4              CATHPERIOD 0.96  (0.9 - 1.02)   0.194
5                STENTYes 0.28 (0.11 - 0.69)   0.006
6                 OPRTIME 1.01    (1 - 1.02)   0.073
7                HOSPTIME 1.03  (0.97 - 1.1)   0.284
> 
> # Display the p-value with more precision
> print(p_values)
[1] 5.973805e-02 8.638586e-01 2.546668e-05 1.941417e-01 5.728170e-03
[6] 7.294744e-02 2.838718e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPOBST
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.573"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.452 - 0.573 - 0.685"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.359"
> 
>

 
10.A.3 ILEUS
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ ILEUS,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  ILEUSYes 2.24 (0.97 - 5.21)    0.06
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.05985194
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ ILEUS + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                ILEUSYes 0.56 (0.48 - 0.66)   0.000
2                      PS 1.21 (0.18 - 8.24)   0.844
3 TRTn2Lich-Gregoir group 0.13 (0.06 - 0.31)   0.000
4              CATHPERIOD 0.96  (0.9 - 1.02)   0.197
5                STENTYes 0.26  (0.1 - 0.64)   0.004
6                 OPRTIME 1.01    (1 - 1.02)   0.052
7                HOSPTIME 1.04 (0.97 - 1.11)   0.231
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.981637e-12 8.439817e-01 4.036181e-06 1.970158e-01 3.545426e-03
[6] 5.186070e-02 2.313057e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ ILEUS
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.664"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.534 - 0.665 - 0.769"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.024"
> 
>

 
10.A.4 URCOMPCVUR

> #NOTE : Use  mdata_clean for the variables: URCOMPCVUR
> library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 
> summary(m.out, standardize=TRUE)

Call:
matchit(formula = TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI + AGS + 
    PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE + PREOPEPISODEn + 
    PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, 
    method = "nearest", caliper = caliper_width)

Summary of Balance for All Data:
                                                         Means Treated
distance                                                        0.6939
PREOPVURGRADEIII                                                0.0419
PREOPVURGRADEIV                                                 0.3442
PREOPVURGRADEV                                                  0.6140
HISTOINJNo                                                      0.8837
HISTOINJYes                                                     0.1163
BMI                                                            14.8493
AGS                                                             7.6791
PREOPRNPLNNo                                                    0.9070
PREOPRNPLNYes                                                   0.0930
PREOPRNSCRNo scarring                                           0.7953
PREOPRNSCRAny scarring                                          0.2047
VURSIDELeft                                                     0.3814
VURSIDERight                                                    0.6186
VURPHASEAt voiding                                              0.5302
VURPHASEAt filling                                              0.3163
VURPHASEAt filling and voiding                                  0.1535
PREOPEPISODEn1                                                  0.0372
PREOPEPISODEn2                                                  0.1535
PREOPEPISODEn≥ 3                                                0.8093
PREOPTYPEUnAfebrile                                             0.0047
PREOPTYPEUnFebrile                                              0.9953
SURGTECHn2≥ 100                                                 0.3256
SURGTECHn250 - 100                                              0.6326
SURGTECHn2<50                                                   0.0419
GENDERMale                                                      0.5953
GENDERFemale                                                    0.4047
UDR7M< 7 mm                                                     0.3023
UDR7M≥ 7mm                                                      0.6977
SURGINDPoor compliance to medical treatment                     0.0419
SURGINDChildren with ineffective or poorly tolerated CAP        0.0093
SURGINDSymptomatic high-grade reflux (III-V)                    0.3488
SURGINDRepeated breakthrough UTI                                0.5628
SURGINDGirls with persistent VUR after puberty                  0.0047
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0233
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0093
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Means Control
distance                                                        0.3324
PREOPVURGRADEIII                                                0.0556
PREOPVURGRADEIV                                                 0.2626
PREOPVURGRADEV                                                  0.6818
HISTOINJNo                                                      0.9040
HISTOINJYes                                                     0.0960
BMI                                                            16.9864
AGS                                                             6.8914
PREOPRNPLNNo                                                    0.6566
PREOPRNPLNYes                                                   0.3434
PREOPRNSCRNo scarring                                           0.5253
PREOPRNSCRAny scarring                                          0.4747
VURSIDELeft                                                     0.4040
VURSIDERight                                                    0.5960
VURPHASEAt voiding                                              0.5707
VURPHASEAt filling                                              0.0051
VURPHASEAt filling and voiding                                  0.4242
PREOPEPISODEn1                                                  0.0808
PREOPEPISODEn2                                                  0.3434
PREOPEPISODEn≥ 3                                                0.5758
PREOPTYPEUnAfebrile                                             0.0354
PREOPTYPEUnFebrile                                              0.9646
SURGTECHn2≥ 100                                                 0.0758
SURGTECHn250 - 100                                              0.6970
SURGTECHn2<50                                                   0.2273
GENDERMale                                                      0.5455
GENDERFemale                                                    0.4545
UDR7M< 7 mm                                                     0.1616
UDR7M≥ 7mm                                                      0.8384
SURGINDPoor compliance to medical treatment                     0.0505
SURGINDChildren with ineffective or poorly tolerated CAP        0.0556
SURGINDSymptomatic high-grade reflux (III-V)                    0.2929
SURGINDRepeated breakthrough UTI                                0.4747
SURGINDGirls with persistent VUR after puberty                  0.0000
SURGINDVUR recurrence after endoscopic injection                0.0051
SURGINDReflux nephropathy                                       0.0303
SURGINDPresence of new renal scars on DMSA                      0.0202
SURGINDWorsening in renal function                              0.0202
SURGINDParental preference                                      0.0051
SURGINDPersistent reflux >2 years                               0.0455
                                                         Std. Mean Diff.
distance                                                          1.4219
PREOPVURGRADEIII                                                 -0.0684
PREOPVURGRADEIV                                                   0.1717
PREOPVURGRADEV                                                   -0.1394
HISTOINJNo                                                       -0.0634
HISTOINJYes                                                       0.0634
BMI                                                              -0.8280
AGS                                                               0.3528
PREOPRNPLNNo                                                      0.8621
PREOPRNPLNYes                                                    -0.8621
PREOPRNSCRNo scarring                                             0.6695
PREOPRNSCRAny scarring                                           -0.6695
VURSIDELeft                                                      -0.0466
VURSIDERight                                                      0.0466
VURPHASEAt voiding                                               -0.0811
VURPHASEAt filling                                                0.6693
VURPHASEAt filling and voiding                                   -0.7511
PREOPEPISODEn1                                                   -0.2303
PREOPEPISODEn2                                                   -0.5270
PREOPEPISODEn≥ 3                                                  0.5945
PREOPTYPEUnAfebrile                                              -0.4512
PREOPTYPEUnFebrile                                                0.4512
SURGTECHn2≥ 100                                                   0.5331
SURGTECHn250 - 100                                               -0.1336
SURGTECHn2<50                                                    -0.9258
GENDERMale                                                        0.1017
GENDERFemale                                                     -0.1017
UDR7M< 7 mm                                                       0.3064
UDR7M≥ 7mm                                                       -0.3064
SURGINDPoor compliance to medical treatment                      -0.0432
SURGINDChildren with ineffective or poorly tolerated CAP         -0.4818
SURGINDSymptomatic high-grade reflux (III-V)                      0.1173
SURGINDRepeated breakthrough UTI                                  0.1775
SURGINDGirls with persistent VUR after puberty                    0.0684
SURGINDVUR recurrence after endoscopic injection                 -0.1029
SURGINDReflux nephropathy                                        -0.0468
SURGINDPresence of new renal scars on DMSA                       -0.2074
SURGINDWorsening in renal function                               -0.1135
SURGINDParental preference                                       -0.1029
SURGINDPersistent reflux >2 years                                -0.3152
                                                         Var. Ratio
distance                                                     1.2698
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                          0.4302
AGS                                                          0.4700
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                    0.3476
PREOPVURGRADEIII                                            0.0137
PREOPVURGRADEIV                                             0.0816
PREOPVURGRADEV                                              0.0679
HISTOINJNo                                                  0.0203
HISTOINJYes                                                 0.0203
BMI                                                         0.1801
AGS                                                         0.0560
PREOPRNPLNNo                                                0.2504
PREOPRNPLNYes                                               0.2504
PREOPRNSCRNo scarring                                       0.2701
PREOPRNSCRAny scarring                                      0.2701
VURSIDELeft                                                 0.0226
VURSIDERight                                                0.0226
VURPHASEAt voiding                                          0.0405
VURPHASEAt filling                                          0.3112
VURPHASEAt filling and voiding                              0.2708
PREOPEPISODEn1                                              0.0436
PREOPEPISODEn2                                              0.1899
PREOPEPISODEn≥ 3                                            0.2335
PREOPTYPEUnAfebrile                                         0.0307
PREOPTYPEUnFebrile                                          0.0307
SURGTECHn2≥ 100                                             0.2498
SURGTECHn250 - 100                                          0.0644
SURGTECHn2<50                                               0.1854
GENDERMale                                                  0.0499
GENDERFemale                                                0.0499
UDR7M< 7 mm                                                 0.1407
UDR7M≥ 7mm                                                  0.1407
SURGINDPoor compliance to medical treatment                 0.0086
SURGINDChildren with ineffective or poorly tolerated CAP    0.0463
SURGINDSymptomatic high-grade reflux (III-V)                0.0559
SURGINDRepeated breakthrough UTI                            0.0880
SURGINDGirls with persistent VUR after puberty              0.0047
SURGINDVUR recurrence after endoscopic injection            0.0051
SURGINDReflux nephropathy                                   0.0070
SURGINDPresence of new renal scars on DMSA                  0.0202
SURGINDWorsening in renal function                          0.0109
SURGINDParental preference                                  0.0051
SURGINDPersistent reflux >2 years                           0.0455
                                                         eCDF Max
distance                                                   0.5375
PREOPVURGRADEIII                                           0.0137
PREOPVURGRADEIV                                            0.0816
PREOPVURGRADEV                                             0.0679
HISTOINJNo                                                 0.0203
HISTOINJYes                                                0.0203
BMI                                                        0.3310
AGS                                                        0.2014
PREOPRNPLNNo                                               0.2504
PREOPRNPLNYes                                              0.2504
PREOPRNSCRNo scarring                                      0.2701
PREOPRNSCRAny scarring                                     0.2701
VURSIDELeft                                                0.0226
VURSIDERight                                               0.0226
VURPHASEAt voiding                                         0.0405
VURPHASEAt filling                                         0.3112
VURPHASEAt filling and voiding                             0.2708
PREOPEPISODEn1                                             0.0436
PREOPEPISODEn2                                             0.1899
PREOPEPISODEn≥ 3                                           0.2335
PREOPTYPEUnAfebrile                                        0.0307
PREOPTYPEUnFebrile                                         0.0307
SURGTECHn2≥ 100                                            0.2498
SURGTECHn250 - 100                                         0.0644
SURGTECHn2<50                                              0.1854
GENDERMale                                                 0.0499
GENDERFemale                                               0.0499
UDR7M< 7 mm                                                0.1407
UDR7M≥ 7mm                                                 0.1407
SURGINDPoor compliance to medical treatment                0.0086
SURGINDChildren with ineffective or poorly tolerated CAP   0.0463
SURGINDSymptomatic high-grade reflux (III-V)               0.0559
SURGINDRepeated breakthrough UTI                           0.0880
SURGINDGirls with persistent VUR after puberty             0.0047
SURGINDVUR recurrence after endoscopic injection           0.0051
SURGINDReflux nephropathy                                  0.0070
SURGINDPresence of new renal scars on DMSA                 0.0202
SURGINDWorsening in renal function                         0.0109
SURGINDParental preference                                 0.0051
SURGINDPersistent reflux >2 years                          0.0455

Summary of Balance for Matched Data:
                                                         Means Treated
distance                                                        0.5601
PREOPVURGRADEIII                                                0.0551
PREOPVURGRADEIV                                                 0.3622
PREOPVURGRADEV                                                  0.5827
HISTOINJNo                                                      0.8740
HISTOINJYes                                                     0.1260
BMI                                                            15.4328
AGS                                                             7.5039
PREOPRNPLNNo                                                    0.8425
PREOPRNPLNYes                                                   0.1575
PREOPRNSCRNo scarring                                           0.7244
PREOPRNSCRAny scarring                                          0.2756
VURSIDELeft                                                     0.3780
VURSIDERight                                                    0.6220
VURPHASEAt voiding                                              0.7323
VURPHASEAt filling                                              0.0236
VURPHASEAt filling and voiding                                  0.2441
PREOPEPISODEn1                                                  0.0472
PREOPEPISODEn2                                                  0.2520
PREOPEPISODEn≥ 3                                                0.7008
PREOPTYPEUnAfebrile                                             0.0079
PREOPTYPEUnFebrile                                              0.9921
SURGTECHn2≥ 100                                                 0.1102
SURGTECHn250 - 100                                              0.8189
SURGTECHn2<50                                                   0.0709
GENDERMale                                                      0.5669
GENDERFemale                                                    0.4331
UDR7M< 7 mm                                                     0.3150
UDR7M≥ 7mm                                                      0.6850
SURGINDPoor compliance to medical treatment                     0.0551
SURGINDChildren with ineffective or poorly tolerated CAP        0.0157
SURGINDSymptomatic high-grade reflux (III-V)                    0.4252
SURGINDRepeated breakthrough UTI                                0.4567
SURGINDGirls with persistent VUR after puberty                  0.0079
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0315
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0079
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Means Control
distance                                                        0.4582
PREOPVURGRADEIII                                                0.0709
PREOPVURGRADEIV                                                 0.2756
PREOPVURGRADEV                                                  0.6535
HISTOINJNo                                                      0.8740
HISTOINJYes                                                     0.1260
BMI                                                            15.9707
AGS                                                             7.3575
PREOPRNPLNNo                                                    0.7638
PREOPRNPLNYes                                                   0.2362
PREOPRNSCRNo scarring                                           0.6693
PREOPRNSCRAny scarring                                          0.3307
VURSIDELeft                                                     0.3858
VURSIDERight                                                    0.6142
VURPHASEAt voiding                                              0.6929
VURPHASEAt filling                                              0.0079
VURPHASEAt filling and voiding                                  0.2992
PREOPEPISODEn1                                                  0.0551
PREOPEPISODEn2                                                  0.3071
PREOPEPISODEn≥ 3                                                0.6378
PREOPTYPEUnAfebrile                                             0.0157
PREOPTYPEUnFebrile                                              0.9843
SURGTECHn2≥ 100                                                 0.1024
SURGTECHn250 - 100                                              0.7638
SURGTECHn2<50                                                   0.1339
GENDERMale                                                      0.5433
GENDERFemale                                                    0.4567
UDR7M< 7 mm                                                     0.2126
UDR7M≥ 7mm                                                      0.7874
SURGINDPoor compliance to medical treatment                     0.0551
SURGINDChildren with ineffective or poorly tolerated CAP        0.0079
SURGINDSymptomatic high-grade reflux (III-V)                    0.4016
SURGINDRepeated breakthrough UTI                                0.4803
SURGINDGirls with persistent VUR after puberty                  0.0000
SURGINDVUR recurrence after endoscopic injection                0.0000
SURGINDReflux nephropathy                                       0.0394
SURGINDPresence of new renal scars on DMSA                      0.0000
SURGINDWorsening in renal function                              0.0157
SURGINDParental preference                                      0.0000
SURGINDPersistent reflux >2 years                               0.0000
                                                         Std. Mean Diff.
distance                                                          0.4011
PREOPVURGRADEIII                                                 -0.0786
PREOPVURGRADEIV                                                   0.1823
PREOPVURGRADEV                                                   -0.1456
HISTOINJNo                                                        0.0000
HISTOINJYes                                                       0.0000
BMI                                                              -0.2084
AGS                                                               0.0656
PREOPRNPLNNo                                                      0.2711
PREOPRNPLNYes                                                    -0.2711
PREOPRNSCRNo scarring                                             0.1366
PREOPRNSCRAny scarring                                           -0.1366
VURSIDELeft                                                      -0.0162
VURSIDERight                                                      0.0162
VURPHASEAt voiding                                                0.0789
VURPHASEAt filling                                                0.0339
VURPHASEAt filling and voiding                                   -0.1529
PREOPEPISODEn1                                                   -0.0416
PREOPEPISODEn2                                                   -0.1529
PREOPEPISODEn≥ 3                                                  0.1603
PREOPTYPEUnAfebrile                                              -0.1157
PREOPTYPEUnFebrile                                                0.1157
SURGTECHn2≥ 100                                                   0.0168
SURGTECHn250 - 100                                                0.1143
SURGTECHn2<50                                                    -0.3145
GENDERMale                                                        0.0481
GENDERFemale                                                     -0.0481
UDR7M< 7 mm                                                       0.2229
UDR7M≥ 7mm                                                       -0.2229
SURGINDPoor compliance to medical treatment                       0.0000
SURGINDChildren with ineffective or poorly tolerated CAP          0.0820
SURGINDSymptomatic high-grade reflux (III-V)                      0.0496
SURGINDRepeated breakthrough UTI                                 -0.0476
SURGINDGirls with persistent VUR after puberty                    0.1157
SURGINDVUR recurrence after endoscopic injection                  0.0000
SURGINDReflux nephropathy                                        -0.0522
SURGINDPresence of new renal scars on DMSA                        0.0000
SURGINDWorsening in renal function                               -0.0820
SURGINDParental preference                                        0.0000
SURGINDPersistent reflux >2 years                                 0.0000
                                                         Var. Ratio
distance                                                     1.3787
PREOPVURGRADEIII                                                  .
PREOPVURGRADEIV                                                   .
PREOPVURGRADEV                                                    .
HISTOINJNo                                                        .
HISTOINJYes                                                       .
BMI                                                          0.7659
AGS                                                          0.7608
PREOPRNPLNNo                                                      .
PREOPRNPLNYes                                                     .
PREOPRNSCRNo scarring                                             .
PREOPRNSCRAny scarring                                            .
VURSIDELeft                                                       .
VURSIDERight                                                      .
VURPHASEAt voiding                                                .
VURPHASEAt filling                                                .
VURPHASEAt filling and voiding                                    .
PREOPEPISODEn1                                                    .
PREOPEPISODEn2                                                    .
PREOPEPISODEn≥ 3                                                  .
PREOPTYPEUnAfebrile                                               .
PREOPTYPEUnFebrile                                                .
SURGTECHn2≥ 100                                                   .
SURGTECHn250 - 100                                                .
SURGTECHn2<50                                                     .
GENDERMale                                                        .
GENDERFemale                                                      .
UDR7M< 7 mm                                                       .
UDR7M≥ 7mm                                                        .
SURGINDPoor compliance to medical treatment                       .
SURGINDChildren with ineffective or poorly tolerated CAP          .
SURGINDSymptomatic high-grade reflux (III-V)                      .
SURGINDRepeated breakthrough UTI                                  .
SURGINDGirls with persistent VUR after puberty                    .
SURGINDVUR recurrence after endoscopic injection                  .
SURGINDReflux nephropathy                                         .
SURGINDPresence of new renal scars on DMSA                        .
SURGINDWorsening in renal function                                .
SURGINDParental preference                                        .
SURGINDPersistent reflux >2 years                                 .
                                                         eCDF Mean
distance                                                    0.1102
PREOPVURGRADEIII                                            0.0157
PREOPVURGRADEIV                                             0.0866
PREOPVURGRADEV                                              0.0709
HISTOINJNo                                                  0.0000
HISTOINJYes                                                 0.0000
BMI                                                         0.0622
AGS                                                         0.0379
PREOPRNPLNNo                                                0.0787
PREOPRNPLNYes                                               0.0787
PREOPRNSCRNo scarring                                       0.0551
PREOPRNSCRAny scarring                                      0.0551
VURSIDELeft                                                 0.0079
VURSIDERight                                                0.0079
VURPHASEAt voiding                                          0.0394
VURPHASEAt filling                                          0.0157
VURPHASEAt filling and voiding                              0.0551
PREOPEPISODEn1                                              0.0079
PREOPEPISODEn2                                              0.0551
PREOPEPISODEn≥ 3                                            0.0630
PREOPTYPEUnAfebrile                                         0.0079
PREOPTYPEUnFebrile                                          0.0079
SURGTECHn2≥ 100                                             0.0079
SURGTECHn250 - 100                                          0.0551
SURGTECHn2<50                                               0.0630
GENDERMale                                                  0.0236
GENDERFemale                                                0.0236
UDR7M< 7 mm                                                 0.1024
UDR7M≥ 7mm                                                  0.1024
SURGINDPoor compliance to medical treatment                 0.0000
SURGINDChildren with ineffective or poorly tolerated CAP    0.0079
SURGINDSymptomatic high-grade reflux (III-V)                0.0236
SURGINDRepeated breakthrough UTI                            0.0236
SURGINDGirls with persistent VUR after puberty              0.0079
SURGINDVUR recurrence after endoscopic injection            0.0000
SURGINDReflux nephropathy                                   0.0079
SURGINDPresence of new renal scars on DMSA                  0.0000
SURGINDWorsening in renal function                          0.0079
SURGINDParental preference                                  0.0000
SURGINDPersistent reflux >2 years                           0.0000
                                                         eCDF Max
distance                                                   0.2992
PREOPVURGRADEIII                                           0.0157
PREOPVURGRADEIV                                            0.0866
PREOPVURGRADEV                                             0.0709
HISTOINJNo                                                 0.0000
HISTOINJYes                                                0.0000
BMI                                                        0.1732
AGS                                                        0.1181
PREOPRNPLNNo                                               0.0787
PREOPRNPLNYes                                              0.0787
PREOPRNSCRNo scarring                                      0.0551
PREOPRNSCRAny scarring                                     0.0551
VURSIDELeft                                                0.0079
VURSIDERight                                               0.0079
VURPHASEAt voiding                                         0.0394
VURPHASEAt filling                                         0.0157
VURPHASEAt filling and voiding                             0.0551
PREOPEPISODEn1                                             0.0079
PREOPEPISODEn2                                             0.0551
PREOPEPISODEn≥ 3                                           0.0630
PREOPTYPEUnAfebrile                                        0.0079
PREOPTYPEUnFebrile                                         0.0079
SURGTECHn2≥ 100                                            0.0079
SURGTECHn250 - 100                                         0.0551
SURGTECHn2<50                                              0.0630
GENDERMale                                                 0.0236
GENDERFemale                                               0.0236
UDR7M< 7 mm                                                0.1024
UDR7M≥ 7mm                                                 0.1024
SURGINDPoor compliance to medical treatment                0.0000
SURGINDChildren with ineffective or poorly tolerated CAP   0.0079
SURGINDSymptomatic high-grade reflux (III-V)               0.0236
SURGINDRepeated breakthrough UTI                           0.0236
SURGINDGirls with persistent VUR after puberty             0.0079
SURGINDVUR recurrence after endoscopic injection           0.0000
SURGINDReflux nephropathy                                  0.0079
SURGINDPresence of new renal scars on DMSA                 0.0000
SURGINDWorsening in renal function                         0.0079
SURGINDParental preference                                 0.0000
SURGINDPersistent reflux >2 years                          0.0000
                                                         Std. Pair Dist.
distance                                                          0.4013
PREOPVURGRADEIII                                                  0.6291
PREOPVURGRADEIV                                                   0.8784
PREOPVURGRADEV                                                    0.9219
HISTOINJNo                                                        0.2520
HISTOINJYes                                                       0.2520
BMI                                                               1.2533
AGS                                                               1.2928
PREOPRNPLNNo                                                      0.7590
PREOPRNPLNYes                                                     0.7590
PREOPRNSCRNo scarring                                             1.1125
PREOPRNSCRAny scarring                                            1.1125
VURSIDELeft                                                       0.7295
VURSIDERight                                                      0.7295
VURPHASEAt voiding                                                0.8046
VURPHASEAt filling                                                0.0677
VURPHASEAt filling and voiding                                    1.0704
PREOPEPISODEn1                                                    0.4576
PREOPEPISODEn2                                                    1.2014
PREOPEPISODEn≥ 3                                                  1.1224
PREOPTYPEUnAfebrile                                               0.3472
PREOPTYPEUnFebrile                                                0.3472
SURGTECHn2≥ 100                                                   0.3865
SURGTECHn250 - 100                                                0.6370
SURGTECHn2<50                                                     0.6291
GENDERMale                                                        0.9144
GENDERFemale                                                      0.9144
UDR7M< 7 mm                                                       0.8401
UDR7M≥ 7mm                                                        0.8401
SURGINDPoor compliance to medical treatment                       0.0945
SURGINDChildren with ineffective or poorly tolerated CAP          0.2461
SURGINDSymptomatic high-grade reflux (III-V)                      0.9087
SURGINDRepeated breakthrough UTI                                  1.0318
SURGINDGirls with persistent VUR after puberty                    0.1157
SURGINDVUR recurrence after endoscopic injection                  0.0000
SURGINDReflux nephropathy                                         0.4702
SURGINDPresence of new renal scars on DMSA                        0.0000
SURGINDWorsening in renal function                                0.2461
SURGINDParental preference                                        0.0000
SURGINDPersistent reflux >2 years                                 0.0000

Sample Sizes:
          Control Treated
All           198     215
Matched       127     127
Unmatched      71      88
Discarded       0       0

> 
> # Extract the matched dataset from the matchit object
> mdata <- match.data(m.out)
> mdata_clean <- mdata %>% drop_na(URCOMPCVUR)
> sum(is.na(mdata_clean$URCOMPCVUR))
[1] 0
> table(mdata$URCOMPCVUR)

 No Yes 
230   6 
> table(mdata_clean$URCOMPCVUR)

 No Yes 
230   6 
> sum(is.na(mdata$URCOMPCVUR))
[1] 18
> 


> mdata_clean$GU30 <- ifelse(mdata_clean$GU30 == "Yes", 1, 0)
> mdata_clean$GU90 <- ifelse(mdata_clean$GU90 == "Yes", 1, 0)
> mdata_clean$GUER30 <- ifelse(mdata_clean$GUER30 == "Yes", 1, 0)
> mdata_clean$GUER90 <- ifelse(mdata_clean$GUER90 == "Yes", 1, 0)
> mdata_clean$PROC365 <- ifelse(mdata_clean$PROC365 == "Yes", 1, 0)
> 
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+   GU30 ~ URCOMPCVUR,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate    OR              CI P_value
1 URCOMPCVURYes 21.14 (10.49 - 42.59)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GU30 ~ URCOMPCVUR + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR              CI P_value
1           URCOMPCVURYes 13.28 (10.63 - 16.58)   0.000
2                      PS  0.75   (0.11 - 5.24)   0.768
3 TRTn2Lich-Gregoir group  0.11   (0.05 - 0.24)   0.000
4              CATHPERIOD  0.94      (0.89 - 1)   0.039
5                STENTYes  0.45    (0.4 - 0.52)   0.000
6                 OPRTIME  1.01      (1 - 1.01)   0.102
7                HOSPTIME  1.02   (0.94 - 1.11)   0.574
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 7.679727e-01 1.051733e-08 3.942386e-02 0.000000e+00
[6] 1.022355e-01 5.739971e-01
> 
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ URCOMPCVUR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.976"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.92 - 0.977 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 

10.A.5 URCOMPINJ
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ URCOMPINJ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR             CI P_value
1 URCOMPINJYes 6.62 (2.97 - 14.77)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 3.893041e-06
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ URCOMPINJ + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR            CI P_value
1            URCOMPINJYes 12.80 (4.5 - 36.38)   0.000
2                      PS  1.01 (0.16 - 6.31)   0.995
3 TRTn2Lich-Gregoir group  0.14  (0.06 - 0.3)   0.000
4              CATHPERIOD  0.97 (0.91 - 1.04)   0.366
5                STENTYes  0.18 (0.07 - 0.49)   0.001
6                 OPRTIME  1.01    (1 - 1.02)   0.025
7                HOSPTIME  0.98 (0.91 - 1.05)   0.557
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.714624e-06 9.947850e-01 6.770154e-07 3.664288e-01 6.862856e-04
[6] 2.512741e-02 5.569871e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPINJ
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.842"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.54 - 0.843 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.007"
> 
>

 
10.A.6 INCCOMPINF


> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ INCCOMPINF,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 INCCOMPINFYes 2.66 (1.67 - 4.26)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 4.169538e-05
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ INCCOMPINF + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           INCCOMPINFYes 1.42 (1.13 - 1.79)   0.003
2                      PS 1.03 (0.14 - 7.67)   0.974
3 TRTn2Lich-Gregoir group 0.14 (0.06 - 0.33)   0.000
4              CATHPERIOD 0.96 (0.89 - 1.02)   0.190
5                STENTYes 0.29 (0.11 - 0.72)   0.008
6                 OPRTIME 1.01    (1 - 1.02)   0.080
7                HOSPTIME 1.04 (0.97 - 1.11)   0.263
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.771591e-03 9.741768e-01 9.812251e-06 1.904467e-01 7.739486e-03
[6] 8.025233e-02 2.633529e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPINF
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.792"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.701 - 0.79 - 0.871"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
10.A.7 INCCOMPBLEED

> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ INCCOMPBLEED,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
        Covariate   OR            CI P_value
1 INCCOMPBLEEDYes 1.37 (0.61 - 3.05)   0.447
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.4468759
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ INCCOMPBLEED + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"         "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1         INCCOMPBLEEDYes 0.97 (0.82 - 1.16)   0.750
2                      PS 1.12 (0.16 - 7.75)   0.905
3 TRTn2Lich-Gregoir group 0.14 (0.06 - 0.33)   0.000
4              CATHPERIOD 0.96  (0.9 - 1.02)   0.190
5                STENTYes 0.28 (0.11 - 0.68)   0.005
6                 OPRTIME 1.01    (1 - 1.02)   0.074
7                HOSPTIME 1.04 (0.98 - 1.11)   0.166
> 
> # Display the p-value with more precision
> print(p_values)
[1] 7.497006e-01 9.052768e-01 8.929819e-06 1.899585e-01 5.070740e-03
[6] 7.401423e-02 1.658628e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPBLEED
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.588"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.502 - 0.589 - 0.67"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.075"
> 
> 
> 
> 
10.A.8 BLDCOMPVOID
> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDCOMPVOID,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPVOIDYes 2.51 (1.06 - 5.97)   0.037
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.03663909
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDCOMPVOID + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPVOIDYes 5.27 (1.4 - 19.78)   0.014
2                      PS 0.95 (0.13 - 6.74)   0.955
3 TRTn2Lich-Gregoir group 0.12 (0.05 - 0.32)   0.000
4              CATHPERIOD 0.95 (0.89 - 1.01)   0.079
5                STENTYes 0.29 (0.12 - 0.72)   0.008
6                 OPRTIME 1.01    (1 - 1.02)   0.112
7                HOSPTIME 1.06 (1.02 - 1.11)   0.008
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.374597e-02 9.551390e-01 1.680713e-05 7.880035e-02 7.764458e-03
[6] 1.122784e-01 8.029339e-03
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPVOID
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.713"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.554 - 0.715 - 0.846"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.015"
> 
> 
> 
>

 
10.A.9 BLDCOMPLEAK

> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDCOMPLEAK,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 BLDCOMPLEAKYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDCOMPLEAK + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPLEAKYes 0.00       (0 - 0)   0.000
2                      PS 1.02 (0.15 - 6.81)   0.983
3 TRTn2Lich-Gregoir group 0.18 (0.07 - 0.43)   0.000
4              CATHPERIOD 0.95 (0.89 - 1.02)   0.161
5                STENTYes 0.33 (0.14 - 0.76)   0.010
6                 OPRTIME 1.01    (1 - 1.02)   0.017
7                HOSPTIME 1.06    (1 - 1.11)   0.033
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000000 0.982839947 0.000118909 0.160655650 0.009791522
[6] 0.017249683 0.032531106
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPLEAK
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
10.A.10 URCOMPSTEN
> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ URCOMPSTEN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 URCOMPSTENYes 0.34 (0.18 - 0.63)   0.001
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.0006975519
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ URCOMPSTEN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPSTENYes 0.28 (0.22 - 0.36)   0.000
2                      PS 1.16 (0.17 - 7.95)   0.877
3 TRTn2Lich-Gregoir group 0.14 (0.06 - 0.34)   0.000
4              CATHPERIOD 0.95 (0.89 - 1.02)   0.177
5                STENTYes 0.29 (0.11 - 0.75)   0.010
6                 OPRTIME 1.01    (1 - 1.02)   0.079
7                HOSPTIME 1.04 (0.98 - 1.11)   0.163
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 8.765955e-01 1.427775e-05 1.767885e-01 1.021880e-02
[6] 7.864102e-02 1.627965e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPSTEN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.687"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.529 - 0.688 - 0.831"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.021"
> 
> 
> 
>
 
10.A.11 INCCOMPSCAR
> #NOTE : Remove STENT from the multivariable analysis for the variable INCCOMPSCAR
> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ INCCOMPSCAR,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 INCCOMPSCARYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 


> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GU30 ~ INCCOMPSCAR + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1          INCCOMPSCARYes 0.00        (0 - 0)   0.000
2                      PS 1.52 (0.19 - 12.14)   0.692
3 TRTn2Lich-Gregoir group 0.18  (0.05 - 0.64)   0.008
4              CATHPERIOD 0.93  (0.88 - 0.99)   0.023
5                 OPRTIME 1.01     (1 - 1.02)   0.114
6                HOSPTIME 1.05      (1 - 1.1)   0.055
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000000 0.692277842 0.008238127 0.022603555 0.114199411
[6] 0.055055012
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPSCAR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
10.A.12 ANASTOMO
> #NOTE : Remove STENT from the multivariable analysis for the variable ANASTOMO
> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ ANASTOMO,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR            CI P_value
1 ANASTOMOYes 2.11 (0.94 - 4.74)   0.069
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.06896729
> 
> 
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GU30 ~ ANASTOMO + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1             ANASTOMOYes 1.65  (0.73 - 3.74)   0.231
2                      PS 1.38 (0.17 - 10.99)   0.762
3 TRTn2Lich-Gregoir group 0.18  (0.05 - 0.65)   0.009
4              CATHPERIOD 0.93  (0.88 - 0.99)   0.023
5                 OPRTIME 1.01     (1 - 1.02)   0.136
6                HOSPTIME 1.05      (1 - 1.1)   0.061
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.231182317 0.761701122 0.008803338 0.023010988 0.136066662
[6] 0.060915836
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ANASTOMO
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.774"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.619 - 0.776 - 0.944"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.093"
> 
> 
10.A.13 BLDSPASM
> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDSPASM,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR            CI P_value
1 BLDSPASMYes 1.75 (1.03 - 2.98)    0.04
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.0399696
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ BLDSPASM + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1             BLDSPASMYes 1.63 (1.07 - 2.48)   0.022
2                      PS 1.00 (0.16 - 6.16)   0.997
3 TRTn2Lich-Gregoir group 0.14 (0.06 - 0.32)   0.000
4              CATHPERIOD 0.96  (0.9 - 1.02)   0.209
5                STENTYes 0.26  (0.1 - 0.65)   0.004
6                 OPRTIME 1.01    (1 - 1.02)   0.054
7                HOSPTIME 1.04 (0.97 - 1.11)   0.234
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.179416e-02 9.973190e-01 3.883034e-06 2.085563e-01 4.079983e-03
[6] 5.448549e-02 2.344080e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDSPASM
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.721"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.654 - 0.722 - 0.785"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
>

 
10.A.14 HEMAT
> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ HEMAT,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HEMATYes 1.36 (0.97 - 1.91)   0.076
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.07581502
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ HEMAT + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                HEMATYes 1.09 (0.79 - 1.51)   0.602
2                      PS 1.12 (0.16 - 7.72)   0.908
3 TRTn2Lich-Gregoir group 0.14 (0.06 - 0.33)   0.000
4              CATHPERIOD 0.96  (0.9 - 1.02)   0.195
5                STENTYes 0.28 (0.11 - 0.68)   0.005
6                 OPRTIME 1.01    (1 - 1.02)   0.071
7                HOSPTIME 1.04 (0.98 - 1.11)   0.165
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.6024099002 0.9082536415 0.0000111178 0.1948046677 0.0051819362
[6] 0.0712507224 0.1653137283
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ HEMAT
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.646"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.573 - 0.647 - 0.724"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
>

 
10.A.15 UTIpostop
> #A
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU30 ~ UTIpostop,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR           CI P_value
1 UTIpostopUTI 1.29 (0.5 - 3.32)   0.598
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.598012
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU30 ~ UTIpostop + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1            UTIpostopUTI 0.67 (0.43 - 1.06)   0.087
2                      PS 1.07 (0.15 - 7.47)   0.945
3 TRTn2Lich-Gregoir group 0.13 (0.05 - 0.33)   0.000
4              CATHPERIOD 0.95 (0.89 - 1.02)   0.188
5                STENTYes 0.27  (0.1 - 0.68)   0.005
6                 OPRTIME 1.01    (1 - 1.02)   0.068
7                HOSPTIME 1.04 (0.98 - 1.11)   0.179
> 
> # Display the p-value with more precision
> print(p_values)
[1] 8.749314e-02 9.449630e-01 1.426738e-05 1.876386e-01 5.358862e-03
[6] 6.764207e-02 1.789942e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ UTIpostop
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No UTI, case = UTI
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.542"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.465 - 0.542 - 0.616"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.298"

==================================================================================================
 
10. B.  Association with: GU90

 
10.B.0 CLAVIENCLASS2

> #NOTE : Use  mdata_clean for the variables: CLAVIENCLASS2

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ CLAVIENCLASS2,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR           CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 0.86 (0.5 - 1.47)    0.58
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.5797733
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ CLAVIENCLASS2 + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5" "PS"                            
[3] "TRTn2Lich-Gregoir group"        "CATHPERIOD"                    
[5] "STENTYes"                       "OPRTIME"                       
[7] "HOSPTIME"                      
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR            CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 1.34 (0.79 - 2.26)   0.278
2                             PS 0.46  (0.35 - 0.6)   0.000
3        TRTn2Lich-Gregoir group 0.20 (0.16 - 0.25)   0.000
4                     CATHPERIOD 1.23  (1.2 - 1.26)   0.000
5                       STENTYes 0.43 (0.38 - 0.48)   0.000
6                        OPRTIME 1.00       (1 - 1)   0.214
7                       HOSPTIME 0.95 (0.94 - 0.97)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.776909e-01 1.757240e-08 0.000000e+00 0.000000e+00 0.000000e+00
[6] 2.140449e-01 6.067219e-08
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ CLAVIENCLASS2
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = Clavien grade 1-2, case = Clavien grade 3-5
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.536"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.441 - 0.536 - 0.63"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.528"
> 
>


 
10.B.1 BLDCOMPRETN

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDCOMPRETN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate  OR            CI P_value
1 BLDCOMPRETNYes 0.8 (0.38 - 1.69)    0.56
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.5597767
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDCOMPRETN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPRETNYes 1.23  (0.95 - 1.6)   0.118
2                      PS 0.71 (0.29 - 1.76)   0.460
3 TRTn2Lich-Gregoir group 0.38 (0.18 - 0.79)   0.009
4              CATHPERIOD 1.27 (1.19 - 1.35)   0.000
5                STENTYes 0.23 (0.08 - 0.64)   0.005
6                 OPRTIME 1.01    (1 - 1.02)   0.108
7                HOSPTIME 0.97 (0.93 - 1.01)   0.104
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.175520e-01 4.602658e-01 9.423907e-03 1.493250e-13 4.884891e-03
[6] 1.082429e-01 1.036608e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPRETN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.519"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.43 - 0.519 - 0.607"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.66"
> 
> 
> 
> 
10.B.2 URCOMPOBST
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ URCOMPOBST,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 URCOMPOBSTYes 0.54 (0.34 - 0.86)    0.01
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.009595516
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ URCOMPOBST + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPOBSTYes 1.46 (1.19 - 1.78)   0.000
2                      PS 0.75 (0.31 - 1.79)   0.513
3 TRTn2Lich-Gregoir group 0.37 (0.18 - 0.76)   0.007
4              CATHPERIOD 1.27  (1.2 - 1.35)   0.000
5                STENTYes 0.23 (0.08 - 0.64)   0.005
6                 OPRTIME 1.01    (1 - 1.02)   0.104
7                HOSPTIME 0.96    (0.92 - 1)   0.063
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.241489e-04 5.126512e-01 7.213354e-03 1.221245e-15 4.989848e-03
[6] 1.039258e-01 6.311036e-02
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPOBST
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.571"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.449 - 0.573 - 0.682"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.373"
> 
>


 
10.B.3 ILEUS
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ ILEUS,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  ILEUSYes 0.68 (0.25 - 1.83)   0.446
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.4460464
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ ILEUS + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                ILEUSYes 0.52 (0.46 - 0.59)   0.000
2                      PS 0.77 (0.32 - 1.85)   0.562
3 TRTn2Lich-Gregoir group 0.38 (0.19 - 0.76)   0.006
4              CATHPERIOD 1.27  (1.2 - 1.35)   0.000
5                STENTYes 0.21  (0.08 - 0.6)   0.003
6                 OPRTIME 1.01    (1 - 1.02)   0.070
7                HOSPTIME 0.96 (0.92 - 1.01)   0.095
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 5.619345e-01 6.209649e-03 4.996004e-15 3.240744e-03
[6] 6.995717e-02 9.487079e-02
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ ILEUS
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.452"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.336 - 0.453 - 0.561"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.989"
> 
>

 
10.B.4 URCOMPCVUR

> #NOTE : Use  mdata_clean for the variables: URCOMPCVUR
> library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+   GU90 ~ URCOMPCVUR,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR             CI P_value
1 URCOMPCVURYes 6.39 (2.13 - 19.15)   0.001
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.0009344782
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GU90 ~ URCOMPCVUR + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR            CI P_value
1           URCOMPCVURYes 10.18 (9.3 - 11.14)   0.000
2                      PS  0.47 (0.24 - 0.92)   0.028
3 TRTn2Lich-Gregoir group  0.30  (0.22 - 0.4)   0.000
4              CATHPERIOD  1.30  (1.21 - 1.4)   0.000
5                STENTYes  0.44 (0.43 - 0.45)   0.000
6                 OPRTIME  1.00    (1 - 1.01)   0.052
7                HOSPTIME  0.94  (0.9 - 0.98)   0.002
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 2.762284e-02 5.218048e-15 4.203082e-12 0.000000e+00
[6] 5.184620e-02 2.396721e-03
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ URCOMPCVUR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.767"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.709 - 0.767 - 0.822"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.022"
> 
>
> 

10.B.5 URCOMPINJ
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ URCOMPINJ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR            CI P_value
1 URCOMPINJYes 2.13 (0.81 - 5.61)   0.127
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.1274514
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ URCOMPINJ + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR             CI P_value
1            URCOMPINJYes 11.22 (3.92 - 32.09)   0.000
2                      PS  0.64   (0.3 - 1.35)   0.242
3 TRTn2Lich-Gregoir group  0.41  (0.22 - 0.75)   0.004
4              CATHPERIOD  1.30  (1.23 - 1.37)   0.000
5                STENTYes  0.16  (0.05 - 0.48)   0.001
6                 OPRTIME  1.01     (1 - 1.02)   0.044
7                HOSPTIME  0.91  (0.89 - 0.94)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 6.600960e-06 2.420233e-01 3.879493e-03 0.000000e+00 1.108420e-03
[6] 4.386892e-02 6.959419e-08
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPINJ
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.687"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.528 - 0.691 - 0.814"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.154"
> 
>

 
10.B.6 INCCOMPINF
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ INCCOMPINF,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 INCCOMPINFYes 1.46 (0.67 - 3.17)   0.344
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.3437787
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ INCCOMPINF + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           INCCOMPINFYes 1.59 (1.38 - 1.83)   0.000
2                      PS 0.68 (0.28 - 1.68)   0.403
3 TRTn2Lich-Gregoir group 0.39  (0.19 - 0.8)   0.010
4              CATHPERIOD 1.26 (1.19 - 1.34)   0.000
5                STENTYes 0.24 (0.09 - 0.69)   0.008
6                 OPRTIME 1.01    (1 - 1.02)   0.115
7                HOSPTIME 0.96    (0.92 - 1)   0.070
> 
> # Display the p-value with more precision
> print(p_values)
[1] 5.202949e-11 4.032064e-01 1.049721e-02 4.396483e-14 7.543798e-03
[6] 1.152636e-01 6.997092e-02
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPINF
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.659"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.582 - 0.66 - 0.742"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.005"
> 
> 
>

 
10.B.7 INCCOMPBLEED
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ INCCOMPBLEED,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ 
> 
> # View the results
> print(results)
        Covariate   OR            CI P_value
1 INCCOMPBLEEDYes 0.45 (0.17 - 1.18)   0.105
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.1052754
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ INCCOMPBLEED + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"         "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1         INCCOMPBLEEDYes 0.85  (0.48 - 1.5)   0.572
2                      PS 0.70 (0.27 - 1.85)   0.475
3 TRTn2Lich-Gregoir group 0.39 (0.19 - 0.81)   0.011
4              CATHPERIOD 1.27 (1.19 - 1.35)   0.000
5                STENTYes 0.23 (0.08 - 0.62)   0.004
6                 OPRTIME 1.01    (1 - 1.02)   0.106
7                HOSPTIME 0.96 (0.92 - 1.01)   0.120
> 
> # Display the p-value with more precision
> print(p_values)
[1] 5.724877e-01 4.748752e-01 1.103301e-02 7.882583e-15 3.625974e-03
[6] 1.063761e-01 1.195703e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPBLEED
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.655"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.566 - 0.654 - 0.734"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.003"
> 
> 
>


 
10.B.8 BLDCOMPVOID
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDCOMPVOID,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPVOIDYes 2.55 (1.24 - 5.23)   0.011
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.01099551
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDCOMPVOID + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPVOIDYes 2.03 (1.75 - 2.36)   0.000
2                      PS 0.67 (0.27 - 1.68)   0.395
3 TRTn2Lich-Gregoir group 0.38  (0.18 - 0.8)   0.011
4              CATHPERIOD 1.27  (1.2 - 1.34)   0.000
5                STENTYes 0.24 (0.08 - 0.67)   0.006
6                 OPRTIME 1.01    (1 - 1.02)   0.129
7                HOSPTIME 0.97 (0.93 - 1.01)   0.139
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 3.950420e-01 1.053140e-02 6.661338e-16 6.425386e-03
[6] 1.294930e-01 1.386692e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPVOID
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.721"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.58 - 0.725 - 0.856"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.014"
> 
> 
>

 
10.B.9 BLDCOMPLEAK
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDCOMPLEAK,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 BLDCOMPLEAKYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDCOMPLEAK + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPLEAKYes 0.00       (0 - 0)   0.000
2                      PS 0.64 (0.28 - 1.44)   0.281
3 TRTn2Lich-Gregoir group 0.51 (0.24 - 1.08)   0.078
4              CATHPERIOD 1.29 (1.22 - 1.36)   0.000
5                STENTYes 0.24 (0.09 - 0.64)   0.004
6                 OPRTIME 1.01    (1 - 1.02)   0.042
7                HOSPTIME 0.99 (0.95 - 1.04)   0.810
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000000 0.280966747 0.078064732 0.000000000 0.003861815
[6] 0.042443778 0.810052727
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPLEAK
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
>

 
10.B.10 URCOMPSTEN
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ URCOMPSTEN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate  OR           CI P_value
1 URCOMPSTENYes 0.4 (0.27 - 0.6)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 1.220179e-05
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ URCOMPSTEN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPSTENYes 0.51 (0.42 - 0.61)   0.000
2                      PS 0.76 (0.33 - 1.76)   0.520
3 TRTn2Lich-Gregoir group 0.39 (0.19 - 0.81)   0.011
4              CATHPERIOD 1.27  (1.2 - 1.35)   0.000
5                STENTYes 0.23 (0.08 - 0.67)   0.007
6                 OPRTIME 1.01    (1 - 1.02)   0.108
7                HOSPTIME 0.96 (0.92 - 1.01)   0.115
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.079914e-12 5.201707e-01 1.127922e-02 4.440892e-16 6.738984e-03
[6] 1.075024e-01 1.146412e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPSTEN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.679"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.541 - 0.681 - 0.802"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.024"
> 
> 
>



 
10.B.11 INCCOMPSCAR
> #NOTE : Remove STENT from the multivariable analysis for the variable INCCOMPSCAR
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ INCCOMPSCAR,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 INCCOMPSCARYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GU90 ~ INCCOMPSCAR + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          INCCOMPSCARYes 0.00       (0 - 0)   0.000
2                      PS 1.08 (0.29 - 3.97)   0.912
3 TRTn2Lich-Gregoir group 0.57 (0.15 - 2.16)   0.409
4              CATHPERIOD 1.22 (1.16 - 1.28)   0.000
5                 OPRTIME 1.01 (0.99 - 1.03)   0.188
6                HOSPTIME 0.97 (0.92 - 1.01)   0.145
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 9.123070e-01 4.090539e-01 5.828671e-14 1.878666e-01
[6] 1.453864e-01
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPSCAR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
10.B.12 ANASTOMO
> #NOTE : Remove STENT from the multivariable analysis for the variable ANASTOMO
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ ANASTOMO,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate  OR            CI P_value
1 ANASTOMOYes 0.7 (0.27 - 1.79)   0.452
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.4524895
> 
> 
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GU90 ~ ANASTOMO + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1             ANASTOMOYes 1.13 (0.49 - 2.65)   0.771
2                      PS 0.98 (0.26 - 3.66)   0.980
3 TRTn2Lich-Gregoir group 0.56 (0.15 - 2.15)   0.398
4              CATHPERIOD 1.22 (1.16 - 1.29)   0.000
5                 OPRTIME 1.01 (0.99 - 1.03)   0.219
6                HOSPTIME 0.97 (0.92 - 1.01)   0.160
> 
> # Display the p-value with more precision
> print(p_values)
[1] 7.710212e-01 9.797408e-01 3.978628e-01 1.646461e-13 2.189971e-01
[6] 1.604168e-01
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ANASTOMO
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.491"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.375 - 0.495 - 0.596"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.901"
> 
> 
10.B.13 BLDSPASM
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDSPASM,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR           CI P_value
1 BLDSPASMYes 0.89 (0.4 - 1.97)   0.771
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.7706463
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ BLDSPASM + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1             BLDSPASMYes 1.42 (1.24 - 1.63)   0.000
2                      PS 0.69 (0.29 - 1.65)   0.400
3 TRTn2Lich-Gregoir group 0.39 (0.19 - 0.79)   0.009
4              CATHPERIOD 1.26 (1.19 - 1.34)   0.000
5                STENTYes 0.23 (0.08 - 0.62)   0.004
6                 OPRTIME 1.01    (1 - 1.02)   0.084
7                HOSPTIME 0.97 (0.92 - 1.01)   0.112
> 
> # Display the p-value with more precision
> print(p_values)
[1] 3.481619e-07 3.998215e-01 8.915832e-03 1.566525e-13 3.712229e-03
[6] 8.431740e-02 1.121828e-01
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDSPASM
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.557"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.487 - 0.558 - 0.624"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.16"
> 
> 
>

 
10.B.14 HEMAT
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ HEMAT,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HEMATYes 0.94 (0.46 - 1.91)   0.856
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.8559924
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ HEMAT + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                HEMATYes 1.34 (0.99 - 1.81)   0.060
2                      PS 0.72  (0.3 - 1.73)   0.459
3 TRTn2Lich-Gregoir group 0.39  (0.19 - 0.8)   0.011
4              CATHPERIOD 1.27 (1.19 - 1.35)   0.000
5                STENTYes 0.23 (0.08 - 0.63)   0.004
6                 OPRTIME 1.01    (1 - 1.02)   0.102
7                HOSPTIME 0.96    (0.92 - 1)   0.072
> 
> # Display the p-value with more precision
> print(p_values)
[1] 5.996080e-02 4.588569e-01 1.080718e-02 1.230127e-13 4.413447e-03
[6] 1.015900e-01 7.154922e-02
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ HEMAT
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.56"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.485 - 0.562 - 0.635"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.213"
> 
> 
>


 
10.B.15 UTIpostop
> #B
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GU90 ~ UTIpostop,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR           CI P_value
1 UTIpostopUTI 0.36 (0.1 - 1.23)   0.104
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.1036467
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GU90 ~ UTIpostop + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1            UTIpostopUTI 0.59  (0.5 - 0.69)   0.000
2                      PS 0.66 (0.27 - 1.62)   0.367
3 TRTn2Lich-Gregoir group 0.38 (0.18 - 0.81)   0.012
4              CATHPERIOD 1.26 (1.19 - 1.34)   0.000
5                STENTYes 0.21 (0.07 - 0.64)   0.006
6                 OPRTIME 1.01    (1 - 1.02)   0.098
7                HOSPTIME 0.96 (0.92 - 1.01)   0.084
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.499119e-10 3.669811e-01 1.207746e-02 1.665335e-14 6.143628e-03
[6] 9.761098e-02 8.353193e-02
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ UTIpostop
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No UTI, case = UTI
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.706"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.633 - 0.706 - 0.768"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"

==================================================================================================

10. C.  Association with: GUER30

 
10.C.0 CLAVIENCLASS2

> #NOTE : Use  mdata_clean for the variables: CLAVIENCLASS2

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ CLAVIENCLASS2,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR           CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 1.15 (0.7 - 1.89)   0.572
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.5722841
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ CLAVIENCLASS2 + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5" "PS"                            
[3] "TRTn2Lich-Gregoir group"        "CATHPERIOD"                    
[5] "STENTYes"                       "OPRTIME"                       
[7] "HOSPTIME"                      
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR            CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 1.43 (0.72 - 2.83)   0.303
2                             PS 0.74 (0.26 - 2.06)   0.562
3        TRTn2Lich-Gregoir group 0.03 (0.02 - 0.03)   0.000
4                     CATHPERIOD 0.94 (0.92 - 0.95)   0.000
5                       STENTYes 0.50  (0.41 - 0.6)   0.000
6                        OPRTIME 1.00    (0.99 - 1)   0.010
7                       HOSPTIME 1.08 (1.07 - 1.09)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 3.033702e-01 5.617031e-01 0.000000e+00 1.443290e-15 7.047696e-13
[6] 1.017153e-02 0.000000e+00
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ CLAVIENCLASS2
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = Clavien grade 1-2, case = Clavien grade 3-5
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.63"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.532 - 0.63 - 0.723"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.029"
> 
>




 
10.C.1 BLDCOMPRETN
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDCOMPRETN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPRETNYes 1.46 (0.37 - 5.73)   0.585
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.5846187
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDCOMPRETN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPRETNYes 1.56  (0.39 - 6.3)   0.530
2                      PS 1.88 (0.39 - 9.13)   0.434
3 TRTn2Lich-Gregoir group 0.08 (0.03 - 0.22)   0.000
4              CATHPERIOD 0.96 (0.92 - 1.01)   0.103
5                STENTYes 0.26  (0.1 - 0.67)   0.005
6                 OPRTIME 1.01 (0.99 - 1.03)   0.219
7                HOSPTIME 1.10 (1.06 - 1.14)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 5.298096e-01 4.340451e-01 5.244075e-07 1.028627e-01 5.051341e-03
[6] 2.186496e-01 1.386816e-07
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPRETN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.697"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.614 - 0.698 - 0.767"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>

 
10.C.2 URCOMPOBST

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ URCOMPOBST,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR           CI P_value
1 URCOMPOBSTYes 1.32 (0.8 - 2.17)    0.27
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.2701046
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ URCOMPOBST + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1           URCOMPOBSTYes 6.20   (4.09 - 9.4)   0.000
2                      PS 2.20 (0.43 - 11.33)   0.346
3 TRTn2Lich-Gregoir group 0.06  (0.02 - 0.16)   0.000
4              CATHPERIOD 0.96  (0.92 - 1.01)   0.138
5                STENTYes 0.25  (0.09 - 0.68)   0.006
6                 OPRTIME 1.01     (1 - 1.02)   0.190
7                HOSPTIME 1.07  (1.02 - 1.11)   0.004
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 3.464412e-01 2.482688e-08 1.378134e-01 6.329719e-03
[6] 1.896316e-01 3.808525e-03
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPOBST
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.644"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.532 - 0.644 - 0.739"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.063"
> 
>

 
10.C.3 ILEUS
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ ILEUS,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  ILEUSYes 2.52 (0.97 - 6.57)   0.058
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.05812301
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ ILEUS + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1                ILEUSYes 0.41  (0.33 - 0.52)   0.000
2                      PS 2.11 (0.44 - 10.13)   0.350
3 TRTn2Lich-Gregoir group 0.08  (0.03 - 0.22)   0.000
4              CATHPERIOD 0.96  (0.92 - 1.01)   0.115
5                STENTYes 0.23  (0.09 - 0.62)   0.004
6                 OPRTIME 1.01     (1 - 1.03)   0.158
7                HOSPTIME 1.10  (1.06 - 1.14)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 7.127632e-14 3.496502e-01 7.846260e-07 1.148148e-01 3.704806e-03
[6] 1.576830e-01 9.981483e-08
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ ILEUS
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.627"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.487 - 0.627 - 0.749"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.067"
> 
>

 
10.C.4 URCOMPCVUR

> #NOTE : Use  mdata_clean for the variables: URCOMPCVUR
> library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+   GUER30 ~ URCOMPCVUR,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR             CI P_value
1 URCOMPCVURYes 11.2 (4.96 - 25.26)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 5.908455e-09
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GUER30 ~ URCOMPCVUR + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPCVURYes 5.26 (4.05 - 6.84)   0.000
2                      PS 1.18 (0.21 - 6.52)   0.849
3 TRTn2Lich-Gregoir group 0.05 (0.02 - 0.16)   0.000
4              CATHPERIOD 0.94  (0.9 - 0.97)   0.000
5                STENTYes 0.55 (0.48 - 0.63)   0.000
6                 OPRTIME 1.00 (0.99 - 1.02)   0.651
7                HOSPTIME 1.08 (1.05 - 1.12)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 8.487479e-01 1.369592e-07 1.200536e-04 0.000000e+00
[6] 6.508459e-01 2.588307e-08
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ URCOMPCVUR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.942"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.822 - 0.943 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>
> 
10.C.5 URCOMPINJ
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ URCOMPINJ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR            CI P_value
1 URCOMPINJYes 9.83 (3.93 - 24.6)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 1.030832e-06
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ URCOMPINJ + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR             CI P_value
1            URCOMPINJYes 12.48 (3.71 - 41.99)   0.000
2                      PS  1.80   (0.4 - 8.19)   0.446
3 TRTn2Lich-Gregoir group  0.08   (0.04 - 0.2)   0.000
4              CATHPERIOD  0.97  (0.92 - 1.02)   0.242
5                STENTYes  0.19  (0.07 - 0.56)   0.002
6                 OPRTIME  1.01     (1 - 1.02)   0.144
7                HOSPTIME  1.04     (1 - 1.08)   0.036
> 
> # Display the p-value with more precision
> print(p_values)
[1] 4.547101e-05 4.459790e-01 3.021880e-08 2.421183e-01 2.335624e-03
[6] 1.437404e-01 3.647106e-02
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPINJ
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.914"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.794 - 0.919 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>


 
10.C.6 INCCOMPINF
 > 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+   GUER30 ~ INCCOMPINF,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR          CI P_value
1 INCCOMPINFYes 4.37 (2.9 - 6.6)       0
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.055356e-12
> 
> # -----------------
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GUER30  ~ INCCOMPINF + PS + TRTn2 + STENT + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "STENTYes"               
[5] "CATHPERIOD"              "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           INCCOMPINFYes 3.05 (2.03 - 4.57)   0.000
2                      PS 1.74 (0.34 - 8.79)   0.503
3 TRTn2Lich-Gregoir group 0.08 (0.03 - 0.22)   0.000
4                STENTYes 0.28  (0.1 - 0.79)   0.016
5              CATHPERIOD 0.96 (0.91 - 1.01)   0.106
6                 OPRTIME 1.01 (0.99 - 1.02)   0.249
7                HOSPTIME 1.09 (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 6.820980e-08 5.033576e-01 1.001179e-06 1.570064e-02 1.060968e-01
[6] 2.488285e-01 1.654945e-06
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPINF
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.854"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.783 - 0.854 - 0.912"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>


 
10.C.7 INCCOMPBLEED

> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ INCCOMPBLEED,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
        Covariate   OR            CI P_value
1 INCCOMPBLEEDYes 1.26 (0.51 - 3.15)   0.617
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.616534
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ INCCOMPBLEED + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"         "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1         INCCOMPBLEEDYes 0.85 (0.58 - 1.25)   0.419
2                      PS 1.90 (0.37 - 9.69)   0.441
3 TRTn2Lich-Gregoir group 0.08 (0.03 - 0.23)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.122
5                STENTYes 0.25  (0.1 - 0.67)   0.006
6                 OPRTIME 1.01 (0.99 - 1.03)   0.206
7                HOSPTIME 1.10 (1.06 - 1.14)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 4.190352e-01 4.412660e-01 1.309475e-06 1.222812e-01 5.820429e-03
[6] 2.055284e-01 1.953501e-07
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPBLEED
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.495"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.399 - 0.497 - 0.589"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.877"
> 
> 
> 
>

 
10.C.8 BLDCOMPVOID
> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDCOMPVOID,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPVOIDYes 2.02 (0.51 - 7.92)   0.314
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.313649
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDCOMPVOID + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1          BLDCOMPVOIDYes 4.78 (0.35 - 66.12)   0.243
2                      PS 1.69  (0.37 - 7.75)   0.499
3 TRTn2Lich-Gregoir group 0.08  (0.03 - 0.21)   0.000
4              CATHPERIOD 0.95     (0.91 - 1)   0.053
5                STENTYes 0.26   (0.1 - 0.71)   0.008
6                 OPRTIME 1.01  (0.99 - 1.03)   0.224
7                HOSPTIME 1.11  (1.06 - 1.16)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.433945e-01 4.987255e-01 4.344673e-07 5.250312e-02 8.065948e-03
[6] 2.235704e-01 9.191379e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPVOID
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.705"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.543 - 0.71 - 0.841"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.015"
> 
> 
> 
>

 
10.C.9 BLDCOMPLEAK
> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDCOMPLEAK,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 BLDCOMPLEAKYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDCOMPLEAK + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
Warning messages:
1: In sqrt(diag(covmat)) : NaNs produced
2: In sqrt(diag(object$vbeta)) : NaNs produced
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPLEAKYes 0.00   (NaN - NaN)     NaN
2                      PS 1.60 (0.36 - 7.09)   0.537
3 TRTn2Lich-Gregoir group 0.12 (0.05 - 0.31)   0.000
4              CATHPERIOD 0.96    (0.92 - 1)   0.077
5                STENTYes 0.31 (0.12 - 0.81)   0.017
6                 OPRTIME 1.01    (1 - 1.03)   0.054
7                HOSPTIME 1.11 (1.07 - 1.16)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1]          NaN 5.369357e-01 1.052826e-05 7.732765e-02 1.665683e-02
[6] 5.362097e-02 4.324224e-07
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPLEAK
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
>

 
10.C.10 URCOMPSTEN
> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ URCOMPSTEN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 URCOMPSTENYes 0.41 (0.19 - 0.87)    0.02
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.01996409
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ URCOMPSTEN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPSTENYes 0.26 (0.19 - 0.36)   0.000
2                      PS 2.10 (0.45 - 9.69)   0.344
3 TRTn2Lich-Gregoir group 0.09 (0.03 - 0.24)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.107
5                STENTYes 0.27 (0.09 - 0.75)   0.012
6                 OPRTIME 1.01 (0.99 - 1.03)   0.194
7                HOSPTIME 1.10 (1.06 - 1.14)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 3.435281e-01 2.596990e-06 1.074579e-01 1.183428e-02
[6] 1.941355e-01 3.023278e-07
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPSTEN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.682"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.531 - 0.682 - 0.827"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.028"
> 
> 
> 
>


 
10.C.11 INCCOMPSCAR
> #NOTE : Remove STENT from the multivariable analysis for the variable INCCOMPSCAR
> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ INCCOMPSCAR,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 INCCOMPSCARYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GUER30 ~ INCCOMPSCAR + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
Warning messages:
1: In sqrt(diag(covmat)) : NaNs produced
2: In sqrt(diag(object$vbeta)) : NaNs produced
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1          INCCOMPSCARYes 0.00    (NaN - NaN)     NaN
2                      PS 2.78 (0.55 - 14.09)   0.218
3 TRTn2Lich-Gregoir group 0.14   (0.03 - 0.6)   0.008
4              CATHPERIOD 0.94  (0.91 - 0.97)   0.001
5                 OPRTIME 1.02  (0.99 - 1.04)   0.170
6                HOSPTIME 1.09  (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1]          NaN 2.179385e-01 7.998578e-03 6.654942e-04 1.699597e-01
[6] 4.022313e-06
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPSCAR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
10.C.12 ANASTOMO
> #NOTE : Remove STENT from the multivariable analysis for the variable ANASTOMO
#C
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+   GUER30 ~ ANASTOMO,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR            CI P_value
1 ANASTOMOYes 1.17 (0.46 - 2.97)   0.736
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.735603
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GUER30 ~ ANASTOMO + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1             ANASTOMOYes 0.73  (0.23 - 2.31)   0.591
2                      PS 2.38 (0.45 - 12.59)   0.308
3 TRTn2Lich-Gregoir group 0.13  (0.03 - 0.62)   0.010
4              CATHPERIOD 0.94   (0.9 - 0.98)   0.001
5                 OPRTIME 1.01  (0.99 - 1.04)   0.231
6                HOSPTIME 1.09  (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 5.913103e-01 3.080969e-01 1.037110e-02 1.288962e-03 2.312877e-01
[6] 3.772149e-06
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ANASTOMO
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.485"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.1 - 0.486 - 0.724"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.91"
> 
>


 
10.C.13 BLDSPASM
> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDSPASM,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR            CI P_value
1 BLDSPASMYes 2.91 (1.53 - 5.54)   0.001
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.001109153
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ BLDSPASM + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1             BLDSPASMYes 4.12 (2.16 - 7.83)   0.000
2                      PS 1.63 (0.38 - 7.04)   0.510
3 TRTn2Lich-Gregoir group 0.07 (0.03 - 0.17)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.02)   0.164
5                STENTYes 0.20 (0.06 - 0.61)   0.005
6                 OPRTIME 1.01    (1 - 1.03)   0.168
7                HOSPTIME 1.11 (1.06 - 1.16)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.634046e-05 5.100886e-01 2.321289e-09 1.642123e-01 4.875920e-03
[6] 1.677531e-01 2.668398e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDSPASM
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.795"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.735 - 0.796 - 0.849"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
>

 
10.C.14 HEMAT
> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ HEMAT,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  HEMATYes 1.42 (0.65 - 3.12)    0.38
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.3800914
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ HEMAT + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                HEMATYes 1.07 (0.44 - 2.62)   0.886
2                      PS 1.92 (0.41 - 9.06)   0.409
3 TRTn2Lich-Gregoir group 0.09 (0.03 - 0.24)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.125
5                STENTYes 0.26  (0.1 - 0.69)   0.007
6                 OPRTIME 1.01 (0.99 - 1.03)   0.217
7                HOSPTIME 1.10 (1.07 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 8.856147e-01 4.092807e-01 2.215196e-06 1.247738e-01 7.261419e-03
[6] 2.169850e-01 1.739077e-10
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ HEMAT
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.627"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.55 - 0.628 - 0.704"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.002"
> 
> 
> 
>


 
10.C.15 UTIpostop
> #C
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER30 ~ UTIpostop,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR            CI P_value
1 UTIpostopUTI 1.63 (0.78 - 3.41)   0.195
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.1954651
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER30 ~ UTIpostop + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1            UTIpostopUTI 0.88  (0.71 - 1.1)   0.261
2                      PS 1.90 (0.39 - 9.25)   0.425
3 TRTn2Lich-Gregoir group 0.08 (0.03 - 0.23)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.115
5                STENTYes 0.25 (0.09 - 0.69)   0.007
6                 OPRTIME 1.01 (0.99 - 1.03)   0.201
7                HOSPTIME 1.10 (1.06 - 1.14)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.611171e-01 4.252625e-01 1.161433e-06 1.154513e-01 6.857163e-03
[6] 2.005785e-01 8.582831e-08
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ UTIpostop
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No UTI, case = UTI
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.564"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.487 - 0.564 - 0.642"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.104"
 
==================================================================================================

10. D.  Association with: GUER90

 
10.D.0 CLAVIENCLASS2
> #NOTE : Use  mdata_clean for the variables: CLAVIENCLASS2

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ CLAVIENCLASS2,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR            CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 0.97 (0.57 - 1.67)   0.923
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.923452
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ CLAVIENCLASS2 + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5" "PS"                            
[3] "TRTn2Lich-Gregoir group"        "CATHPERIOD"                    
[5] "STENTYes"                       "OPRTIME"                       
[7] "HOSPTIME"                      
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR            CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 1.04 (0.55 - 1.97)   0.914
2                             PS 0.19 (0.06 - 0.53)   0.002
3        TRTn2Lich-Gregoir group 0.04 (0.03 - 0.05)   0.000
4                     CATHPERIOD 0.93 (0.92 - 0.94)   0.000
5                       STENTYes 0.43 (0.37 - 0.51)   0.000
6                        OPRTIME 1.00    (0.99 - 1)   0.004
7                       HOSPTIME 1.08  (1.07 - 1.1)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.913517107 0.001750775 0.000000000 0.000000000 0.000000000
[6] 0.004130549 0.000000000
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ CLAVIENCLASS2
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = Clavien grade 1-2, case = Clavien grade 3-5
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.501"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.388 - 0.497 - 0.609"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.836"
> 
>

 
10.D.1 BLDCOMPRETN

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDCOMPRETN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPRETNYes 1.45 (0.37 - 5.64)   0.593
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.5926033
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDCOMPRETN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPRETNYes 1.44 (0.41 - 5.07)   0.573
2                      PS 0.55  (0.1 - 2.98)   0.485
3 TRTn2Lich-Gregoir group 0.12 (0.04 - 0.39)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.098
5                STENTYes 0.20 (0.08 - 0.54)   0.001
6                 OPRTIME 1.01 (0.99 - 1.03)   0.249
7                HOSPTIME 1.09 (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 5.729560e-01 4.851198e-01 3.631345e-04 9.837086e-02 1.433489e-03
[6] 2.494041e-01 9.527001e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPRETN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.669"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.582 - 0.669 - 0.743"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>




 
10.D.2 URCOMPOBST
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ URCOMPOBST,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 URCOMPOBSTYes 1.15 (0.67 - 1.99)   0.608
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.6084116
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ URCOMPOBST + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPOBSTYes 3.39 (2.51 - 4.58)   0.000
2                      PS 0.58  (0.1 - 3.35)   0.541
3 TRTn2Lich-Gregoir group 0.10 (0.03 - 0.32)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.118
5                STENTYes 0.20 (0.07 - 0.55)   0.002
6                 OPRTIME 1.01 (0.99 - 1.03)   0.224
7                HOSPTIME 1.07 (1.02 - 1.11)   0.003
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.443290e-15 5.412609e-01 1.072320e-04 1.183031e-01 1.848320e-03
[6] 2.240862e-01 2.972157e-03
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPOBST
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.634"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.514 - 0.637 - 0.734"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.097"
> 
>

 
10.D.3 ILEUS
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ ILEUS,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR            CI P_value
1  ILEUSYes 2.19 (0.79 - 6.05)   0.131
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.1308695
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ ILEUS + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                ILEUSYes 0.34 (0.27 - 0.43)   0.000
2                      PS 0.60 (0.11 - 3.29)   0.559
3 TRTn2Lich-Gregoir group 0.12 (0.04 - 0.39)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.105
5                STENTYes 0.18 (0.06 - 0.49)   0.001
6                 OPRTIME 1.01 (0.99 - 1.03)   0.183
7                HOSPTIME 1.09 (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 5.590218e-01 4.682576e-04 1.048893e-01 7.936960e-04
[6] 1.830331e-01 1.578383e-05
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ ILEUS
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.621"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.486 - 0.619 - 0.737"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.098"
> 
>

 
10.D.4 URCOMPCVUR

> #NOTE : Use  mdata_clean for the variables: URCOMPCVUR
> library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+   GUER90 ~ URCOMPCVUR,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR             CI P_value
1 URCOMPCVURYes 9.74 (4.09 - 23.22)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 2.776138e-07
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GUER90 ~ URCOMPCVUR + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPCVURYes 4.30 (3.09 - 5.98)   0.000
2                      PS 0.33 (0.05 - 2.09)   0.237
3 TRTn2Lich-Gregoir group 0.07 (0.02 - 0.29)   0.000
4              CATHPERIOD 0.93 (0.89 - 0.97)   0.000
5                STENTYes 0.46 (0.39 - 0.54)   0.000
6                 OPRTIME 1.00 (0.99 - 1.02)   0.774
7                HOSPTIME 1.07 (1.04 - 1.11)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.0000000000 0.2368815015 0.0002113687 0.0002958090 0.0000000000
[6] 0.7744385722 0.0001207845
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ URCOMPCVUR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.942"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.82 - 0.943 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>
> 

10.D.5 URCOMPINJ
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ URCOMPINJ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR            CI P_value
1 URCOMPINJYes 3.17 (1.19 - 8.43)   0.021
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.02087377
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ URCOMPINJ + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1            URCOMPINJYes 2.22 (0.75 - 6.59)   0.151
2                      PS 0.53  (0.1 - 2.73)   0.451
3 TRTn2Lich-Gregoir group 0.13 (0.04 - 0.38)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.02)   0.153
5                STENTYes 0.18 (0.06 - 0.56)   0.003
6                 OPRTIME 1.01 (0.99 - 1.03)   0.219
7                HOSPTIME 1.07 (1.03 - 1.11)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.1507805670 0.4510757793 0.0002581076 0.1525607916 0.0027461760
[6] 0.2187645421 0.0004623946
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPINJ
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.77"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.671 - 0.769 - 0.885"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.038"
> 
>


 
10.D.6 INCCOMPINF
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ INCCOMPINF,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 INCCOMPINFYes 3.16 (1.93 - 5.19)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 5.08316e-06
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ INCCOMPINF + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           INCCOMPINFYes 1.72 (1.35 - 2.19)   0.000
2                      PS 0.53 (0.09 - 2.96)   0.469
3 TRTn2Lich-Gregoir group 0.12 (0.04 - 0.39)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.103
5                STENTYes 0.21  (0.08 - 0.6)   0.004
6                 OPRTIME 1.01 (0.99 - 1.03)   0.262
7                HOSPTIME 1.08 (1.04 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.373012e-05 4.691630e-01 4.002094e-04 1.027578e-01 3.578463e-03
[6] 2.619608e-01 4.240189e-05
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPINF
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.805"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.724 - 0.807 - 0.88"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
>

 
10.D.7 INCCOMPBLEED
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ INCCOMPBLEED,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
        Covariate   OR            CI P_value
1 INCCOMPBLEEDYes 1.42 (0.55 - 3.68)   0.472
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.4715081
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ INCCOMPBLEED + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"         "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1         INCCOMPBLEEDYes 0.95 (0.62 - 1.46)   0.809
2                      PS 0.55  (0.1 - 3.17)   0.505
3 TRTn2Lich-Gregoir group 0.13  (0.04 - 0.4)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.113
5                STENTYes 0.20 (0.07 - 0.54)   0.002
6                 OPRTIME 1.01 (0.99 - 1.03)   0.237
7                HOSPTIME 1.09 (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 8.085590e-01 5.049688e-01 4.721931e-04 1.130277e-01 1.580858e-03
[6] 2.367910e-01 1.054575e-05
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPBLEED
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.596"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.511 - 0.597 - 0.679"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.07"
> 
> 
> 
> 
>


 
10.D.8 BLDCOMPVOID
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDCOMPVOID,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPVOIDYes 2.59 (0.85 - 7.83)   0.093
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.09263834
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDCOMPVOID + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1          BLDCOMPVOIDYes 7.28 (0.86 - 61.65)   0.068
2                      PS 0.47   (0.09 - 2.5)   0.376
3 TRTn2Lich-Gregoir group 0.12  (0.04 - 0.38)   0.000
4              CATHPERIOD 0.95      (0.9 - 1)   0.037
5                STENTYes 0.21  (0.07 - 0.57)   0.002
6                 OPRTIME 1.01  (0.99 - 1.03)   0.260
7                HOSPTIME 1.10  (1.05 - 1.15)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.0684523430 0.3758637300 0.0003830580 0.0371474849 0.0024337760
[6] 0.2599320387 0.0000156774
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPVOID
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.73"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.592 - 0.731 - 0.85"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.01"
> 
> 
> 
> 
>


 
10.D.9 BLDCOMPLEAK

> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDCOMPLEAK,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 BLDCOMPLEAKYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDCOMPLEAK + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
Warning messages:
1: In sqrt(diag(covmat)) : NaNs produced
2: In sqrt(diag(object$vbeta)) : NaNs produced
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          BLDCOMPLEAKYes 0.00   (NaN - NaN)     NaN
2                      PS 0.46 (0.09 - 2.33)   0.352
3 TRTn2Lich-Gregoir group 0.18 (0.06 - 0.54)   0.002
4              CATHPERIOD 0.96    (0.91 - 1)   0.066
5                STENTYes 0.24 (0.09 - 0.64)   0.004
6                 OPRTIME 1.02    (1 - 1.03)   0.077
7                HOSPTIME 1.10 (1.06 - 1.15)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1]          NaN 3.519591e-01 2.104640e-03 6.592032e-02 4.390111e-03
[6] 7.743830e-02 5.166844e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPLEAK
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
10.D.10 URCOMPSTEN
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ URCOMPSTEN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate  OR            CI P_value
1 URCOMPSTENYes 0.6 (0.28 - 1.31)   0.204
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.203878
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ URCOMPSTEN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPSTENYes 0.46 (0.34 - 0.62)   0.000
2                      PS 0.59 (0.11 - 3.11)   0.533
3 TRTn2Lich-Gregoir group 0.13 (0.04 - 0.41)   0.001
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.102
5                STENTYes 0.21 (0.07 - 0.58)   0.003
6                 OPRTIME 1.01 (0.99 - 1.03)   0.228
7                HOSPTIME 1.09 (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 7.474058e-07 5.333345e-01 5.772219e-04 1.015667e-01 2.999469e-03
[6] 2.275799e-01 1.384228e-05
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPSTEN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.643"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.484 - 0.642 - 0.794"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.08"
> 
> 
> 
> 
>

 
10.D.11 INCCOMPSCAR
> #NOTE : Remove STENT from the multivariable analysis for the variable INCCOMPSCAR
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ INCCOMPSCAR,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 INCCOMPSCARYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GUER90 ~ INCCOMPSCAR + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1          INCCOMPSCARYes 0.00       (0 - 0)   0.000
2                      PS 0.90 (0.14 - 5.73)   0.911
3 TRTn2Lich-Gregoir group 0.23 (0.05 - 1.15)   0.073
4              CATHPERIOD 0.93  (0.9 - 0.97)   0.000
5                 OPRTIME 1.02 (0.99 - 1.04)   0.183
6                HOSPTIME 1.08 (1.03 - 1.12)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.0000000000 0.9109498540 0.0733001299 0.0003445344 0.1825153771
[6] 0.0002155960
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPSCAR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
10.D.12 ANASTOMO
> #NOTE : Remove STENT from the multivariable analysis for the variable ANASTOMO
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ ANASTOMO,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR            CI P_value
1 ANASTOMOYes 1.03 (0.39 - 2.75)   0.952
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.9521615
> 
> > 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   GUER90 ~ ANASTOMO + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1             ANASTOMOYes 0.61 (0.18 - 2.05)   0.422
2                      PS 0.79 (0.12 - 5.25)   0.811
3 TRTn2Lich-Gregoir group 0.22  (0.04 - 1.2)   0.080
4              CATHPERIOD 0.93 (0.89 - 0.97)   0.001
5                 OPRTIME 1.01 (0.99 - 1.04)   0.246
6                HOSPTIME 1.08 (1.04 - 1.12)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.4219313681 0.8107161927 0.0804511353 0.0007647135 0.2461768970
[6] 0.0001813883
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ANASTOMO
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.493"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.159 - 0.497 - 0.717"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.881"
> 
>

 
10.D.13 BLDSPASM
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDSPASM,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR            CI P_value
1 BLDSPASMYes 2.35 (1.17 - 4.73)   0.016
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.0162468
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ BLDSPASM + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1             BLDSPASMYes 2.62 (1.37 - 5.02)   0.004
2                      PS 0.49  (0.1 - 2.39)   0.375
3 TRTn2Lich-Gregoir group 0.12 (0.04 - 0.35)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.144
5                STENTYes 0.17 (0.06 - 0.53)   0.002
6                 OPRTIME 1.01 (0.99 - 1.03)   0.214
7                HOSPTIME 1.09 (1.04 - 1.14)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 3.615813e-03 3.750518e-01 8.898321e-05 1.441214e-01 1.967023e-03
[6] 2.138097e-01 6.846093e-05
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDSPASM
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.777"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.716 - 0.777 - 0.83"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
>


 
10.D.14 HEMAT
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ HEMAT,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate   OR           CI P_value
1  HEMATYes 1.21 (0.52 - 2.8)   0.655
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.6551097
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ HEMAT + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                HEMATYes 0.82 (0.33 - 2.04)   0.671
2                      PS 0.56  (0.1 - 3.01)   0.499
3 TRTn2Lich-Gregoir group 0.12 (0.04 - 0.39)   0.000
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.105
5                STENTYes 0.20 (0.07 - 0.56)   0.002
6                 OPRTIME 1.01 (0.99 - 1.03)   0.243
7                HOSPTIME 1.09 (1.06 - 1.12)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 6.711082e-01 4.985350e-01 3.861024e-04 1.049067e-01 2.013400e-03
[6] 2.425673e-01 1.809693e-08
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ HEMAT
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.545"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.459 - 0.545 - 0.63"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.334"
> 
> 
> 
> 
>

 
10.D.15 UTIpostop
> #D
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    GUER90 ~ UTIpostop,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate  OR           CI P_value
1 UTIpostopUTI 1.6 (0.73 - 3.5)   0.241
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.2413235
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    GUER90 ~ UTIpostop + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1            UTIpostopUTI 0.81 (0.64 - 1.03)   0.092
2                      PS 0.54  (0.1 - 2.99)   0.482
3 TRTn2Lich-Gregoir group 0.13  (0.04 - 0.4)   0.001
4              CATHPERIOD 0.96 (0.91 - 1.01)   0.104
5                STENTYes 0.20 (0.07 - 0.55)   0.002
6                 OPRTIME 1.01 (0.99 - 1.03)   0.231
7                HOSPTIME 1.09 (1.05 - 1.13)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 9.203204e-02 4.815309e-01 5.246532e-04 1.043685e-01 1.950709e-03
[6] 2.309888e-01 8.608851e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ UTIpostop
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No UTI, case = UTI
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.59"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.514 - 0.589 - 0.663"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.024"

==================================================================================================
 
10. E.  Association with: PROC365

 
10.E.0 CLAVIENCLASS2
> #NOTE : Use  mdata_clean for the variables: CLAVIENCLASS2
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ CLAVIENCLASS2,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate    OR             CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 11.83 (7.26 - 19.28)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ CLAVIENCLASS2 + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "CLAVIENCLASS2Clavien grade 3-5" "PS"                            
[3] "TRTn2Lich-Gregoir group"        "CATHPERIOD"                    
[5] "STENTYes"                       "OPRTIME"                       
[7] "HOSPTIME"                      
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                       Covariate   OR             CI P_value
1 CLAVIENCLASS2Clavien grade 3-5 9.76 (5.15 - 18.47)   0.000
2                             PS 0.94  (0.22 - 3.91)   0.929
3        TRTn2Lich-Gregoir group 0.65    (0.6 - 0.7)   0.000
4                     CATHPERIOD 1.01  (0.95 - 1.07)   0.747
5                       STENTYes 1.04  (0.81 - 1.35)   0.743
6                        OPRTIME 1.00     (0.99 - 1)   0.008
7                       HOSPTIME 1.14   (1.08 - 1.2)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 2.611356e-12 9.294391e-01 0.000000e+00 7.470432e-01 7.425048e-01
[6] 8.304270e-03 6.732342e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ CLAVIENCLASS2
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = Clavien grade 1-2, case = Clavien grade 3-5
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
> 
> 
10.E.1 BLDCOMPRETN

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDCOMPRETN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR            CI P_value
1 BLDCOMPRETNYes 0.56 (0.34 - 0.92)   0.023
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.02259409
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDCOMPRETN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPRETNYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1          BLDCOMPRETNYes 0.53  (0.26 - 1.08)   0.080
2                      PS 1.32 (0.11 - 15.07)   0.825
3 TRTn2Lich-Gregoir group 1.01  (0.46 - 2.24)   0.983
4              CATHPERIOD 0.97   (0.9 - 1.04)   0.354
5                STENTYes 1.10  (0.36 - 3.37)   0.870
6                 OPRTIME 1.00  (0.99 - 1.01)   0.909
7                HOSPTIME 1.28  (1.16 - 1.43)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 8.035726e-02 8.253729e-01 9.831123e-01 3.539152e-01 8.697580e-01
[6] 9.087203e-01 3.226471e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPRETN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.706"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.624 - 0.709 - 0.784"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>

 
10.E.2 URCOMPOBST

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ URCOMPOBST,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 URCOMPOBSTYes 3.83 (2.42 - 6.08)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 1.126865e-08
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ URCOMPOBST + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPOBSTYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           URCOMPOBSTYes 1.89 (0.85 - 4.19)   0.118
2                      PS 1.34 (0.1 - 17.22)   0.822
3 TRTn2Lich-Gregoir group 0.90  (0.4 - 2.04)   0.807
4              CATHPERIOD 0.97  (0.9 - 1.04)   0.377
5                STENTYes 1.09  (0.4 - 2.97)   0.859
6                 OPRTIME 1.00 (0.99 - 1.01)   0.916
7                HOSPTIME 1.28 (1.15 - 1.42)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.176268e-01 8.220190e-01 8.066200e-01 3.773426e-01 8.587871e-01
[6] 9.157107e-01 3.620022e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPOBST
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.796"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.662 - 0.796 - 0.908"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>

 
10.E.3 ILEUS
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ ILEUS,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
  Covariate  OR            CI P_value
1  ILEUSYes 1.2 (0.75 - 1.92)   0.437
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.4368477
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ ILEUS + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ILEUSYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1                ILEUSYes 1.09 (0.76 - 1.58)   0.629
2                      PS 1.30 (0.1 - 16.65)   0.841
3 TRTn2Lich-Gregoir group 1.00 (0.47 - 2.14)   0.997
4              CATHPERIOD 0.97  (0.9 - 1.04)   0.359
5                STENTYes 1.14 (0.38 - 3.37)   0.815
6                 OPRTIME 1.00 (0.99 - 1.01)   0.935
7                HOSPTIME 1.28 (1.15 - 1.43)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 6.293595e-01 8.409099e-01 9.968671e-01 3.594101e-01 8.151019e-01
[6] 9.345421e-01 5.809972e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ ILEUS
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.772"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.675 - 0.773 - 0.855"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>

 
10.E.4 URCOMPCVUR

> #NOTE : Use  mdata_clean for the variables: URCOMPCVUR
> library(MatchIt)
> 
> m.out <- matchit(TRTn2 ~ PREOPVURGRADE + HISTOINJ + BMI  + AGS + PREOPRNPLN + PREOPRNSCR + VURSIDE + VURPHASE 
+ + PREOPEPISODEn + PREOPTYPEUn + SURGTECHn2 + GENDER + UDR7M + SURGIND, data = data, method = "nearest", caliper = caliper_width)
Warning message:
Fewer control units than treated units; not all treated units will get a match. 

> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+   PROC365 ~ URCOMPCVUR,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate OR             CI P_value
1 URCOMPCVURYes 11 (7.28 - 16.63)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   PROC365 ~ URCOMPCVUR + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata_clean,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPCVURYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR             CI P_value
1           URCOMPCVURYes 11.50 (6.84 - 19.35)   0.000
2                      PS  0.92 (0.06 - 15.34)   0.956
3 TRTn2Lich-Gregoir group  1.13  (0.42 - 3.02)   0.807
4              CATHPERIOD  0.96  (0.91 - 1.02)   0.183
5                STENTYes  1.65  (1.46 - 1.86)   0.000
6                 OPRTIME  1.00  (0.99 - 1.01)   0.758
7                HOSPTIME  1.27   (1.15 - 1.4)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 9.562915e-01 8.066094e-01 1.833434e-01 7.771561e-16
[6] 7.582472e-01 2.751728e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata_clean$ URCOMPCVUR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.991"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.978 - 0.991 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>
> 

10.E.5 URCOMPINJ
> 
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ URCOMPINJ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate OR              CI P_value
1 URCOMPINJYes 40 (25.67 - 62.33)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ URCOMPINJ + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPINJYes"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR              CI P_value
1            URCOMPINJYes 35.29 (20.65 - 60.32)   0.000
2                      PS  0.83  (0.05 - 12.89)   0.895
3 TRTn2Lich-Gregoir group  1.40   (0.43 - 4.56)   0.579
4              CATHPERIOD  1.00   (0.93 - 1.07)   0.926
5                STENTYes  0.40   (0.16 - 1.04)   0.060
6                 OPRTIME  1.00   (0.99 - 1.01)   0.905
7                HOSPTIME  1.22   (1.11 - 1.35)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 8.950005e-01 5.791166e-01 9.263716e-01 5.952733e-02
[6] 9.050799e-01 6.429483e-05
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPINJ
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.998"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.99 - 0.998 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>

 
10.E.6 INCCOMPINF
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ INCCOMPINF,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate   OR            CI P_value
1 INCCOMPINFYes 1.66 (1.17 - 2.36)   0.004
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.004380991
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ INCCOMPINF + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPINFYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1           INCCOMPINFYes 0.98 (0.62 - 1.54)   0.935
2                      PS 1.31 (0.1 - 17.22)   0.838
3 TRTn2Lich-Gregoir group 0.99 (0.47 - 2.12)   0.989
4              CATHPERIOD 0.97  (0.9 - 1.04)   0.359
5                STENTYes 1.12 (0.38 - 3.31)   0.833
6                 OPRTIME 1.00 (0.99 - 1.01)   0.908
7                HOSPTIME 1.28 (1.16 - 1.43)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 9.349631e-01 8.378827e-01 9.885978e-01 3.585766e-01 8.325359e-01
[6] 9.077891e-01 3.124319e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPINF
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.651"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.54 - 0.653 - 0.757"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0.012"
> 
> 
> 
> 
> 
>

 
10.E.7 INCCOMPBLEED
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ INCCOMPBLEED,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
        Covariate  OR             CI P_value
1 INCCOMPBLEEDYes 0.5 (0.02 - 10.78)   0.661
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.6608559
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ INCCOMPBLEED + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPBLEEDYes"         "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1         INCCOMPBLEEDYes 0.55  (0.03 - 8.71)   0.669
2                      PS 1.24 (0.08 - 18.33)   0.877
3 TRTn2Lich-Gregoir group 1.00  (0.46 - 2.16)   0.991
4              CATHPERIOD 0.97   (0.9 - 1.04)   0.355
5                STENTYes 1.07   (0.4 - 2.84)   0.890
6                 OPRTIME 1.00  (0.99 - 1.01)   0.903
7                HOSPTIME 1.28   (1.16 - 1.4)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 6.687738e-01 8.770314e-01 9.907153e-01 3.549130e-01 8.904947e-01
[6] 9.025081e-01 1.545357e-07
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ INCCOMPBLEED
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.743"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.671 - 0.745 - 0.811"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
>

 
10.E.8 BLDCOMPVOID
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDCOMPVOID,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate   OR             CI P_value
1 BLDCOMPVOIDYes 2.11 (0.14 - 30.89)   0.586
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.5857979
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDCOMPVOID + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPVOIDYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1          BLDCOMPVOIDYes 3.31 (0.25 - 43.53)   0.363
2                      PS 1.16 (0.09 - 14.23)   0.910
3 TRTn2Lich-Gregoir group 0.98  (0.44 - 2.17)   0.955
4              CATHPERIOD 0.96  (0.91 - 1.02)   0.212
5                STENTYes 1.21  (0.47 - 3.11)   0.699
6                 OPRTIME 1.00  (0.99 - 1.01)   0.942
7                HOSPTIME 1.30  (1.19 - 1.41)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 3.626116e-01 9.100043e-01 9.551020e-01 2.119032e-01 6.986860e-01
[6] 9.423504e-01 1.165836e-09
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPVOID
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.908"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.811 - 0.909 - 0.975"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
>

 
10.E.9 BLDCOMPLEAK
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDCOMPLEAK,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate OR      CI P_value
1 BLDCOMPLEAKYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDCOMPLEAK + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
Warning messages:
1: In sqrt(diag(covmat)) : NaNs produced
2: In sqrt(diag(object$vbeta)) : NaNs produced
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDCOMPLEAKYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1          BLDCOMPLEAKYes 0.00    (NaN - NaN)     NaN
2                      PS 1.03 (0.03 - 31.16)   0.987
3 TRTn2Lich-Gregoir group 1.47  (0.52 - 4.11)   0.465
4              CATHPERIOD 0.96   (0.9 - 1.03)   0.237
5                STENTYes 0.73  (0.45 - 1.18)   0.196
6                 OPRTIME 1.00  (0.99 - 1.01)   0.624
7                HOSPTIME 2.11  (1.14 - 3.88)   0.017
> 
> # Display the p-value with more precision
> print(p_values)
[1]        NaN 0.98691115 0.46476498 0.23663815 0.19570313 0.62383483
[7] 0.01705534
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDCOMPLEAK
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
>

 
10.E.10 URCOMPSTEN
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ URCOMPSTEN,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
      Covariate OR      CI P_value
1 URCOMPSTENYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ URCOMPSTEN + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "URCOMPSTENYes"           "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1           URCOMPSTENYes 0.00        (0 - 0)   0.000
2                      PS 1.40 (0.12 - 16.98)   0.790
3 TRTn2Lich-Gregoir group 1.02  (0.47 - 2.18)   0.966
4              CATHPERIOD 0.97   (0.9 - 1.04)   0.354
5                STENTYes 1.12  (0.38 - 3.29)   0.843
6                 OPRTIME 1.00  (0.99 - 1.01)   0.883
7                HOSPTIME 1.28  (1.15 - 1.42)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 7.901983e-01 9.663854e-01 3.539661e-01 8.425958e-01
[6] 8.826119e-01 3.403096e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ URCOMPSTEN
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
>


 
10.E.11 INCCOMPSCAR
> #NOTE : Remove STENT from the multivariable analysis for the variable INCCOMPSCAR
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ INCCOMPSCAR,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
       Covariate    OR              CI P_value
1 INCCOMPSCARYes 21.91 (1.37 - 351.14)   0.029
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.02919434
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   PROC365  ~ INCCOMPSCAR + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "INCCOMPSCARYes"          "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate    OR             CI P_value
1          INCCOMPSCARYes 23.92   (0.85 - 671)   0.062
2                      PS  0.79 (0.03 - 22.04)   0.888
3 TRTn2Lich-Gregoir group  0.91  (0.38 - 2.13)   0.821
4              CATHPERIOD  0.97  (0.91 - 1.03)   0.323
5                 OPRTIME  1.00  (0.99 - 1.01)   0.702
6                HOSPTIME  1.29  (1.16 - 1.43)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 6.197648e-02 8.877587e-01 8.206767e-01 3.230787e-01 7.020450e-01
[6] 2.738049e-06
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$INCCOMPSCAR
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.992"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.98 - 0.992 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
10.E.12 ANASTOMO
> #NOTE : Remove STENT from the multivariable analysis for the variable ANASTOMO
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ ANASTOMO,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate OR      CI P_value
1 ANASTOMOYes  0 (0 - 0)       0
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0
> 
> 
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+   PROC365  ~ ANASTOMO + PS + TRTn2 + CATHPERIOD + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "ANASTOMOYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "OPRTIME"                 "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 6
> print(length(std_errors))
[1] 6
> print(length(p_values))
[1] 6
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1             ANASTOMOYes 0.00        (0 - 0)   0.000
2                      PS 1.25 (0.08 - 19.04)   0.874
3 TRTn2Lich-Gregoir group 0.95  (0.43 - 2.12)   0.905
4              CATHPERIOD 0.97  (0.91 - 1.03)   0.317
5                 OPRTIME 1.00  (0.99 - 1.01)   0.977
6                HOSPTIME 1.28  (1.16 - 1.42)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 0.000000e+00 8.743108e-01 9.051414e-01 3.167194e-01 9.772072e-01
[6] 1.209656e-06
> 
> # -----------
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ANASTOMO
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls > cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
Warning message:
In ci.auc.roc(roc_curve, method = "bootstrap", boot.n = 2000) :
  ci.auc() of a ROC curve with AUC == 1 is always 1-1 and can be misleading.
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 1"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 1 - 1 - 1"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
>

 
10.E.13 BLDSPASM
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDSPASM,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
    Covariate   OR           CI P_value
1 BLDSPASMYes 1.65 (0.9 - 3.03)   0.104
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.1037741
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ BLDSPASM + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "BLDSPASMYes"             "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR            CI P_value
1             BLDSPASMYes 1.44 (0.84 - 2.47)   0.189
2                      PS 1.20 (0.1 - 14.61)   0.889
3 TRTn2Lich-Gregoir group 1.02 (0.48 - 2.19)   0.950
4              CATHPERIOD 0.97 (0.91 - 1.04)   0.386
5                STENTYes 1.09  (0.4 - 2.98)   0.862
6                 OPRTIME 1.00 (0.99 - 1.01)   0.839
7                HOSPTIME 1.27 (1.16 - 1.38)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 1.893385e-01 8.890554e-01 9.504453e-01 3.857530e-01 8.622285e-01
[6] 8.394162e-01 1.862219e-07
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ BLDSPASM
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.793"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.732 - 0.792 - 0.85"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
>


 
10.E.14 HEMAT
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ HEMAT,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ 
> 
> # View the results
> print(results)
  Covariate  OR            CI P_value
1  HEMATYes 1.5 (0.63 - 3.56)   0.358
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.3580188
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ HEMAT + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "HEMATYes"                "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1                HEMATYes 1.11  (0.42 - 2.95)   0.828
2                      PS 1.30 (0.11 - 15.84)   0.836
3 TRTn2Lich-Gregoir group 1.01  (0.46 - 2.19)   0.987
4              CATHPERIOD 0.97   (0.9 - 1.04)   0.371
5                STENTYes 1.13  (0.41 - 3.14)   0.812
6                 OPRTIME 1.00  (0.99 - 1.01)   0.874
7                HOSPTIME 1.28  (1.15 - 1.42)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 8.284502e-01 8.359964e-01 9.868877e-01 3.711621e-01 8.116383e-01
[6] 8.737337e-01 6.363054e-06
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ HEMAT
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No, case = Yes
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.677"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.591 - 0.677 - 0.752"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
> 
> 
> 
> 
> 
>

 
10.E.15 UTIpostop
> #E
> # Fit the GEE model in univariate analysis
> gee_model <- geeglm(
+    PROC365 ~ UTIpostop,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 1
> print(length(std_errors))
[1] 1
> print(length(p_values))
[1] 1
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
     Covariate   OR           CI P_value
1 UTIpostopUTI 2.67 (1.1 - 6.44)   0.029
> 
> # Display the p-value with more precision
> print(p_values) 
[1] 0.0292974
> 
> 
> # Fit the GEE model in multivariate analysis
> gee_model <- geeglm(
+    PROC365 ~ UTIpostop + PS + TRTn2 + CATHPERIOD + STENT + OPRTIME + HOSPTIME ,
+   data = mdata,
+   id = Center,           # Account for clustering by Center
+   family = binomial(link = "logit") # Binary outcome with logit link
+ )
> 
> 
> # Extract the coefficients, standard errors, and p-values
> summary_output <- summary(gee_model)$coefficients
> coefficients <- summary_output[, "Estimate"]
> std_errors <- summary_output[, "Std.err"]
> p_values <- summary_output[, "Pr(>|W|)"]
> 
> # Extract the names of the covariates
> covariate_names <- rownames(summary_output)[-1]  # Removing the intercept
> 
> # Check the names of the coefficients
> print(covariate_names)
[1] "UTIpostopUTI"            "PS"                     
[3] "TRTn2Lich-Gregoir group" "CATHPERIOD"             
[5] "STENTYes"                "OPRTIME"                
[7] "HOSPTIME"               
> 
> # Remove intercept if it is included
> coefficients <- coefficients[-1]
> std_errors <- std_errors[-1]
> p_values <- p_values[-1]
> 
> # Calculate the odds ratios (OR) and 95% confidence intervals (CI)
> OR <- exp(coefficients)
> CI_lower <- exp(coefficients - 1.96 * std_errors)
> CI_upper <- exp(coefficients + 1.96 * std_errors)
> 
> # Check if lengths match
> print(length(coefficients))
[1] 7
> print(length(std_errors))
[1] 7
> print(length(p_values))
[1] 7
> 
> # Create a data frame to display the results
> results <- data.frame(
+   Covariate = covariate_names,
+   OR = round(OR, 2),
+   CI = paste0("(", round(CI_lower, 2), " - ", round(CI_upper, 2), ")"),
+   P_value = round(p_values, 3)
+ )
> 
> # View the results
> print(results)
                Covariate   OR             CI P_value
1            UTIpostopUTI 3.64 (1.09 - 12.17)   0.036
2                      PS 1.83 (0.18 - 18.76)   0.610
3 TRTn2Lich-Gregoir group 1.09  (0.53 - 2.25)   0.808
4              CATHPERIOD 0.98  (0.91 - 1.05)   0.582
5                STENTYes 1.39   (0.6 - 3.24)   0.446
6                 OPRTIME 1.00  (0.99 - 1.01)   0.991
7                HOSPTIME 1.32  (1.19 - 1.46)   0.000
> 
> # Display the p-value with more precision
> print(p_values)
[1] 3.601086e-02 6.098381e-01 8.081488e-01 5.821256e-01 4.455859e-01
[6] 9.913299e-01 1.763946e-07
> 
> library(pROC)
> 
> # Ensure predicted probabilities are numeric
> predicted_probs <- as.numeric(predict(gee_model, type = "response"))
> 
> # Extract observed outcomes
> observed_outcomes <- mdata$ UTIpostop
> 
> # Calculate ROC and AUC
> roc_curve <- roc(observed_outcomes, predicted_probs)
Setting levels: control = No UTI, case = UTI
Setting direction: controls < cases
> 
> # Extract AUC
> auc_value <- auc(roc_curve)
> 
> # Calculate 95% CI for AUC using bootstrapping
> ci_auc <- ci.auc(roc_curve, method = "bootstrap", boot.n = 2000)
> 
> # Perform p-value test manually (AUC = 0.5 as the null hypothesis)
> boot_results <- replicate(2000, {
+   shuffled_outcomes <- sample(observed_outcomes)  # Shuffle outcomes
+   roc_shuffled <- roc(shuffled_outcomes, predicted_probs)
+   auc(roc_shuffled)
+ })
> 
> # Calculate p-value as the proportion of bootstrap AUCs >= observed AUC
> p_value <- mean(boot_results >= auc_value)
> 
> # Print the results
> print(paste("AUC:", round(auc_value, 3)))
[1] "AUC: 0.973"
> print(paste("95% CI for AUC:", paste(round(ci_auc[1:3], 3), collapse = " - ")))
[1] "95% CI for AUC: 0.952 - 0.974 - 0.991"
> print(paste("P-value:", round(p_value, 3)))
[1] "P-value: 0"
 
==================================================================================================
==================================================================================================

11. Analysis for postoperative pain and analgesia

> # Exclude cases where EPIDURAL is "Yes"
> dataEx <- data[data$EPIDURAL != "Yes", ]
> # Frequency table for EPIDURAL in dataEx
> table(dataEx$EPIDURAL)

 No Yes 
384   0 
> 
> # Exclude cases where EPIDURAL is "Yes"
> mdataEx <- mdata[mdata$EPIDURAL != "Yes", ]
> # Frequency table for EPIDURAL in dataEx
> table(mdataEx$EPIDURAL)

 No Yes 
234   0 
> 
> #Prepare Data to draw a histogram of the pain management scores, stratified by treatment group,
> # and show the percentage of patients in each score for both the data before matching (dataEx) 
> #and after matching
> # Load necessary libraries
> library(ggplot2)
> library(dplyr)
> 
> # Exclude cases where EPIDURAL is "Yes" in dataEx and mdataEx
> dataEx <- data[data$EPIDURAL != "Yes", ]
> mdataEx <- mdata[mdata$EPIDURAL != "Yes", ]
> 
> # Ensure PAIN and TRTn2 are factors
> dataEx$PAIN <- as.factor(dataEx$PAIN)
> mdataEx$PAIN <- as.factor(mdataEx$PAIN)
> 
> # check difference in pain score between treatment group and generate P-value for each plot
> 
> # Perform Fisher's Exact Test for dataEx dataset
> fisher_dataEx <- fisher.test(table(dataEx$PAIN, dataEx$TRTn2))
> cat("Fisher's Exact Test p-value for dataEx: ", fisher_dataEx$p.value, "\n")
Fisher's Exact Test p-value for dataEx:  4.119251e-05 
> 
> # Perform Fisher's Exact Test for mdataEx dataset
> fisher_mdataEx <- fisher.test(table(mdataEx$PAIN, mdataEx$TRTn2))
> cat("Fisher's Exact Test p-value for mdataEx: ", fisher_mdataEx$p.value, "\n")
Fisher's Exact Test p-value for mdataEx:  2.821748e-06 
> 


> #Option 2 
> # Draw the plot and add P-value to the plot
> # Step 1: Extract only the 'PAIN' and 'TRTn2' columns
> mdataEx_selected <- mdataEx[, c("PAIN", "TRTn2")]
> dataEx_selected <- dataEx[, c("PAIN", "TRTn2")]
> 
> # Step 2: Add the 'MatchingStatus' column to both datasets
> mdataEx_selected$MatchingStatus <- "After matching (N=235), p<0.001"
> dataEx_selected$MatchingStatus <- " Before matching (N=384), p<0.001"
> 
> # Step 3: Combine the datasets
> combined_data <- rbind(mdataEx_selected, dataEx_selected)
> 
> # Step 4: Calculate percentages for stacked bars based on 'PAIN' and 'TRTn2'
> combined_data_summary <- combined_data %>%
+   group_by(MatchingStatus, TRTn2, PAIN) %>%
+   summarise(Count = n(), .groups = "drop") %>%
+   group_by(MatchingStatus, TRTn2) %>%
+   mutate(Percent = (Count / sum(Count)) * 100)
> 
> # Step 5: Plot the stacked histogram
> library(ggplot2)
> p <- ggplot(combined_data_summary, aes(x = PAIN, y = Percent, fill = TRTn2)) +
+   geom_bar(stat = "identity", position = "stack") +
+   labs(title = "Pain Management Score Stratified by Treatment Group and Matching Status",
+        x = "1-Day Postoperative Pain Score", y = "Percentage of Patients (%)") +
+   scale_fill_manual(values = c("Cohen group" = "#ADD8E6", "Lich-Gregoir group" = "#00008B")) +  # Custom colors
+   facet_wrap(~ MatchingStatus, scales = "fixed") +  # Set consistent y-axis for both facets
+   theme_minimal() +
+   theme(
+     panel.grid = element_blank(),  # Remove gridlines
+     axis.title = element_text(size = 14),  # Set axis labels size
+     axis.text = element_text(size = 12),  # Set axis text size
+     strip.text = element_text(size = 12, face = "bold"),  # Bold facet labels
+     panel.border = element_rect(color = "black", fill = NA),  # Add frame to the plot
+     plot.title = element_text(hjust = 0.5, size = 16),  # Center the title
+     axis.ticks = element_line(size = 0.5, color = "black"),  # Set tick line properties
+     axis.ticks.length = unit(-0.2, "cm"),  # Move ticks inside the plot
+     axis.text.y = element_text(size = 12),  # Adjust the y-axis text size
+     strip.background = element_blank(),  # Remove background of facet labels
+     panel.spacing = unit(0, "lines")  # Reduce space between panels
+   )
> 
> # Step 6: Save the plot as a PNG file with larger dimensions
> ggsave("Pain_Management_Score_Plot.png", plot = p, width = 12, height = 8, dpi = 300)
> 
> 
> #Additional customization on option 2 - without the title, more space between the x title and the plot, 
> without label name: - reported 
Error: unexpected symbol in "without label"
> 
> p <- ggplot(combined_data_summary, aes(x = PAIN, y = Percent, fill = TRTn2)) +
+   geom_bar(stat = "identity", position = "stack") +
+   labs(x = "
+             1-Day Postoperative Pain Score", y = "Percentage of Patients (%)") +
+   scale_fill_manual(values = c("Cohen group" = "#ADD8E6", "Lich-Gregoir group" = "#00008B"), name = NULL) +  # Remove legend title
+   facet_wrap(~ MatchingStatus, scales = "fixed") +  # Set consistent y-axis for both facets
+   theme_minimal() +
+   theme(
+     panel.grid = element_blank(),  # Remove gridlines
+     axis.title = element_text(size = 14),  # Set axis labels size
+     axis.text = element_text(size = 12),  # Set axis text size
+     strip.text = element_text(size = 12, face = "bold"),  # Bold facet labels
+     panel.border = element_rect(color = "black", fill = NA),  # Add frame to the plot
+     plot.title = element_text(hjust = 0.5, size = 16),  # Center the title
+     axis.ticks = element_line(size = 0.5, color = "black"),  # Set tick line properties
+     axis.ticks.length = unit(-0.2, "cm"),  # Move ticks inside the plot
+     axis.text.y = element_text(size = 12),  # Adjust the y-axis text size
+     strip.background = element_blank(),  # Remove background of facet labels
+     panel.spacing = unit(0, "lines")  # Reduce space between panels
+   )
> 
> # Save the plot
> ggsave("Pain_Management_Score_Plot.png", plot = p, width = 12, height = 8, dpi = 300)
> 
>

